<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>FA ‚Äì LG Annual | ‡∏ü‡∏≠‡∏£‡πå‡∏° 3.5 ‚Äì Materiality (OM / PM / TE)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <style>
    :root{
      --bg:#060818;
      --card:#11152b;
      --border:#262b46;
      --accent:#42a5f5;
      --accent2:#26c6da;
      --muted:#a3acc7;
      --text:#f5f7ff;
      --pink:#f48fb1;
    }
    *{box-sizing:border-box;}

    body{
      margin:0;
      font-family:"Segoe UI", Tahoma, sans-serif;
      background:
        radial-gradient(circle at 10% 0%, rgba(123,30,60,0.36) 0, transparent 55%),
        radial-gradient(circle at 90% 100%, rgba(66,165,245,0.32) 0, transparent 55%),
        radial-gradient(circle at 0% 100%, rgba(38,198,218,0.22) 0, transparent 55%),
        var(--bg);
      color:var(--text);
      min-height:100vh;
      font-size:140%;
    }

    header{
      padding:16px 10px 12px;
      text-align:center;
      background:linear-gradient(120deg,#0d47a1,#42a5f5,#26c6da);
      box-shadow:0 4px 16px rgba(0,0,0,0.7);
      position:sticky;
      top:0;
      z-index:20;
    }
    header h2{ margin:0; font-size:20px; }
    header .sub{ font-size:13px; opacity:.9; }

    main{
      max-width:1100px;
      margin:20px auto 28px;
      padding:0 16px 20px;
    }

    .nav-top{
      display:flex;
      gap:8px;
      flex-wrap:wrap;
      margin-bottom:14px;
    }
    .btn-nav{
      padding:6px 12px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,0.45);
      background:rgba(0,0,0,0.35);
      color:#fff;
      font-size:12px;
      text-decoration:none;
      display:inline-flex;
      align-items:center;
      gap:6px;
    }
    .btn-nav:hover{ background:rgba(0,0,0,0.6); }

    .card{
      background:var(--card);
      border-radius:18px;
      border:1px solid rgba(255,255,255,0.12);
      padding:16px 14px 16px;
      box-shadow:0 10px 30px rgba(0,0,0,0.9);
      margin-bottom:16px;
    }
    .card-header{
      display:flex;
      justify-content:space-between;
      gap:10px;
      align-items:flex-start;
      margin-bottom:10px;
    }
    .card-title{
      font-size:16px;
      font-weight:600;
    }
    .card-sub{
      font-size:12px;
      color:var(--muted);
    }
    .chip{
      padding:4px 10px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,0.2);
      font-size:11px;
      background:rgba(0,0,0,0.35);
      white-space:nowrap;
    }

    .form-grid{
      display:grid;
      grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
      gap:10px 14px;
      margin-top:4px;
    }

    label{
      font-size:12px;
      display:block;
      margin-bottom:2px;
      color:#e3f2fd;
    }
    .input, select, textarea{
      width:100%;
      padding:6px 8px;
      border-radius:10px;
      border:1px solid var(--border);
      background:#080c1b;
      color:var(--text);
      font-size:12px;
    }
    textarea{
      min-height:80px;
      resize:vertical;
    }
    .input:focus, select:focus, textarea:focus{
      outline:none;
      border-color:var(--accent2);
      box-shadow:0 0 0 1px rgba(38,198,218,0.5);
    }

    .section-title{
      font-size:14px;
      font-weight:600;
      margin:10px 0 6px;
    }
    .hint{
      font-size:11px;
      color:var(--muted);
      margin-bottom:6px;
    }

    .btn-row{
      display:flex;
      flex-wrap:wrap;
      gap:8px;
      margin-top:10px;
    }
    .btn{
      padding:6px 12px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,0.4);
      background:rgba(0,0,0,0.4);
      color:#fff;
      font-size:12px;
      cursor:pointer;
    }
    .btn-primary{
      border-color:var(--accent);
      background:linear-gradient(120deg,#0d47a1,#42a5f5);
    }
    .btn-danger{
      border-color:#f44336;
      background:linear-gradient(120deg,#b71c1c,#f44336);
    }
    .btn:hover{
      background:rgba(0,0,0,0.7);
    }
    .btn-primary:hover,
    .btn-danger:hover{
      filter:brightness(1.1);
    }

    .footer-note{
      font-size:10px;
      color:var(--muted);
      margin-top:6px;
    }

    /* ---------- A4 PREVIEW ---------- */
    .a4-wrapper{
      margin-top:18px;
    }

    .a4-title{
      font-size:14px;
      font-weight:600;
      margin-bottom:6px;
    }

    .a4-page{
      width:210mm;
      min-height:297mm;
      margin:0 auto 16px;
      background:#ffffff;
      color:#000000;
      box-shadow:0 0 8px rgba(0,0,0,0.5);
      padding:12mm;
      font-size:11pt;
      position:relative;
    }

    .a4-header-center{
      text-align:center;
      margin-bottom:6px;
      font-size:12pt;
      font-weight:600;
    }
    .a4-subheader{
      text-align:center;
      font-size:10pt;
      margin-bottom:8px;
    }
    .a4-row{
      display:flex;
      justify-content:space-between;
      font-size:10pt;
      margin-bottom:4px;
    }
    .a4-row span{
      display:inline-block;
      min-width:80px;
    }
    .a4-row .value{
      border-bottom:1px solid #000;
      min-width:160px;
      display:inline-block;
      padding:0 2px;
    }

    .a4-table{
      width:100%;
      border-collapse:collapse;
      margin-top:8px;
      font-size:10pt;
    }
    .a4-table th,
    .a4-table td{
      border:1px solid #000;
      padding:4px 4px;
      vertical-align:top;
    }
    .a4-table th{
      text-align:center;
      font-weight:600;
    }

    .a4-sign-row{
      margin-top:40px;
      display:flex;
      justify-content:space-between;
      font-size:10pt;
    }
    .a4-sign-block{
      width:45%;
      text-align:center;
    }
    .a4-sign-line{
      border-bottom:1px solid #000;
      margin:18px 0 2px;
      height:0;
    }

    .a4-footer{
      position:absolute;
      bottom:8mm;
      left:12mm;
      right:12mm;
      font-size:8pt;
      display:flex;
      justify-content:space-between;
    }

    /* PRINT */
    @page{
      size:A4;
      margin:12mm;
    }
    @media print{
      body{
        background:#ffffff;
        color:#000000;
        font-size:11pt;
      }
      header,
      .nav-top,
      .card:not(.card-a4),
      .no-print{
        display:none !important;
      }
      .a4-page{
        box-shadow:none;
        margin:0;
        width:auto;
        min-height:auto;
        padding:0;
      }
      main{
        max-width:100%;
        margin:0;
        padding:0;
      }
    }

    @media (max-width:900px){
      .a4-page{
        width:100%;
        min-height:auto;
      }
    }

    @media (max-width:600px){
      .card-header{
        flex-direction:column;
        align-items:flex-start;
      }
    }
  </style>
</head>
<body>

<header>
  <h2>üßÆ ‡∏ü‡∏≠‡∏£‡πå‡∏° 3.5 ‚Äì ‡∏Å‡∏≤‡∏£‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏°‡∏µ‡∏ô‡∏±‡∏¢‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç (OM / PM / TE)</h2>
  <div class="sub">
    Form 3.5 ‚Äì Overall / Performance Materiality & Tolerable Error | FA ‚Äì Local Government (Annual)
  </div>
</header>

<main>

  <div class="nav-top">
    <a href="fa-lg-annual-plan.html" class="btn-nav">
      <span>‚Ü©</span> ‡∏Å‡∏•‡∏±‡∏ö‡πÄ‡∏°‡∏ô‡∏π‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏Å‡∏≤‡∏£‡∏ß‡∏≤‡∏á‡πÅ‡∏ú‡∏ô
    </a>
    <a href="fa-lg-annual.html" class="btn-nav">
      <span>üìÖ</span> ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏µ / ‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏£‡∏±‡∏ö‡∏ï‡∏£‡∏ß‡∏à
    </a>
    <a href="fa-menu.html" class="btn-nav">
      <span>üìÇ</span> FA Main Menu
    </a>
    <a href="index.html" class="btn-nav">
      <span>üè†</span> ‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å‡∏£‡∏∞‡∏ö‡∏ö
    </a>
  </div>

  <!-- CARD 1: ‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏Å‡∏£‡∏≠‡∏Å‡∏î‡∏¥‡∏à‡∏¥‡∏ó‡∏±‡∏• -->
  <section class="card">
    <div class="card-header">
      <div>
        <div class="card-title">‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 1 ‚Äì ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô ‡πÅ‡∏•‡∏∞‡∏ê‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì Materiality</div>
        <div class="card-sub">
          ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏õ‡∏µ‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì ‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏£‡∏±‡∏ö‡∏ï‡∏£‡∏ß‡∏à ‡∏ê‡∏≤‡∏ô‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì (Base) ‡πÅ‡∏•‡∏∞‡∏£‡πâ‡∏≠‡∏¢‡∏•‡∏∞‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö OM / PM / TE
        </div>
      </div>
      <div class="chip">Digital Form ‚Ä¢ Input</div>
    </div>

    <div class="form-grid">
      <div>
        <label for="fy">‡∏õ‡∏µ‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì</label>
        <select id="fy" class="input">
          <option value="">‚Äî ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏µ‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì ‚Äî</option>
          <option>2567</option>
          <option>2568</option>
          <option>2569</option>
        </select>
      </div>
      <div>
        <label for="auditee">‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏£‡∏±‡∏ö‡∏ï‡∏£‡∏ß‡∏à (‡∏≠‡∏õ‡∏ó.)</label>
        <input id="auditee" class="input" type="text" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡πÄ‡∏ó‡∏®‡∏ö‡∏≤‡∏•‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á">
      </div>
      <div>
        <label for="amphoe">‡∏≠‡∏≥‡πÄ‡∏†‡∏≠</label>
        <input id="amphoe" class="input" type="text" placeholder="‡∏≠‡∏≥‡πÄ‡∏†‡∏≠">
      </div>
      <div>
        <label for="province">‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î</label>
        <input id="province" class="input" type="text" placeholder="‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î">
      </div>
      <div>
        <label for="preparedBy">‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏ó‡∏≥</label>
        <input id="preparedBy" class="input" type="text" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏ó‡∏≥‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°">
      </div>
      <div>
        <label for="reviewedBy">‡∏ú‡∏π‡πâ‡∏™‡∏≠‡∏ö‡∏ó‡∏≤‡∏ô</label>
        <input id="reviewedBy" class="input" type="text" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏™‡∏≠‡∏ö‡∏ó‡∏≤‡∏ô / ‡∏ú‡∏ï‡∏à.">
      </div>
    </div>

    <div class="section-title">1.2 ‡∏ê‡∏≤‡∏ô‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÅ‡∏•‡∏∞‡∏£‡πâ‡∏≠‡∏¢‡∏•‡∏∞‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ</div>
    <div class="hint">
      ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏ä‡πà‡∏ô ‡πÉ‡∏ä‡πâ ‚Äú‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏£‡∏ß‡∏°‚Äù ‡∏´‡∏£‡∏∑‡∏≠ ‚Äú‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏£‡∏ß‡∏°‚Äù ‡πÄ‡∏õ‡πá‡∏ô‡∏ê‡∏≤‡∏ô‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì ‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏≥‡∏´‡∏ô‡∏î % ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö OM / PM / TE
    </div>

    <div class="form-grid">
      <div>
        <label for="baseDesc">‡∏ê‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì (Base)</label>
        <input id="baseDesc" class="input" type="text" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏õ‡∏µ / ‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏£‡∏ß‡∏° / ‡∏™‡∏¥‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏∏‡∏ó‡∏ò‡∏¥ ‡∏Ø‡∏•‡∏Ø">
      </div>
      <div>
        <label for="baseAmount">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡∏ê‡∏≤‡∏ô (‡∏ö‡∏≤‡∏ó)</label>
        <input id="baseAmount" class="input" type="number" min="0" step="0.01" placeholder="‡πÄ‡∏ä‡πà‡∏ô 100000000">
      </div>

      <div>
        <label for="omPct">% ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Overall Materiality (OM)</label>
        <input id="omPct" class="input" type="number" min="0" step="0.01" placeholder="‡πÄ‡∏ä‡πà‡∏ô 1.0">
      </div>
      <div>
        <label for="pmPct">% ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Performance Materiality (PM)</label>
        <input id="pmPct" class="input" type="number" min="0" step="0.01" placeholder="‡πÄ‡∏ä‡πà‡∏ô 75 ‡∏Ç‡∏≠‡∏á OM ‚Üí ‡∏≠‡∏≤‡∏à‡πÉ‡∏ä‡πâ 0.75*OM">
      </div>
      <div>
        <label for="tePct">% ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Tolerable Error (TE) / ‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡∏ó‡∏µ‡πà‡∏¢‡∏≠‡∏°‡∏£‡∏±‡∏ö‡πÑ‡∏î‡πâ</label>
        <input id="tePct" class="input" type="number" min="0" step="0.01" placeholder="‡πÄ‡∏ä‡πà‡∏ô 5‚Äì10% ‡∏Ç‡∏≠‡∏á OM ‡∏´‡∏£‡∏∑‡∏≠‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÄ‡∏≠‡∏á">
      </div>
    </div>

    <div class="section-title">1.3 ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå OM / PM / TE (‡∏ö‡∏≤‡∏ó)</div>
    <div class="form-grid">
      <div>
        <label for="omValue">Overall Materiality (OM)</label>
        <input id="omValue" class="input" type="text" readonly placeholder="‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÉ‡∏´‡πâ">
      </div>
      <div>
        <label for="pmValue">Performance Materiality (PM)</label>
        <input id="pmValue" class="input" type="text" readonly placeholder="‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÉ‡∏´‡πâ">
      </div>
      <div>
        <label for="teValue">Tolerable Error (TE)</label>
        <input id="teValue" class="input" type="text" readonly placeholder="‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÉ‡∏´‡πâ">
      </div>
    </div>

    <div class="btn-row no-print">
      <button type="button" class="btn btn-primary" onclick="calcMateriality()">‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì OM / PM / TE</button>
      <button type="button" class="btn" onclick="pushToA4()">‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏° A4</button>
    </div>

    <div class="footer-note">
      * ‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏£‡∏¥‡∏á ‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏Ñ‡πà‡∏≤ Base ‡πÅ‡∏•‡∏∞ % ‡∏à‡∏≤‡∏Å‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏•‡∏≤‡∏á / Template ‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏•‡∏î‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏≠‡∏Å‡∏°‡∏∑‡∏≠
    </div>
  </section>

  <!-- CARD 2: Export / A4 -->
  <section class="card card-a4">
    <div class="card-header">
      <div>
        <div class="card-title">‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 2 ‚Äì ‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏° 3.5 ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏© A4 (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏û‡∏¥‡∏°‡∏û‡πå / Export)</div>
        <div class="card-sub">
          ‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏° A4 ‡∏à‡∏∞‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡πÅ‡∏ö‡∏ö‡∏î‡∏¥‡∏à‡∏¥‡∏ó‡∏±‡∏•‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô ‚Äî ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏û‡∏¥‡∏°‡∏û‡πå‡πÄ‡∏õ‡πá‡∏ô PDF (A4) ‡∏´‡∏£‡∏∑‡∏≠ Export ‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏ü‡∏•‡πå HTML / JSON ‡πÑ‡∏î‡πâ
        </div>
      </div>
      <div class="chip">A4 Layout ‚Ä¢ Export</div>
    </div>

    <div class="btn-row no-print">
      <button type="button" class="btn" onclick="pushToA4()">‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏° A4</button>
      <button type="button" class="btn btn-primary" onclick="window.print()">‡∏û‡∏¥‡∏°‡∏û‡πå / Export PDF (A4)</button>
      <button type="button" class="btn" onclick="exportA4Html()">Export ‡πÄ‡∏õ‡πá‡∏ô HTML (A4 ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏´‡∏ô‡πâ‡∏≤)</button>
      <button type="button" class="btn btn-danger" onclick="exportJson()">Export ‡πÄ‡∏õ‡πá‡∏ô JSON (‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°)</button>
    </div>

    <div class="a4-wrapper">
      <div class="a4-title">‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏© A4</div>

      <!-- A4 PAGE -->
      <div class="a4-page" id="a4Page">
        <div class="a4-header-center">
          ‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏° 3.5 ‚Äì ‡∏Å‡∏≤‡∏£‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏°‡∏µ‡∏ô‡∏±‡∏¢‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏Ç‡∏≠‡∏á‡∏á‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô (Materiality)
        </div>
        <div class="a4-subheader">
          ‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏ú‡πà‡∏ô‡∏î‡∏¥‡∏ô ‚Äì ‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô‡∏Ç‡∏≠‡∏á‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£‡∏õ‡∏Å‡∏Ñ‡∏£‡∏≠‡∏á‡∏™‡πà‡∏ß‡∏ô‡∏ó‡πâ‡∏≠‡∏á‡∏ñ‡∏¥‡πà‡∏ô
        </div>

        <div class="a4-row">
          <div>
            <span>‡∏õ‡∏µ‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì</span> 
            <span class="value" id="a4Fy">&nbsp;</span>
          </div>
          <div>
            <span>‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏£‡∏±‡∏ö‡∏ï‡∏£‡∏ß‡∏à</span> 
            <span class="value" id="a4Auditee">&nbsp;</span>
          </div>
        </div>
        <div class="a4-row">
          <div>
            <span>‡∏≠‡∏≥‡πÄ‡∏†‡∏≠</span>
            <span class="value" id="a4Amphoe">&nbsp;</span>
          </div>
          <div>
            <span>‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î</span>
            <span class="value" id="a4Province">&nbsp;</span>
          </div>
        </div>
        <div class="a4-row">
          <div>
            <span>‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏ó‡∏≥</span>
            <span class="value" id="a4PreparedBy">&nbsp;</span>
          </div>
          <div>
            <span>‡∏ú‡∏π‡πâ‡∏™‡∏≠‡∏ö‡∏ó‡∏≤‡∏ô</span>
            <span class="value" id="a4ReviewedBy">&nbsp;</span>
          </div>
        </div>

        <div style="margin-top:10px; font-size:10pt;">
          <strong>1. ‡∏ê‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡∏ß‡∏≤‡∏°‡∏°‡∏µ‡∏ô‡∏±‡∏¢‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç</strong>
        </div>
        <div class="a4-row">
          <div style="flex:1;">
            <span>‡∏ê‡∏≤‡∏ô (Base)</span>
            <span class="value" id="a4BaseDesc">&nbsp;</span>
          </div>
        </div>
        <div class="a4-row">
          <div>
            <span>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡∏ê‡∏≤‡∏ô (‡∏ö‡∏≤‡∏ó)</span>
            <span class="value" id="a4BaseAmount">&nbsp;</span>
          </div>
        </div>

        <table class="a4-table" style="margin-top:10px;">
          <thead>
          <tr>
            <th style="width:28%;">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Ñ‡∏ß‡∏≤‡∏°‡∏°‡∏µ‡∏ô‡∏±‡∏¢‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç</th>
            <th style="width:18%;">‡∏£‡πâ‡∏≠‡∏¢‡∏•‡∏∞‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ</th>
            <th style="width:27%;">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô (‡∏ö‡∏≤‡∏ó)</th>
            <th>‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢ / ‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å</th>
          </tr>
          </thead>
          <tbody>
          <tr>
            <td>1) Overall Materiality (OM)</td>
            <td id="a4OmPct" style="text-align:center;">&nbsp;</td>
            <td id="a4OmValue" style="text-align:right;">&nbsp;</td>
            <td id="a4OmExplain">
              ‡πÉ‡∏ä‡πâ‡πÄ‡∏Å‡∏ì‡∏ë‡πå OM ‡πÉ‡∏ô‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°‡∏Å‡∏±‡∏ö‡∏Ç‡∏ô‡∏≤‡∏î‡πÅ‡∏•‡∏∞‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞‡∏Ç‡∏≠‡∏á‡∏á‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô‡∏Ç‡∏≠‡∏á‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏£‡∏±‡∏ö‡∏ï‡∏£‡∏ß‡∏à
            </td>
          </tr>
          <tr>
            <td>2) Performance Materiality (PM)</td>
            <td id="a4PmPct" style="text-align:center;">&nbsp;</td>
            <td id="a4PmValue" style="text-align:right;">&nbsp;</td>
            <td id="a4PmExplain">
              ‡πÉ‡∏ä‡πâ PM ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏ó‡∏µ‡πà‡∏ú‡∏•‡∏£‡∏ß‡∏°‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏ß‡∏à‡∏û‡∏ö‡πÅ‡∏•‡∏∞‡∏ï‡∏£‡∏ß‡∏à‡πÑ‡∏°‡πà‡∏û‡∏ö ‡∏à‡∏∞‡πÄ‡∏Å‡∏¥‡∏ô OM
            </td>
          </tr>
          <tr>
            <td>3) Tolerable Error (TE)</td>
            <td id="a4TePct" style="text-align:center;">&nbsp;</td>
            <td id="a4TeValue" style="text-align:right;">&nbsp;</td>
            <td id="a4TeExplain">
              ‡∏Å‡∏≥‡∏´‡∏ô‡∏î TE ‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏Ñ‡∏±‡∏î‡∏Å‡∏£‡∏≠‡∏á‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡∏£‡∏≤‡∏¢‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£/‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏¢‡∏≠‡∏°‡∏£‡∏±‡∏ö‡πÑ‡∏î‡πâ‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Ç‡∏¢‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°
            </td>
          </tr>
          </tbody>
        </table>

        <div style="margin-top:12px; font-size:10pt;">
          <strong>2. ‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡πÇ‡∏¢‡∏á‡∏Å‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ß‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö</strong>
        </div>
        <div style="font-size:10pt; margin-top:4px;">
          - OM ‡∏à‡∏∞‡πÉ‡∏ä‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏£‡∏≠‡∏ö‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏°‡∏µ‡∏ô‡∏±‡∏¢‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏á‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô  
          - PM ‡∏à‡∏∞‡πÉ‡∏ä‡πâ‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ç‡∏≠‡∏ö‡πÄ‡∏Ç‡∏ï‡πÅ‡∏•‡∏∞‡∏Ç‡∏ô‡∏≤‡∏î‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤ (Substantive Tests)  
          - TE ‡∏à‡∏∞‡πÉ‡∏ä‡πâ‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏Ñ‡∏±‡∏î‡∏Å‡∏£‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡∏£‡∏≤‡∏¢‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏ô‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏©‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö
        </div>

        <div class="a4-sign-row">
          <div class="a4-sign-block">
            ‡∏•‡∏á‡∏ä‡∏∑‡πà‡∏≠
            <div class="a4-sign-line"></div>
            (.......................................................)<br>
            ‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏ó‡∏≥
          </div>
          <div class="a4-sign-block">
            ‡∏•‡∏á‡∏ä‡∏∑‡πà‡∏≠
            <div class="a4-sign-line"></div>
            (.......................................................)<br>
            ‡∏ú‡∏π‡πâ‡∏™‡∏≠‡∏ö‡∏ó‡∏≤‡∏ô / ‡∏ú‡∏ï‡∏à.
          </div>
        </div>

        <div class="a4-footer">
          <div>‡∏ü‡∏≠‡∏£‡πå‡∏° 3.5 ‚Äì Materiality</div>
          <div id="a4FooterMeta">‡∏û‡∏¥‡∏°‡∏û‡πå‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö FA ‚Äì LG</div>
        </div>
      </div>
    </div>
  </section>

</main>

<script>
  function formatNumber(num){
    if(num === null || num === undefined || isNaN(num)) return '';
    return num.toLocaleString('th-TH', {minimumFractionDigits:2, maximumFractionDigits:2});
  }

  function calcMateriality(){
    const base = parseFloat(document.getElementById('baseAmount').value || '0');
    const omPct = parseFloat(document.getElementById('omPct').value || '0');
    const pmPct = parseFloat(document.getElementById('pmPct').value || '0');
    const tePct = parseFloat(document.getElementById('tePct').value || '0');

    if(base <= 0 || omPct <= 0){
      alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å Base ‡πÅ‡∏•‡∏∞ % OM ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡πà‡∏≠‡∏ô');
      return;
    }

    const om = base * (omPct/100);
    const pm = pmPct > 0 ? base * (pmPct/100) : om * 0.75;
    const te = tePct > 0 ? base * (tePct/100) : om * 0.05;

    document.getElementById('omValue').value = formatNumber(om);
    document.getElementById('pmValue').value = formatNumber(pm);
    document.getElementById('teValue').value = formatNumber(te);
  }

  function pushToA4(){
    // ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ
    document.getElementById('a4Fy').textContent        = document.getElementById('fy').value || '';
    document.getElementById('a4Auditee').textContent   = document.getElementById('auditee').value || '';
    document.getElementById('a4Amphoe').textContent    = document.getElementById('amphoe').value || '';
    document.getElementById('a4Province').textContent  = document.getElementById('province').value || '';
    document.getElementById('a4PreparedBy').textContent= document.getElementById('preparedBy').value || '';
    document.getElementById('a4ReviewedBy').textContent= document.getElementById('reviewedBy').value || '';

    // Base
    document.getElementById('a4BaseDesc').textContent  = document.getElementById('baseDesc').value || '';
    const baseVal = parseFloat(document.getElementById('baseAmount').value || '0');
    document.getElementById('a4BaseAmount').textContent= baseVal ? formatNumber(baseVal) : '';

    // % ‡πÅ‡∏•‡∏∞‡∏à‡∏≥‡∏ô‡∏ß‡∏ô OM/PM/TE
    const omPct = document.getElementById('omPct').value || '';
    const pmPct = document.getElementById('pmPct').value || '';
    const tePct = document.getElementById('tePct').value || '';

    document.getElementById('a4OmPct').textContent = omPct ? omPct + ' %' : '';
    document.getElementById('a4PmPct').textContent = pmPct ? pmPct + ' %' : '';
    document.getElementById('a4TePct').textContent = tePct ? tePct + ' %' : '';

    document.getElementById('a4OmValue').textContent = document.getElementById('omValue').value || '';
    document.getElementById('a4PmValue').textContent = document.getElementById('pmValue').value || '';
    document.getElementById('a4TeValue').textContent = document.getElementById('teValue').value || '';

    // Footer meta ‚Äì ‡πÄ‡∏ß‡∏•‡∏≤
    const now = new Date();
    const ts = now.toLocaleString('th-TH');
    document.getElementById('a4FooterMeta').textContent = '‡∏û‡∏¥‡∏°‡∏û‡πå‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö FA ‚Äì LG ‡∏ì ' + ts;
  }

  function exportA4Html(){
    const a4 = document.getElementById('a4Page');
    if(!a4){
      alert('‡πÑ‡∏°‡πà‡∏û‡∏ö‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤ A4');
      return;
    }
    const htmlContent =
      '<!DOCTYPE html><html lang="th"><head><meta charset="UTF-8"><title>Form3.5-A4</title>' +
      '<style>@page{size:A4;margin:12mm;}body{font-family:\"TH Sarabun New\",\"Segoe UI\",sans-serif;font-size:11pt;} .a4-page{width:100%;min-height:100%;}</style>' +
      '</head><body>' + a4.outerHTML + '</body></html>';

    const blob = new Blob([htmlContent], {type:'text/html'});
    const url  = URL.createObjectURL(blob);
    const a    = document.createElement('a');
    a.href = url;
    a.download = 'form3_5_materiality_a4.html';
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    URL.revokeObjectURL(url);
  }

  function exportJson(){
    const data = {
      fiscalYear    : document.getElementById('fy').value || '',
      auditee       : document.getElementById('auditee').value || '',
      amphoe        : document.getElementById('amphoe').value || '',
      province      : document.getElementById('province').value || '',
      preparedBy    : document.getElementById('preparedBy').value || '',
      reviewedBy    : document.getElementById('reviewedBy').value || '',
      baseDesc      : document.getElementById('baseDesc').value || '',
      baseAmount    : document.getElementById('baseAmount').value || '',
      omPct         : document.getElementById('omPct').value || '',
      pmPct         : document.getElementById('pmPct').value || '',
      tePct         : document.getElementById('tePct').value || '',
      omValue       : document.getElementById('omValue').value || '',
      pmValue       : document.getElementById('pmValue').value || '',
      teValue       : document.getElementById('teValue').value || ''
    };

    const blob = new Blob([JSON.stringify(data,null,2)], {type:'application/json'});
    const url  = URL.createObjectURL(blob);
    const a    = document.createElement('a');
    a.href = url;
    a.download = 'form3_5_materiality.json';
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    URL.revokeObjectURL(url);
  }
</script>

</body>
</html>
