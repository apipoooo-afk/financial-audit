<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>FA ‚Äì Annual Report Editor | ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô ‡∏≠‡∏õ‡∏ó.</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <style>
    :root{
      --bg:#060818;
      --bg-soft:#0b1024;
      --card:#11152b;
      --border:#262b46;
      --accent:#42a5f5;
      --accent2:#26c6da;
      --danger:#ef5350;
      --success:#66bb6a;
      --warning:#ffb300;
      --text:#f5f7ff;
      --muted:#a3acc7;
      --chip-bg:rgba(66,165,245,0.12);
      --chip-border:rgba(66,165,245,0.55);
      --radius-lg:16px;
      --shadow-soft:0 12px 30px rgba(0,0,0,0.55);
    }

    *{box-sizing:border-box;}

    body{
      margin:0;
      font-family:"Segoe UI","Tahoma",sans-serif;
      background:
        radial-gradient(circle at 10% 0%, rgba(123,30,60,0.32) 0, transparent 55%),
        radial-gradient(circle at 90% 100%, rgba(66,165,245,0.32) 0, transparent 55%),
        var(--bg);
      color:var(--text);
    }

    a{color:var(--accent);text-decoration:none;}
    a:hover{text-decoration:underline;}

    header{
      padding:18px 20px 12px;
      background:linear-gradient(120deg,#7b1e3c,#0d47a1,#42a5f5);
      box-shadow:0 8px 25px rgba(0,0,0,0.55);
      position:sticky;
      top:0;
      z-index:20;
    }
    header h1{
      margin:0;
      font-size:24px;
      font-weight:800;
    }
    header .subtitle{
      margin-top:4px;
      font-size:13px;
      opacity:0.88;
    }
    header .meta{
      margin-top:8px;
      display:flex;
      flex-wrap:wrap;
      gap:8px;
      font-size:12px;
    }
    .meta span{
      padding:4px 10px;
      border-radius:999px;
      background:rgba(0,0,0,0.22);
      border:1px solid rgba(255,255,255,0.14);
    }
    .top-actions{
      margin-top:10px;
      display:flex;
      flex-wrap:wrap;
      gap:8px;
    }
    .btn-top{
      padding:6px 12px;
      border-radius:999px;
      border:none;
      font-size:13px;
      cursor:pointer;
      display:inline-flex;
      align-items:center;
      gap:6px;
      background:rgba(0,0,0,0.35);
      color:#fff;
      backdrop-filter:blur(10px);
    }
    .btn-top:hover{
      background:rgba(0,0,0,0.6);
    }

    .layout{
      display:grid;
      grid-template-columns:280px minmax(0,1fr);
      gap:16px;
      padding:16px;
    }

    @media(max-width:960px){
      .layout{
        grid-template-columns:1fr;
      }
    }

    /* Sidebar */
    .side-card{
      background:rgba(8,12,32,0.92);
      border:1px solid var(--border);
      border-radius:var(--radius-lg);
      box-shadow:var(--shadow-soft);
      padding:14px 14px 16px;
      position:sticky;
      top:120px;
      max-height:calc(100vh - 140px);
      overflow:auto;
    }
    .side-title{
      font-size:14px;
      font-weight:700;
      margin-bottom:8px;
    }
    .nav-list{
      list-style:none;
      padding:0;
      margin:0 0 12px;
      font-size:13px;
    }
    .nav-list li{
      margin-bottom:4px;
    }
    .nav-btn{
      width:100%;
      text-align:left;
      padding:6px 10px;
      border-radius:10px;
      border:1px solid transparent;
      background:transparent;
      color:var(--muted);
      font-size:13px;
      cursor:pointer;
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:6px;
    }
    .nav-btn span.badge{
      font-size:11px;
      padding:2px 6px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,0.16);
      opacity:0.7;
    }
    .nav-btn.active{
      background:rgba(66,165,245,0.18);
      border-color:var(--accent);
      color:var(--text);
    }

    .checklist{
      margin-top:8px;
      padding-top:8px;
      border-top:1px dashed var(--border);
      font-size:12px;
    }
    .check-row{
      display:flex;
      align-items:center;
      gap:6px;
      margin-bottom:4px;
    }
    .check-row input{
      accent-color:var(--accent);
    }
    .check-status{
      margin-top:8px;
      font-size:12px;
      padding:6px 8px;
      border-radius:8px;
      background:rgba(0,0,0,0.35);
      display:flex;
      align-items:center;
      gap:6px;
    }
    .check-status span.dot{
      width:9px;
      height:9px;
      border-radius:50%;
      background:var(--warning);
    }
    .check-status.complete span.dot{
      background:var(--success);
    }

    .side-footer{
      margin-top:10px;
      display:flex;
      flex-direction:column;
      gap:6px;
    }
    .btn-small{
      border:none;
      border-radius:999px;
      padding:6px 10px;
      font-size:12px;
      cursor:pointer;
      display:flex;
      align-items:center;
      justify-content:center;
      gap:5px;
      background:var(--accent);
      color:#fff;
    }
    .btn-small.secondary{
      background:transparent;
      border:1px dashed var(--border);
      color:var(--muted);
    }

    /* Main */
    .main{
      display:flex;
      flex-direction:column;
      gap:16px;
    }

    .section-card{
      background:rgba(6,10,28,0.96);
      border-radius:var(--radius-lg);
      border:1px solid var(--border);
      box-shadow:var(--shadow-soft);
      padding:14px 16px 12px;
      scroll-margin-top:110px;
    }
    .section-header{
      display:flex;
      justify-content:space-between;
      align-items:flex-start;
      gap:8px;
      margin-bottom:8px;
    }
    .section-title{
      font-size:15px;
      font-weight:700;
    }
    .section-sub{
      font-size:11px;
      color:var(--muted);
    }
    .section-tools{
      display:flex;
      flex-wrap:wrap;
      gap:6px;
      justify-content:flex-end;
    }
    .btn-tool{
      border:none;
      border-radius:999px;
      padding:4px 9px;
      font-size:11px;
      cursor:pointer;
      background:rgba(8,15,48,0.85);
      border:1px solid rgba(255,255,255,0.12);
      color:var(--muted);
      display:inline-flex;
      align-items:center;
      gap:4px;
    }
    .btn-tool:hover{
      background:rgba(15,25,70,0.9);
      color:var(--text);
    }

    .editor-wrapper{
      margin-top:6px;
      display:grid;
      grid-template-columns:minmax(0,1.5fr) minmax(0,1fr);
      gap:10px;
    }
    @media(max-width:900px){
      .editor-wrapper{
        grid-template-columns:1fr;
      }
    }

    .editor-box{
      background:rgba(10,16,40,0.95);
      border-radius:10px;
      border:1px solid rgba(255,255,255,0.08);
      padding:8px;
      display:flex;
      flex-direction:column;
      gap:6px;
    }
    .editor-label{
      font-size:11px;
      color:var(--muted);
      display:flex;
      justify-content:space-between;
      align-items:center;
    }
    .editor-input{
      width:100%;
      min-height:110px;
      max-height:260px;
      resize:vertical;
      padding:8px;
      font-family:inherit;
      font-size:13px;
      border-radius:8px;
      border:1px solid rgba(255,255,255,0.12);
      background:rgba(3,5,18,0.9);
      color:var(--text);
    }
    .editor-input:focus{
      outline:none;
      border-color:var(--accent);
      box-shadow:0 0 0 1px rgba(66,165,245,0.6);
    }

    .ai-note{
      font-size:10px;
      color:var(--muted);
      opacity:0.85;
    }

    .attach-list{
      list-style:none;
      padding:0;
      margin:4px 0 0;
      font-size:11px;
      max-height:120px;
      overflow:auto;
    }
    .attach-list li{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:6px;
      padding:3px 5px;
      border-radius:7px;
      background:rgba(255,255,255,0.02);
      border:1px dashed rgba(255,255,255,0.08);
    }
    .attach-list button{
      border:none;
      background:transparent;
      color:var(--muted);
      cursor:pointer;
      font-size:11px;
    }

    .file-input{
      font-size:11px;
      margin-top:4px;
    }

    .spell-status{
      font-size:11px;
      margin-top:4px;
      padding:5px 7px;
      border-radius:8px;
      background:rgba(0,0,0,0.4);
    }
    .spell-status.ok{
      border-left:3px solid var(--success);
    }
    .spell-status.warn{
      border-left:3px solid var(--warning);
    }

    .section-footer{
      margin-top:6px;
      display:flex;
      justify-content:space-between;
      align-items:center;
      flex-wrap:wrap;
      gap:6px;
      font-size:10px;
      color:var(--muted);
    }

    /* Global footer actions */
    .global-actions{
      background:rgba(5,9,26,0.98);
      border-radius:var(--radius-lg);
      border:1px solid var(--border);
      box-shadow:var(--shadow-soft);
      padding:10px 12px;
      display:flex;
      flex-wrap:wrap;
      gap:8px;
      justify-content:space-between;
      align-items:center;
      margin-bottom:10px;
    }
    .global-actions-left{
      display:flex;
      flex-wrap:wrap;
      gap:8px;
      align-items:center;
    }
    .global-actions-right{
      display:flex;
      flex-wrap:wrap;
      gap:6px;
      align-items:center;
    }
    .btn-main{
      border:none;
      border-radius:999px;
      padding:7px 14px;
      font-size:13px;
      cursor:pointer;
      display:inline-flex;
      align-items:center;
      gap:6px;
      background:var(--accent);
      color:#fff;
    }
    .btn-main.secondary{
      background:transparent;
      border:1px solid var(--border);
      color:var(--muted);
    }
    .btn-main.danger{
      background:var(--danger);
    }
    .btn-main:disabled{
      opacity:0.45;
      cursor:not-allowed;
    }

    /* Modal */
    .modal-backdrop{
      position:fixed;
      inset:0;
      background:rgba(0,0,0,0.65);
      display:none;
      align-items:center;
      justify-content:center;
      z-index:40;
    }
    .modal{
      background:var(--card);
      border-radius:18px;
      border:1px solid var(--border);
      padding:14px 16px;
      max-width:480px;
      width:100%;
      box-shadow:var(--shadow-soft);
    }
    .modal-title{
      font-size:15px;
      font-weight:700;
      margin-bottom:4px;
    }
    .modal-body{
      font-size:12px;
      color:var(--muted);
      margin-bottom:10px;
    }
    .modal-body ul{
      margin:6px 0 0 18px;
      padding:0;
    }
    .modal-footer{
      display:flex;
      justify-content:flex-end;
      gap:6px;
    }

    /* Checklist mini chip */
    .chip{
      display:inline-flex;
      align-items:center;
      gap:4px;
      padding:2px 7px;
      font-size:10px;
      border-radius:999px;
      background:var(--chip-bg);
      border:1px solid var(--chip-border);
      color:var(--muted);
    }

    /* Print */
    @media print{
      header,.layout .side-card,.global-actions,.btn-main,.btn-tool,.btn-top,.section-tools,.section-footer{
        display:none !important;
      }
      body{
        background:#ffffff;
        color:#000000;
      }
      .layout{
        padding:0;
        grid-template-columns:1fr;
      }
      .section-card{
        box-shadow:none;
        border:1px solid #ccc;
        border-radius:0;
        page-break-inside:avoid;
      }
      .editor-input{
        border:none;
        resize:none;
        min-height:auto;
        max-height:none;
      }
    }
  </style>
</head>
<body>

<header>
  <h1>FA ‚Äì Annual Report Editor</h1>
  <div class="subtitle">‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏ó‡∏≥‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô ‡∏≠‡∏õ‡∏ó. ‡πÅ‡∏ö‡∏ö‡∏î‡∏¥‡∏à‡∏¥‡∏ó‡∏±‡∏• ‚Äì ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÑ‡∏î‡πâ ‡πÅ‡∏ô‡∏ö‡πÑ‡∏ü‡∏•‡πå‡πÑ‡∏î‡πâ ‡∏ï‡πà‡∏≠ AI ‡πÑ‡∏î‡πâ</div>
  <div class="meta">
    <span>‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏£‡∏±‡∏ö‡∏ï‡∏£‡∏ß‡∏à: <strong id="entityName">[‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•]</strong></span>
    <span>‡∏õ‡∏µ‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì: <strong id="fiscalYear">25xx</strong></span>
    <span>‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î/‡∏≠‡∏≥‡πÄ‡∏†‡∏≠: <strong id="entityLocation">[‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏†‡∏≤‡∏¢‡∏´‡∏•‡∏±‡∏á]</strong></span>
  </div>
  <div class="top-actions">
    <button class="btn-top" onclick="goBackToReportHome()">‚óÄ ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤ ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô FA (‡∏≠‡∏õ‡∏ó.)</button>
    <button class="btn-top" onclick="loadFromMasterData()">üìÇ ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏£‡∏±‡∏ö‡∏ï‡∏£‡∏ß‡∏à‡∏à‡∏≤‡∏Å‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
    <button class="btn-top" onclick="openExpertModal()">üßë‚Äçüíº ‡∏Ç‡∏≠‡∏Ñ‡∏≥‡∏õ‡∏£‡∏∂‡∏Å‡∏©‡∏≤‡∏ú‡∏π‡πâ‡πÄ‡∏ä‡∏µ‡πà‡∏¢‡∏ß‡∏ä‡∏≤‡∏ç</button>
  </div>
</header>

<div class="layout">
  <!-- Sidebar -->
  <aside class="side-card">
    <div class="side-title">‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</div>
    <ul class="nav-list" id="navList">
      <!-- filled by JS -->
    </ul>

    <div class="checklist" id="checklistContainer">
      <!-- filled by JS -->
    </div>

    <div class="check-status" id="checkStatus">
      <span class="dot"></span>
      <span id="checkStatusText">‡∏¢‡∏±‡∏á‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏ä‡πá‡∏Ñ‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö‡∏ó‡∏∏‡∏Å‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠</span>
    </div>

    <div class="side-footer">
      <button class="btn-small secondary" onclick="runGlobalSpellCheck()">üîç ‡∏™‡∏≠‡∏ö‡∏ó‡∏≤‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏â‡∏ö‡∏±‡∏ö</button>
      <button class="btn-small" onclick="openRoutingInfo()">üîó ‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô & Cashboard</button>
    </div>
  </aside>

  <!-- Main -->
  <main class="main" id="mainContent">

    <!-- Sections -->
    <!-- 1 Opinion -->
    <section class="section-card" id="sec-opinion">
      <div class="section-header">
        <div>
          <div class="section-title">1. ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏´‡πá‡∏ô‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡∏™‡∏≠‡∏ö‡∏ö‡∏±‡∏ç‡∏ä‡∏µ (Auditor‚Äôs Opinion)</div>
          <div class="section-sub">
            ‡∏™‡∏£‡∏∏‡∏õ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏´‡πá‡∏ô (‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç / ‡∏°‡∏µ‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç / ‡πÑ‡∏°‡πà‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏´‡πá‡∏ô / ‡πÑ‡∏°‡πà‡∏û‡∏≠‡πÉ‡∏à‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏£‡πâ‡∏≤‡∏¢‡πÅ‡∏£‡∏á) 
            ‡πÅ‡∏•‡∏∞‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö
          </div>
        </div>
        <div class="section-tools">
          <button class="btn-tool" onclick="pullFromDB('opinion')">‚¨á ‡∏î‡∏∂‡∏á‡∏à‡∏≤‡∏Å‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
          <button class="btn-tool" onclick="runAISummarize('opinion')">ü§ñ AI ‡∏ä‡πà‡∏ß‡∏¢‡∏™‡∏£‡∏∏‡∏õ</button>
          <button class="btn-tool" onclick="spellCheck('opinion')">üîç ‡∏™‡∏≠‡∏ö‡∏ó‡∏≤‡∏ô‡∏¢‡πà‡∏≠‡∏´‡∏ô‡πâ‡∏≤</button>
        </div>
      </div>

      <div class="editor-wrapper">
        <div class="editor-box">
          <div class="editor-label">
            <span>‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡πà‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</span>
            <span class="chip">Editable</span>
          </div>
          <textarea id="text-opinion" class="editor-input"
            placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏´‡∏£‡∏∑‡∏≠‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏´‡πá‡∏ô‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡∏™‡∏≠‡∏ö‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà..."></textarea>
          <div id="spell-opinion" class="spell-status" style="display:none;"></div>
          <div class="ai-note">‡πÅ‡∏´‡∏•‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ: ‡∏á‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô 2 ‡∏õ‡∏µ / ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏á‡∏ö / ‡∏™‡∏£‡∏∏‡∏õ‡∏õ‡∏£‡∏∞‡πÄ‡∏î‡πá‡∏ô‡∏™‡∏≤‡∏£‡∏∞‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç</div>
        </div>

        <div class="editor-box">
          <div class="editor-label">
            <span>‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏´‡πá‡∏ô</span>
          </div>
          <input type="file" class="file-input" multiple
                 onchange="handleFileAttach(event,'opinion')">
          <ul class="attach-list" id="attach-opinion"></ul>
          <div class="ai-note">‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á: ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡πÄ‡∏ä‡∏¥‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏á‡∏¥‡∏ô / Memo ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏õ‡∏£‡∏∞‡πÄ‡∏î‡πá‡∏ô‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç</div>
        </div>
      </div>

      <div class="section-footer">
        <span>‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏î‡∏à‡∏≥‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÉ‡∏ô‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå ‚Äì ‡∏Ñ‡∏ß‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏•‡∏á‡∏£‡∏∞‡∏ö‡∏ö‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏´‡∏•‡∏±‡∏á‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç</span>
        <span>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: <span id="status-opinion">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á</span></span>
      </div>
    </section>

    <!-- 2 Basis -->
    <section class="section-card" id="sec-basis">
      <div class="section-header">
        <div>
          <div class="section-title">2. ‡∏ê‡∏≤‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏´‡πá‡∏ô (Basis for Opinion)</div>
          <div class="section-sub">
            ‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô‡∏™‡∏≠‡∏ö‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ ‡∏Ç‡∏≠‡∏ö‡πÄ‡∏Ç‡∏ï‡∏á‡∏≤‡∏ô ‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏≠‡∏ö‡∏ö‡∏±‡∏ç‡∏ä‡∏µ ‡πÅ‡∏•‡∏∞‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏´‡πá‡∏ô
          </div>
        </div>
        <div class="section-tools">
          <button class="btn-tool" onclick="pullFromDB('basis')">‚¨á ‡∏î‡∏∂‡∏á‡∏à‡∏≤‡∏Å‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
          <button class="btn-tool" onclick="runAISummarize('basis')">ü§ñ AI ‡∏ä‡πà‡∏ß‡∏¢‡∏™‡∏£‡∏∏‡∏õ</button>
          <button class="btn-tool" onclick="spellCheck('basis')">üîç ‡∏™‡∏≠‡∏ö‡∏ó‡∏≤‡∏ô‡∏¢‡πà‡∏≠‡∏´‡∏ô‡πâ‡∏≤</button>
        </div>
      </div>

      <div class="editor-wrapper">
        <div class="editor-box">
          <div class="editor-label">
            <span>‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡πà‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</span>
          </div>
          <textarea id="text-basis" class="editor-input"
            placeholder="‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏ê‡∏≤‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏´‡πá‡∏ô ‡πÄ‡∏ä‡πà‡∏ô ‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ ‡∏Ç‡∏≠‡∏ö‡πÄ‡∏Ç‡∏ï‡∏Å‡∏≤‡∏£‡∏™‡∏≠‡∏ö‡∏ö‡∏±‡∏ç‡∏ä‡∏µ ‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠..."></textarea>
          <div id="spell-basis" class="spell-status" style="display:none;"></div>
        </div>

        <div class="editor-box">
          <div class="editor-label">
            <span>‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö</span>
          </div>
          <input type="file" class="file-input" multiple
                 onchange="handleFileAttach(event,'basis')">
          <ul class="attach-list" id="attach-basis"></ul>
          <div class="ai-note">‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á: ‡πÅ‡∏ú‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö / ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏™‡∏£‡∏∏‡∏õ‡∏Ç‡∏≠‡∏ö‡πÄ‡∏Ç‡∏ï / ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏£‡∏ß‡∏à</div>
        </div>
      </div>

      <div class="section-footer">
        <span>‡∏Ñ‡∏ß‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡πÇ‡∏¢‡∏á‡∏Å‡∏±‡∏ö‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏Å‡∏≤‡∏£‡∏ß‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡πÅ‡∏•‡∏∞‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏©‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡∏´‡∏•‡∏±‡∏Å (Lead) ‡πÉ‡∏´‡πâ‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô</span>
        <span>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: <span id="status-basis">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á</span></span>
      </div>
    </section>

    <!-- 3 Emphasis & Other -->
    <section class="section-card" id="sec-emphasis">
      <div class="section-header">
        <div>
          <div class="section-title">3. ‡∏™‡∏≤‡∏£‡∏∞‡πÄ‡∏ô‡πâ‡∏ô‡πÅ‡∏•‡∏∞‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏≠‡∏∑‡πà‡∏ô ‡πÜ (Emphasis of Matter & Other Matters)</div>
          <div class="section-sub">
            ‡πÄ‡∏ô‡πâ‡∏ô‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡∏Ç‡πâ‡∏≠‡∏ö‡∏Å‡∏û‡∏£‡πà‡∏≠‡∏á ‡πÅ‡∏•‡∏∞‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏≠‡∏∑‡πà‡∏ô‡∏ó‡∏µ‡πà‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏ö‡∏Ñ‡∏ß‡∏£‡∏ó‡∏£‡∏≤‡∏ö‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°
          </div>
        </div>
        <div class="section-tools">
          <button class="btn-tool" onclick="pullFromDB('emphasis')">‚¨á ‡∏î‡∏∂‡∏á‡∏à‡∏≤‡∏Å‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
          <button class="btn-tool" onclick="runAISummarize('emphasis')">ü§ñ AI ‡∏ä‡πà‡∏ß‡∏¢‡∏™‡∏£‡∏∏‡∏õ</button>
          <button class="btn-tool" onclick="spellCheck('emphasis')">üîç ‡∏™‡∏≠‡∏ö‡∏ó‡∏≤‡∏ô‡∏¢‡πà‡∏≠‡∏´‡∏ô‡πâ‡∏≤</button>
        </div>
      </div>

      <div class="editor-wrapper">
        <div class="editor-box">
          <div class="editor-label">
            <span>‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡πà‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</span>
          </div>
          <textarea id="text-emphasis" class="editor-input"
            placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏™‡∏≤‡∏£‡∏∞‡πÄ‡∏ô‡πâ‡∏ô (‡πÄ‡∏ä‡πà‡∏ô ‡∏£‡∏∞‡∏ö‡∏ö e-LAAS ‡∏Ç‡∏±‡∏î‡∏Ç‡πâ‡∏≠‡∏á, ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ô‡πÇ‡∏¢‡∏ö‡∏≤‡∏¢‡∏ö‡∏±‡∏ç‡∏ä‡∏µ) ‡πÅ‡∏•‡∏∞‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏≠‡∏∑‡πà‡∏ô ‡πÜ ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏ô‡πâ‡∏ô..."></textarea>
          <div id="spell-emphasis" class="spell-status" style="display:none;"></div>
        </div>

        <div class="editor-box">
          <div class="editor-label">
            <span>‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö</span>
          </div>
          <input type="file" class="file-input" multiple
                 onchange="handleFileAttach(event,'emphasis')">
          <ul class="attach-list" id="attach-emphasis"></ul>
          <div class="ai-note">‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á: ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏ï‡∏Å‡∏•‡∏á / ‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£ / ‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏†‡∏≤‡∏¢‡∏´‡∏•‡∏±‡∏á‡∏á‡∏ö</div>
        </div>
      </div>

      <div class="section-footer">
        <span>‡∏Ñ‡∏ß‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡πÇ‡∏¢‡∏á‡∏Å‡∏±‡∏ö‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ 37‚Äì38, 63 ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏†‡∏≤‡∏¢‡∏´‡∏•‡∏±‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏ô‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</span>
        <span>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: <span id="status-emphasis">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á</span></span>
      </div>
    </section>

    <!-- 4 Management responsibility -->
    <section class="section-card" id="sec-mgmt">
      <div class="section-header">
        <div>
          <div class="section-title">4. ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö‡∏Ç‡∏≠‡∏á‡∏ù‡πà‡∏≤‡∏¢‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£</div>
          <div class="section-sub">
            ‡∏ö‡∏ó‡∏ö‡∏≤‡∏ó‡∏Ç‡∏≠‡∏á‡∏ù‡πà‡∏≤‡∏¢‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏ó‡∏≥‡∏á‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô ‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏†‡∏≤‡∏¢‡πÉ‡∏ô ‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏á‡∏≤‡∏ô‡∏ï‡πà‡∏≠‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á
          </div>
        </div>
        <div class="section-tools">
          <button class="btn-tool" onclick="pullFromDB('mgmt')">‚¨á ‡∏î‡∏∂‡∏á‡∏à‡∏≤‡∏Å‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
          <button class="btn-tool" onclick="runAISummarize('mgmt')">ü§ñ AI ‡∏ä‡πà‡∏ß‡∏¢‡∏™‡∏£‡∏∏‡∏õ</button>
          <button class="btn-tool" onclick="spellCheck('mgmt')">üîç ‡∏™‡∏≠‡∏ö‡∏ó‡∏≤‡∏ô‡∏¢‡πà‡∏≠‡∏´‡∏ô‡πâ‡∏≤</button>
        </div>
      </div>

      <div class="editor-wrapper">
        <div class="editor-box">
          <div class="editor-label">
            <span>‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡πà‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</span>
          </div>
          <textarea id="text-mgmt" class="editor-input"
            placeholder="‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö‡∏Ç‡∏≠‡∏á‡∏ù‡πà‡∏≤‡∏¢‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏ó‡∏≥‡∏á‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô ‡πÅ‡∏•‡∏∞‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏†‡∏≤‡∏¢‡πÉ‡∏ô..."></textarea>
          <div id="spell-mgmt" class="spell-status" style="display:none;"></div>
        </div>

        <div class="editor-box">
          <div class="editor-label">
            <span>‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö</span>
          </div>
          <input type="file" class="file-input" multiple
                 onchange="handleFileAttach(event,'mgmt')">
          <ul class="attach-list" id="attach-mgmt"></ul>
          <div class="ai-note">‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á: ‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö/‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡πÅ‡∏ï‡πà‡∏á‡∏ï‡∏±‡πâ‡∏á‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö / ‡πÅ‡∏ú‡∏ô‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏†‡∏≤‡∏¢‡πÉ‡∏ô</div>
        </div>
      </div>

      <div class="section-footer">
        <span>‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏ï‡∏≤‡∏°‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô ‡∏™‡∏ï‡∏á. ‡πÅ‡∏•‡∏∞‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô‡∏†‡∏≤‡∏Ñ‡∏£‡∏±‡∏ê</span>
        <span>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: <span id="status-mgmt">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á</span></span>
      </div>
    </section>

    <!-- 5 Auditor responsibility -->
    <section class="section-card" id="sec-audresp">
      <div class="section-header">
        <div>
          <div class="section-title">5. ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡∏™‡∏≠‡∏ö‡∏ö‡∏±‡∏ç‡∏ä‡∏µ</div>
          <div class="section-sub">
            ‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡∏™‡∏≠‡∏ö‡∏ö‡∏±‡∏ç‡∏ä‡∏µ ‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á ‡∏Å‡∏≤‡∏£‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏†‡∏≤‡∏¢‡πÉ‡∏ô ‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡∏Å‡∏≤‡∏£‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç
          </div>
        </div>
        <div class="section-tools">
          <button class="btn-tool" onclick="pullFromDB('audresp')">‚¨á ‡∏î‡∏∂‡∏á‡∏à‡∏≤‡∏Å‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
          <button class="btn-tool" onclick="runAISummarize('audresp')">ü§ñ AI ‡∏ä‡πà‡∏ß‡∏¢‡∏™‡∏£‡∏∏‡∏õ</button>
          <button class="btn-tool" onclick="spellCheck('audresp')">üîç ‡∏™‡∏≠‡∏ö‡∏ó‡∏≤‡∏ô‡∏¢‡πà‡∏≠‡∏´‡∏ô‡πâ‡∏≤</button>
        </div>
      </div>

      <div class="editor-wrapper">
        <div class="editor-box">
          <div class="editor-label">
            <span>‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡πà‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</span>
          </div>
          <textarea id="text-audresp" class="editor-input"
            placeholder="‡∏™‡∏£‡∏∏‡∏õ‡∏Ç‡∏≠‡∏ö‡πÄ‡∏Ç‡∏ï ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á ‡πÅ‡∏•‡∏∞‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏≠‡∏ö‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏ï‡∏≤‡∏°‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô‡∏™‡∏≠‡∏ö‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ..."></textarea>
          <div id="spell-audresp" class="spell-status" style="display:none;"></div>
        </div>

        <div class="editor-box">
          <div class="editor-label">
            <span>‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö</span>
          </div>
          <input type="file" class="file-input" multiple
                 onchange="handleFileAttach(event,'audresp')">
          <ul class="attach-list" id="attach-audresp"></ul>
          <div class="ai-note">‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á: ‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö / Risk Assessment / ‡∏™‡∏£‡∏∏‡∏õ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏™‡∏≤‡∏£‡∏∞‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç</div>
        </div>
      </div>

      <div class="section-footer">
        <span>‡∏Ñ‡∏ß‡∏£‡∏™‡∏≠‡∏î‡∏Ñ‡∏•‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ö‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏©‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡∏´‡∏•‡∏±‡∏Å ‡πÅ‡∏•‡∏∞‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏Å‡∏≤‡∏£‡∏ß‡∏≤‡∏á‡πÅ‡∏ú‡∏ô (CA/PA)</span>
        <span>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: <span id="status-audresp">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á</span></span>
      </div>
    </section>

    <!-- 6 Legal / Framework -->
    <section class="section-card" id="sec-framework">
      <div class="section-header">
        <div>
          <div class="section-title">6. ‡∏Å‡∏£‡∏≠‡∏ö‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢ ‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô ‡πÅ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡∏™‡∏±‡∏á‡πÄ‡∏Å‡∏ï‡∏ï‡∏≤‡∏°‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö</div>
          <div class="section-sub">
            ‡∏£‡∏∞‡∏ö‡∏∏‡∏Å‡∏£‡∏≠‡∏ö‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢/‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á ‡πÅ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡∏™‡∏±‡∏á‡πÄ‡∏Å‡∏ï‡πÄ‡∏ä‡∏¥‡∏á‡∏Å‡∏é‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö‡∏ó‡∏µ‡πà‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡πÇ‡∏¢‡∏á‡∏Å‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏Ñ‡πâ‡∏ô‡∏û‡∏ö
          </div>
        </div>
        <div class="section-tools">
          <button class="btn-tool" onclick="pullFromDB('framework')">‚¨á ‡∏î‡∏∂‡∏á‡∏à‡∏≤‡∏Å‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
          <button class="btn-tool" onclick="runAISummarize('framework')">ü§ñ AI ‡∏ä‡πà‡∏ß‡∏¢‡∏™‡∏£‡∏∏‡∏õ</button>
          <button class="btn-tool" onclick="spellCheck('framework')">üîç ‡∏™‡∏≠‡∏ö‡∏ó‡∏≤‡∏ô‡∏¢‡πà‡∏≠‡∏´‡∏ô‡πâ‡∏≤</button>
        </div>
      </div>

      <div class="editor-wrapper">
        <div class="editor-box">
          <div class="editor-label">
            <span>‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡πà‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</span>
          </div>
          <textarea id="text-framework" class="editor-input"
            placeholder="‡∏£‡∏∞‡∏ö‡∏∏ ‡∏û.‡∏£.‡∏ö., ‡∏Å‡∏é‡∏Å‡∏£‡∏∞‡∏ó‡∏£‡∏ß‡∏á, ‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏†‡∏≤‡∏Ñ‡∏£‡∏±‡∏ê, ‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á ‡∏™‡∏ï‡∏á. ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏£‡∏≠‡∏ö‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á..."></textarea>
          <div id="spell-framework" class="spell-status" style="display:none;"></div>
        </div>

        <div class="editor-box">
          <div class="editor-label">
            <span>‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö</span>
          </div>
          <input type="file" class="file-input" multiple
                 onchange="handleFileAttach(event,'framework')">
          <ul class="attach-list" id="attach-framework"></ul>
          <div class="ai-note">‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á: ‡∏Ç‡πâ‡∏≠‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á / ‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡πÄ‡∏ß‡∏µ‡∏¢‡∏ô / ‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡∏´‡∏£‡∏∑‡∏≠‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡∏à‡∏≤‡∏Å ‡∏™‡∏ï‡∏á.</div>
        </div>
      </div>

      <div class="section-footer">
        <span>‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡πÇ‡∏¢‡∏á‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏/‡∏õ‡∏£‡∏∞‡πÄ‡∏î‡πá‡∏ô‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ó‡∏≤‡∏á ‡πÄ‡∏ä‡πà‡∏ô ‡∏ô‡πâ‡∏≥‡∏ö‡∏≤‡∏î‡∏≤‡∏• ‡∏†‡∏≤‡∏©‡∏µ ‡∏Ø‡∏•‡∏Ø</span>
        <span>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: <span id="status-framework">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á</span></span>
      </div>
    </section>

    <!-- 7 Sign-off -->
    <section class="section-card" id="sec-signoff">
      <div class="section-header">
        <div>
          <div class="section-title">7. ‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ô‡∏≤‡∏°‡πÅ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡∏™‡∏≠‡∏ö‡∏ö‡∏±‡∏ç‡∏ä‡∏µ</div>
          <div class="section-sub">
            ‡∏ä‡∏∑‡πà‡∏≠‚Äì‡∏™‡∏Å‡∏∏‡∏• ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á ‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏•‡∏á‡∏ô‡∏≤‡∏° ‡πÅ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠ (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ç‡∏≠‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°)
          </div>
        </div>
        <div class="section-tools">
          <button class="btn-tool" onclick="pullFromDB('signoff')">‚¨á ‡∏î‡∏∂‡∏á‡∏à‡∏≤‡∏Å‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
          <button class="btn-tool" onclick="runAISummarize('signoff')">ü§ñ ‡πÄ‡∏ï‡∏¥‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô</button>
          <button class="btn-tool" onclick="spellCheck('signoff')">üîç ‡∏™‡∏≠‡∏ö‡∏ó‡∏≤‡∏ô‡∏¢‡πà‡∏≠‡∏´‡∏ô‡πâ‡∏≤</button>
        </div>
      </div>

      <div class="editor-wrapper">
        <div class="editor-box">
          <div class="editor-label">
            <span>‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡πà‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô (‡∏™‡πà‡∏ß‡∏ô‡∏ó‡πâ‡∏≤‡∏¢‡∏Å‡πà‡∏≠‡∏ô‡∏•‡∏á‡∏ô‡∏≤‡∏°)</span>
          </div>
          <textarea id="text-signoff" class="editor-input"
            placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡πÄ‡∏°‡∏∑‡∏≠‡∏á ‡∏ß‡∏±‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏õ‡∏µ‡∏•‡∏á‡∏ô‡∏≤‡∏° ‡πÅ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡πà‡∏≠‡∏ô‡∏•‡∏á‡∏ä‡∏∑‡πà‡∏≠..."></textarea>
          <div id="spell-signoff" class="spell-status" style="display:none;"></div>
        </div>

        <div class="editor-box">
          <div class="editor-label">
            <span>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡∏™‡∏≠‡∏ö‡∏ö‡∏±‡∏ç‡∏ä‡∏µ / ‡∏ú‡∏π‡πâ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö</span>
          </div>
          <textarea id="text-signer" class="editor-input"
            placeholder="‡∏ä‡∏∑‡πà‡∏≠‚Äì‡∏™‡∏Å‡∏∏‡∏• ‡∏ú‡∏π‡πâ‡∏™‡∏≠‡∏ö‡∏ö‡∏±‡∏ç‡∏ä‡∏µ&#10;‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á&#10;‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏ú‡πà‡∏ô‡∏î‡∏¥‡∏ô‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î..."></textarea>
          <ul class="attach-list" id="attach-signoff"></ul>
          <div class="ai-note">‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÅ‡∏ô‡∏ö‡∏™‡∏≥‡πÄ‡∏ô‡∏≤‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß‡∏ú‡∏π‡πâ‡∏™‡∏≠‡∏ö‡∏ö‡∏±‡∏ç‡∏ä‡∏µ / ‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡∏°‡∏≠‡∏ö‡∏´‡∏°‡∏≤‡∏¢ / ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡πÅ‡∏ï‡πà‡∏á‡∏ï‡∏±‡πâ‡∏á ‡πÑ‡∏ß‡πâ‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö</div>
        </div>
      </div>

      <div class="section-footer">
        <span>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÉ‡∏ä‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏´‡∏•‡∏±‡∏Å‡πÉ‡∏ô‡∏Å‡∏≤‡∏£ export ‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô A4 / PDF</span>
        <span>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: <span id="status-signoff">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á</span></span>
      </div>
    </section>

    <!-- global actions -->
    <section class="global-actions">
      <div class="global-actions-left">
        <span style="font-size:12px;color:var(--muted);">
          ‚úÖ ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô checklist ‡∏Ñ‡∏£‡∏ö‡∏ó‡∏∏‡∏Å‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡πÅ‡∏•‡πâ‡∏ß ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏™‡∏±‡πà‡∏á‡∏û‡∏¥‡∏°‡∏û‡πå A4 / ‡∏™‡πà‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô / ‡∏™‡πà‡∏á‡∏ï‡πà‡∏≠‡πÑ‡∏õ ‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏≠‡∏ö‡∏ó‡∏≤‡∏ô‚Äì‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‚ÄìCashboard ‡πÑ‡∏î‡πâ
        </span>
      </div>
      <div class="global-actions-right">
        <button class="btn-main secondary" onclick="openExpertModal()">üßë‚Äçüíº ‡∏Ç‡∏≠‡∏Ñ‡∏≥‡∏õ‡∏£‡∏∂‡∏Å‡∏©‡∏≤‡∏ú‡∏π‡πâ‡πÄ‡∏ä‡∏µ‡πà‡∏¢‡∏ß‡∏ä‡∏≤‡∏ç</button>
        <button class="btn-main secondary" onclick="routeReport('review')">üì§ ‡∏™‡πà‡∏á‡πÑ‡∏õ‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏≠‡∏ö‡∏ó‡∏≤‡∏ô</button>
        <button class="btn-main secondary" onclick="routeReport('db')">üíæ ‡∏™‡πà‡∏á‡πÄ‡∏Å‡πá‡∏ö‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏•‡∏≤‡∏á</button>
        <button class="btn-main secondary" onclick="routeReport('dashboard')">üìä ‡∏™‡πà‡∏á‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï Cashboard</button>
        <button id="btnPrint" class="btn-main" onclick="handlePrint()" disabled>üñ® ‡∏û‡∏¥‡∏°‡∏û‡πå‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô (A4)</button>
        <button id="btnSend" class="btn-main danger" onclick="handleSend()" disabled>üì® ‡∏™‡πà‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£</button>
      </div>
    </section>

  </main>
</div>

<!-- Modal: warning / flow error -->
<div class="modal-backdrop" id="modalWarn">
  <div class="modal">
    <div class="modal-title">‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô / ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô</div>
    <div class="modal-body" id="modalWarnBody">
      ‡∏¢‡∏±‡∏á‡∏°‡∏µ‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡πÉ‡∏ô‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ‡∏´‡∏£‡∏∑‡∏≠‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ó‡∏≥ checklist ‡∏Ñ‡∏£‡∏ö‡∏ó‡∏∏‡∏Å‡∏™‡πà‡∏ß‡∏ô
      <ul>
        <li>‡∏ï‡∏£‡∏ß‡∏à‡∏î‡∏π‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏´‡∏°‡∏≤‡∏¢ ‚úì ‡πÉ‡∏ô‡πÅ‡∏ú‡∏á ‚Äú‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‚Äù ‡∏î‡πâ‡∏≤‡∏ô‡∏ã‡πâ‡∏≤‡∏¢</li>
        <li>‡πÉ‡∏ä‡πâ‡∏õ‡∏∏‡πà‡∏° ‚Äú‡∏™‡∏≠‡∏ö‡∏ó‡∏≤‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‚Äù ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏Ñ‡∏≥‡πÅ‡∏•‡∏∞‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô</li>
        <li>‡∏´‡∏≤‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏° ‡πÉ‡∏´‡πâ‡∏Å‡∏î ‚Äú‡∏Ç‡∏≠‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‚Äù</li>
      </ul>
    </div>
    <div class="modal-footer">
      <button class="btn-main secondary" onclick="closeModal('modalWarn')">‡∏£‡∏±‡∏ö‡∏ó‡∏£‡∏≤‡∏ö</button>
      <button class="btn-main secondary" onclick="openExpertModal()">‡∏Ç‡∏≠‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥</button>
      <button class="btn-main" onclick="closeModal('modalWarn')">‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</button>
    </div>
  </div>
</div>

<!-- Modal: expert -->
<div class="modal-backdrop" id="modalExpert">
  <div class="modal">
    <div class="modal-title">‡∏Ç‡∏≠‡∏Ñ‡∏≥‡∏õ‡∏£‡∏∂‡∏Å‡∏©‡∏≤‡∏à‡∏≤‡∏Å‡∏ú‡∏π‡πâ‡πÄ‡∏ä‡∏µ‡πà‡∏¢‡∏ß‡∏ä‡∏≤‡∏ç‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô</div>
    <div class="modal-body">
      ‡∏û‡∏¥‡∏°‡∏û‡πå‡∏õ‡∏£‡∏∞‡πÄ‡∏î‡πá‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∂‡∏Å‡∏©‡∏≤ ‡πÄ‡∏ä‡πà‡∏ô ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏´‡πá‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏° ‡∏Å‡∏≤‡∏£‡∏ï‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ç‡πâ‡∏≠‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢ ‡∏Å‡∏≤‡∏£‡∏à‡∏≥‡πÅ‡∏ô‡∏Å‡∏ö‡∏±‡∏ç‡∏ä‡∏µ ‡∏Ø‡∏•‡∏Ø
      <textarea id="expertQuestion" class="editor-input" style="min-height:80px;margin-top:6px;"
        placeholder="‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á: ‡∏Ç‡πâ‡∏≠‡∏™‡∏á‡∏™‡∏±‡∏¢‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ï‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏Ñ‡πà‡∏≤‡∏ò‡∏£‡∏£‡∏°‡πÄ‡∏ô‡∏µ‡∏¢‡∏°‡∏ö‡∏≤‡∏î‡∏≤‡∏• ‡πÅ‡∏•‡∏∞‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏ï‡πà‡∏≠‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ 42, 45..."></textarea>
    </div>
    <div class="modal-footer">
      <button class="btn-main secondary" onclick="closeModal('modalExpert')">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
      <button class="btn-main" onclick="submitExpertQuestion()">‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°</button>
    </div>
  </div>
</div>

<!-- Modal: routing info -->
<div class="modal-backdrop" id="modalRouteInfo">
  <div class="modal">
    <div class="modal-title">‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡πÑ‡∏õ‡∏¢‡∏±‡∏á ‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏≠‡∏ö‡∏ó‡∏≤‡∏ô / ‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• / Cashboard</div>
    <div class="modal-body">
      ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡∏ß‡∏£‡∏™‡πà‡∏á payload ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô (JSON) ‡πÑ‡∏õ‡∏¢‡∏±‡∏á:
      <ul>
        <li><strong>‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏≠‡∏ö‡∏ó‡∏≤‡∏ô (FA Review)</strong> ‚Äì ‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ä‡∏±‡πâ‡∏ô‡∏ó‡∏µ‡πà 2</li>
        <li><strong>‡∏£‡∏∞‡∏ö‡∏ö‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏•‡∏≤‡∏á</strong> ‚Äì ‡πÄ‡∏Å‡πá‡∏ö‡∏â‡∏ö‡∏±‡∏ö‡∏•‡∏á‡∏ô‡∏≤‡∏°‡πÅ‡∏•‡∏∞‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</li>
        <li><strong>‡∏£‡∏∞‡∏ö‡∏ö Cashboard</strong> ‚Äì ‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏∑‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏ó‡∏≥‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</li>
      </ul>
      ‡πÇ‡∏Ñ‡πâ‡∏î‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ï‡πà‡∏≠‡πÉ‡∏ô‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô <code>routeReport(target)</code> ‡πÉ‡∏ô‡πÑ‡∏ü‡∏•‡πå‡∏ô‡∏µ‡πâ
    </div>
    <div class="modal-footer">
      <button class="btn-main" onclick="closeModal('modalRouteInfo')">‡∏õ‡∏¥‡∏î</button>
    </div>
  </div>
</div>

<script>
  // === CONFIG SECTIONS ===
  const sections = [
    {id:'opinion',   label:'1. ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏´‡πá‡∏ô‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡∏™‡∏≠‡∏ö‡∏ö‡∏±‡∏ç‡∏ä‡∏µ',         required:true},
    {id:'basis',     label:'2. ‡∏ê‡∏≤‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏´‡πá‡∏ô',          required:true},
    {id:'emphasis',  label:'3. ‡∏™‡∏≤‡∏£‡∏∞‡πÄ‡∏ô‡πâ‡∏ô‡πÅ‡∏•‡∏∞‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏≠‡∏∑‡πà‡∏ô ‡πÜ',         required:false},
    {id:'mgmt',      label:'4. ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö‡∏Ç‡∏≠‡∏á‡∏ù‡πà‡∏≤‡∏¢‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£',       required:true},
    {id:'audresp',   label:'5. ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡∏™‡∏≠‡∏ö‡∏ö‡∏±‡∏ç‡∏ä‡∏µ',      required:true},
    {id:'framework', label:'6. ‡∏Å‡∏£‡∏≠‡∏ö‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢‡πÅ‡∏•‡∏∞‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á', required:false},
    {id:'signoff',   label:'7. ‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ô‡∏≤‡∏°‡πÅ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡∏™‡∏≠‡∏ö‡∏ö‡∏±‡∏ç‡∏ä‡∏µ',     required:true},
  ];

  const sectionStatus = {};   // {id: boolean}

  // === INIT ===
  document.addEventListener('DOMContentLoaded', () => {
    buildNav();
    buildChecklist();
    // mark all incomplete initially
    sections.forEach(s => sectionStatus[s.id] = false);
    updateOverallStatus();
  });

  function buildNav(){
    const navList = document.getElementById('navList');
    navList.innerHTML = '';
    sections.forEach((s, idx) => {
      const li = document.createElement('li');
      const btn = document.createElement('button');
      btn.className = 'nav-btn' + (idx === 0 ? ' active' : '');
      btn.dataset.target = s.id;
      btn.onclick = () => scrollToSection(s.id, btn);
      btn.innerHTML = `
        <span>${s.label}</span>
        <span class="badge">${s.required ? '‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥' : '‡∏ó‡∏≤‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å'}</span>
      `;
      li.appendChild(btn);
      navList.appendChild(li);
    });
  }

  function scrollToSection(id, btn){
    const el = document.getElementById('sec-'+id);
    if(el){
      el.scrollIntoView({behavior:'smooth', block:'start'});
      document.querySelectorAll('.nav-btn').forEach(b=>b.classList.remove('active'));
      if(btn) btn.classList.add('active');
    }
  }

  function buildChecklist(){
    const container = document.getElementById('checklistContainer');
    container.innerHTML = '<div style="font-size:12px;margin-bottom:4px;">Checklist ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</div>';
    sections.forEach(s=>{
      const row = document.createElement('div');
      row.className = 'check-row';
      row.innerHTML = `
        <input type="checkbox" id="chk-${s.id}" onchange="toggleChecklist('${s.id}')">
        <label for="chk-${s.id}">${s.label}</label>
      `;
      container.appendChild(row);
    });
  }

  function toggleChecklist(id){
    const checked = document.getElementById('chk-'+id).checked;
    sectionStatus[id] = checked;
    const statusSpan = document.getElementById('status-'+id);
    if(statusSpan){
      statusSpan.textContent = checked ? '‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏ó‡∏≥‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏•‡πâ‡∏ß' : '‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á';
    }
    updateOverallStatus();
  }

  function updateOverallStatus(){
    const checkStatus = document.getElementById('checkStatus');
    const text = document.getElementById('checkStatusText');
    const btnPrint = document.getElementById('btnPrint');
    const btnSend = document.getElementById('btnSend');

    const allRequiredOk = sections
      .filter(s=>s.required)
      .every(s=>sectionStatus[s.id]);

    if(allRequiredOk){
      checkStatus.classList.add('complete');
      text.textContent = '‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô‡πÉ‡∏ô‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏ó‡∏µ‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô ‚Äì ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏û‡∏¥‡∏°‡∏û‡πå‡πÅ‡∏•‡∏∞‡∏™‡πà‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ';
      btnPrint.disabled = false;
      btnSend.disabled = false;
    }else{
      checkStatus.classList.remove('complete');
      text.textContent = '‡∏¢‡∏±‡∏á‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏ä‡πá‡∏Ñ‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö‡∏ó‡∏∏‡∏Å‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏ó‡∏µ‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô';
      btnPrint.disabled = true;
      btnSend.disabled = true;
    }
  }

  // === FILE ATTACH ===
  function handleFileAttach(event, sectionId){
    const files = Array.from(event.target.files || []);
    const list = document.getElementById('attach-'+sectionId);
    files.forEach(file=>{
      const li = document.createElement('li');
      li.innerHTML = `<span>üìé ${file.name}</span>
                      <button onclick="this.parentElement.remove()">‡∏•‡∏ö</button>`;
      list.appendChild(li);
    });
  }

  // === DB & AI HOOKS (Stub) ===
  function pullFromDB(sectionId){
    // stub: replace with real API integration
    const textarea = document.getElementById('text-'+sectionId);
    if(!textarea) return;
    textarea.value = `[‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•] ‡∏£‡πà‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡πà‡∏ß‡∏ô ${sectionId} ‡∏ñ‡∏π‡∏Å‡∏î‡∏∂‡∏á‡∏°‡∏≤‡∏à‡∏≤‡∏Å‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏•‡∏≤‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏ó‡∏≥‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÅ‡∏•‡∏∞‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏Å‡πâ‡∏ï‡πà‡∏≠‡πÑ‡∏î‡πâ...`;
    alert('‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏à‡∏≥‡∏•‡∏≠‡∏á) ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏ô‡∏µ‡πâ‡πÅ‡∏•‡πâ‡∏ß');
  }

  function runAISummarize(sectionId){
    // stub: replace with AI API
    const textarea = document.getElementById('text-'+sectionId);
    if(!textarea) return;
    const base = textarea.value.trim();
    const extra = `\n\n[AI Draft] ‡∏£‡∏∞‡∏ö‡∏ö‡πÑ‡∏î‡πâ‡∏£‡πà‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ ‡πÇ‡∏î‡∏¢‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏à‡∏≤‡∏Å‡∏á‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô 2 ‡∏õ‡∏µ ‡πÅ‡∏•‡∏∞‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á ‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏ó‡∏≥‡∏Ñ‡∏ß‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö ‡∏õ‡∏£‡∏±‡∏ö‡∏ñ‡πâ‡∏≠‡∏¢‡∏Ñ‡∏≥‡πÉ‡∏´‡πâ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°‡∏Å‡πà‡∏≠‡∏ô‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏à‡∏£‡∏¥‡∏á.`;
    textarea.value = base ? (base + extra) : extra;
    alert('AI ‡∏ä‡πà‡∏ß‡∏¢‡∏£‡πà‡∏≤‡∏á/‡πÄ‡∏ï‡∏¥‡∏°‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° (‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏à‡∏≥‡∏•‡∏≠‡∏á) ‡πÅ‡∏•‡πâ‡∏ß ‚Äì ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÅ‡∏•‡∏∞‡∏õ‡∏£‡∏±‡∏ö‡πÉ‡∏´‡πâ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°');
  }

  // === SPELL CHECK (Á∞°Êòì) ===
  function spellCheck(sectionId){
    const textarea = document.getElementById('text-'+sectionId);
    const box = document.getElementById('spell-'+sectionId);
    if(!textarea || !box) return;

    const text = textarea.value.trim();
    if(text.length === 0){
      box.className = 'spell-status warn';
      box.style.display = 'block';
      box.textContent = '‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÉ‡∏ô‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏ô‡∏µ‡πâ ‚Äì ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏™‡∏≠‡∏ö‡∏ó‡∏≤‡∏ô‡πÑ‡∏î‡πâ';
      return;
    }

    const issues = [];
    if(text.length < 80){
      issues.push('‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡πâ‡∏ô‡∏Å‡∏ß‡πà‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£');
    }
    if(!/[.!?‡πê-‡πô]$/.test(text.slice(-1))){
      issues.push('‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏≠‡∏≤‡∏à‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏à‡∏ö‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏Ñ ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏´‡∏°‡∏≤‡∏¢‡∏ß‡∏£‡∏£‡∏Ñ‡∏ï‡∏≠‡∏ô‡∏ó‡πâ‡∏≤‡∏¢');
    }
    if(!/‡∏≠‡∏õ‡∏ó|‡∏á‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô|‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏´‡πá‡∏ô|‡∏ú‡∏π‡πâ‡∏™‡∏≠‡∏ö‡∏ö‡∏±‡∏ç‡∏ä‡∏µ/.test(text)){
      issues.push('‡∏Ñ‡∏ß‡∏£‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏≥‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç ‡πÄ‡∏ä‡πà‡∏ô ‚Äú‡∏á‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô‚Äù, ‚Äú‡∏ú‡∏π‡πâ‡∏™‡∏≠‡∏ö‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‚Äù, ‚Äú‡∏≠‡∏õ‡∏ó.‚Äù ‡πÉ‡∏´‡πâ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏Å‡∏±‡∏ö‡∏ö‡∏£‡∏¥‡∏ö‡∏ó');
    }

    if(issues.length === 0){
      box.className = 'spell-status ok';
      box.style.display = 'block';
      box.textContent = '‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏™‡∏±‡∏á‡πÄ‡∏Å‡∏ï‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô‡πÉ‡∏ô‡πÄ‡∏ä‡∏¥‡∏á‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° ‡πÇ‡∏õ‡∏£‡∏î‡πÉ‡∏´‡πâ‡∏ú‡∏π‡πâ‡∏™‡∏≠‡∏ö‡∏ó‡∏≤‡∏ô‡∏ï‡∏£‡∏ß‡∏à‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á';
    }else{
      box.className = 'spell-status warn';
      box.style.display = 'block';
      box.innerHTML = '‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏™‡∏±‡∏á‡πÄ‡∏Å‡∏ï‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô:<ul>' +
        issues.map(i=>`<li>${i}</li>`).join('') + '</ul>';
    }
  }

  function runGlobalSpellCheck(){
    sections.forEach(s => spellCheck(s.id));
    alert('‡∏£‡∏∞‡∏ö‡∏ö‡πÑ‡∏î‡πâ‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‡∏™‡∏≠‡∏ö‡∏ó‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏ö‡∏ö‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô‡πÉ‡∏ô‡∏ó‡∏∏‡∏Å‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡πÅ‡∏•‡πâ‡∏ß (‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏à‡∏≥‡∏•‡∏≠‡∏á)\n‡πÇ‡∏õ‡∏£‡∏î‡∏ï‡∏£‡∏ß‡∏à‡∏î‡∏π‡∏ú‡∏•‡πÉ‡∏ô‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠');
  }

  // === FLOW CONTROL ===
  function handlePrint(){
    const allRequiredOk = sections.filter(s=>s.required).every(s=>sectionStatus[s.id]);
    if(!allRequiredOk){
      openModal('modalWarn');
      return;
    }
    window.print();
  }

  function handleSend(){
    const allRequiredOk = sections.filter(s=>s.required).every(s=>sectionStatus[s.id]);
    if(!allRequiredOk){
      openModal('modalWarn');
      return;
    }
    // stub: replace with real submit
    alert('‡∏™‡πà‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£ (‡∏à‡∏≥‡∏•‡∏≠‡∏á) ‚Äì ‡πÇ‡∏õ‡∏£‡∏î‡∏ï‡πà‡∏≠ API ‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å PDF / WORD ‡∏ï‡∏≤‡∏°‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î');
  }

  function routeReport(target){
    // stub routing
    let msg = '';
    if(target === 'review') msg = '‡∏™‡πà‡∏á‡∏ï‡πà‡∏≠‡πÑ‡∏õ ‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏≠‡∏ö‡∏ó‡∏≤‡∏ô (FA Review)';
    else if(target === 'db') msg = '‡∏™‡πà‡∏á‡∏ï‡πà‡∏≠‡πÑ‡∏õ ‡∏£‡∏∞‡∏ö‡∏ö‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏•‡∏≤‡∏á';
    else if(target === 'dashboard') msg = '‡∏™‡πà‡∏á‡∏ï‡πà‡∏≠‡πÑ‡∏õ ‡∏£‡∏∞‡∏ö‡∏ö Cashboard ‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏ú‡∏•';
    alert(msg + ' ‚Äì ‡πÇ‡∏õ‡∏£‡∏î‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏° API ‡πÉ‡∏ô‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô routeReport(target)');
  }

  // === MODAL ===
  function openModal(id){
    document.getElementById(id).style.display = 'flex';
  }
  function closeModal(id){
    document.getElementById(id).style.display = 'none';
  }
  function openExpertModal(){
    openModal('modalExpert');
  }
  function openRoutingInfo(){
    openModal('modalRouteInfo');
  }
  function submitExpertQuestion(){
    const q = document.getElementById('expertQuestion').value.trim();
    if(!q){
      alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∂‡∏Å‡∏©‡∏≤‡∏Å‡πà‡∏≠‡∏ô');
      return;
    }
    // stub: send to expert system / ticket
    alert('‡∏£‡∏∞‡∏ö‡∏ö‡πÑ‡∏î‡πâ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡πà‡∏á‡∏ï‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÄ‡∏ä‡∏µ‡πà‡∏¢‡∏ß‡∏ä‡∏≤‡∏ç‡πÅ‡∏•‡πâ‡∏ß (‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏à‡∏≥‡∏•‡∏≠‡∏á)\n\n'+q);
    document.getElementById('expertQuestion').value = '';
    closeModal('modalExpert');
  }

  // === HEADER ACTIONS ===
  function goBackToReportHome(){
    window.location.href = 'fa-lg-annual-report.html';
  }

  function loadFromMasterData(){
    // stub ‚Äì ‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏£‡∏¥‡∏á‡∏Ñ‡∏ß‡∏£‡∏î‡∏∂‡∏á‡∏à‡∏≤‡∏Å‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏£‡∏±‡∏ö‡∏ï‡∏£‡∏ß‡∏à
    document.getElementById('entityName').textContent = '‡πÄ‡∏ó‡∏®‡∏ö‡∏≤‡∏•‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏®‡∏£‡∏µ‡∏™‡∏∞‡πÄ‡∏Å‡∏© (‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á)';
    document.getElementById('fiscalYear').textContent = '2568';
    document.getElementById('entityLocation').textContent = '‡∏≠‡∏≥‡πÄ‡∏†‡∏≠‡πÄ‡∏°‡∏∑‡∏≠‡∏á ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏®‡∏£‡∏µ‡∏™‡∏∞‡πÄ‡∏Å‡∏©';
    alert('‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏£‡∏±‡∏ö‡∏ï‡∏£‡∏ß‡∏à‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß ‚Äì ‡πÇ‡∏õ‡∏£‡∏î‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏° API ‡∏à‡∏£‡∏¥‡∏á‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡∏ú‡∏•‡∏¥‡∏ï');
  }
</script>

</body>
</html>