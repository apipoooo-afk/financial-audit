<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <title>‡πÅ‡∏ö‡∏ö ‡∏≠‡∏õ‡∏ó. 8.2.3 ‚Äì ‡∏á‡∏ö‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô‡∏ù‡∏≤‡∏Å‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£ | FA Digital</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root{
      --bg:#060818;
      --card:#11152b;
      --border:#262b46;
      --pink:#f48fb1;
      --blue:#0d47a1;
      --muted:#a3acc7;
      --green:#4caf50;
      --danger:#ef5350;
    }
    *{box-sizing:border-box;}
    body{
      margin:0;
      font-family:"Segoe UI",Tahoma,sans-serif;
      background:
        radial-gradient(circle at 10% 0%, rgba(123,30,60,0.36) 0, transparent 55%),
        radial-gradient(circle at 90% 100%, rgba(66,165,245,0.32) 0, transparent 55%),
        var(--bg);
      color:#f5f7ff;
    }
    h1,h2,h3,h4{margin:0;}

    .page{
      max-width:1100px;
      margin:24px auto 40px;
      padding:0 16px 32px;
    }

    header{
      background:linear-gradient(120deg,#7b1e3c,#0d47a1,#f48fb1);
      border-radius:18px;
      padding:18px 20px;
      box-shadow:0 10px 30px rgba(0,0,0,0.55);
      margin-bottom:18px;
      border:1px solid rgba(255,255,255,0.15);
    }
    header h1{
      font-size:22px;
      font-weight:800;
    }
    header h2{
      font-size:16px;
      font-weight:400;
      opacity:0.88;
      margin-top:4px;
    }
    .header-row{
      margin-top:10px;
      display:flex;
      flex-wrap:wrap;
      gap:10px;
      font-size:13px;
      opacity:0.9;
    }
    .tag{
      padding:4px 10px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,0.25);
      background:rgba(0,0,0,0.18);
    }

    .btn-row{
      margin-top:10px;
      display:flex;
      flex-wrap:wrap;
      gap:8px;
    }
    button{
      border:none;
      border-radius:999px;
      padding:6px 12px;
      font-size:13px;
      cursor:pointer;
      display:inline-flex;
      align-items:center;
      gap:6px;
    }
    .btn-soft{
      background:rgba(17,21,43,0.9);
      color:#f5f7ff;
      border:1px solid var(--border);
    }
    .btn-primary{
      background:linear-gradient(120deg,#0d47a1,#42a5f5);
      color:#fff;
    }
    .btn-danger{
      background:linear-gradient(120deg,#b71c1c,#ef5350);
      color:#fff;
    }
    .btn-ghost{
      background:transparent;
      border:1px dashed var(--border);
      color:var(--muted);
    }
    .btn-sm{
      padding:3px 8px;
      font-size:11px;
    }

    .section{
      background:rgba(6,8,24,0.8);
      border-radius:16px;
      border:1px solid var(--border);
      padding:16px 18px 18px;
      margin-top:16px;
      box-shadow:0 6px 20px rgba(0,0,0,0.5);
    }
    .section-title{
      font-size:15px;
      font-weight:700;
      margin-bottom:10px;
      display:flex;
      align-items:center;
      gap:8px;
    }
    .section-title span.badge{
      font-size:11px;
      padding:2px 8px;
      border-radius:999px;
      border:1px solid rgba(244,143,177,0.6);
      color:#ffdfe9;
    }

    .grid-2{
      display:grid;
      grid-template-columns:repeat(auto-fit,minmax(260px,1fr));
      gap:8px 18px;
    }
    label{
      font-size:13px;
      display:block;
      margin-bottom:3px;
      color:var(--muted);
    }
    input[type="text"],
    input[type="number"],
    input[type="date"],
    select,
    textarea{
      width:100%;
      padding:6px 8px;
      border-radius:8px;
      border:1px solid var(--border);
      background:var(--card);
      color:#f5f7ff;
      font-size:13px;
    }
    textarea{
      min-height:70px;
      resize:vertical;
    }

    table{
      width:100%;
      border-collapse:collapse;
      font-size:13px;
      margin-top:6px;
    }
    th,td{
      border:1px solid var(--border);
      padding:4px 6px;
      text-align:left;
    }
    th{
      background:rgba(13,71,161,0.6);
      font-weight:600;
      font-size:12px;
    }
    tbody tr:nth-child(even){
      background:rgba(255,255,255,0.01);
    }
    tbody tr:hover{
      background:rgba(255,255,255,0.04);
    }
    td input[type="number"],
    td input[type="text"]{
      font-size:12px;
      padding:3px 5px;
    }

    .text-right{text-align:right;}
    .text-center{text-align:center;}

    .summary-box{
      display:grid;
      grid-template-columns:repeat(auto-fit,minmax(160px,1fr));
      gap:8px 14px;
      margin-top:8px;
    }
    .summary-item{
      background:rgba(9,12,32,0.9);
      border-radius:12px;
      border:1px solid var(--border);
      padding:8px 10px;
      font-size:12px;
    }
    .summary-label{
      color:var(--muted);
      margin-bottom:4px;
    }
    .summary-value{
      font-weight:700;
      font-size:14px;
    }

    .hint{
      font-size:11px;
      color:var(--muted);
      margin-top:4px;
    }

    @media print{
      body{
        background:#fff;
        color:#000;
      }
      header,.section{
        box-shadow:none;
        border-radius:0;
      }
      .section{
        background:#fff;
        border-color:#ccc;
      }
      .no-print{
        display:none!important;
      }
      @page{
        size:A4;
        margin:15mm;
      }
    }
  </style>
</head>
<body>
<div class="page">

  <header class="no-print">
    <h1>‡πÅ‡∏ö‡∏ö ‡∏≠‡∏õ‡∏ó. 8.2.3 ‚Äì ‡∏á‡∏ö‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô‡∏ù‡∏≤‡∏Å‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£</h1>
    <h2>Bank Reconciliation ‚Äì ‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô‡∏î‡∏¥‡∏à‡∏¥‡∏ó‡∏±‡∏• (‡∏≠‡∏õ‡∏ó.)</h2>
    <div class="header-row">
      <div class="tag">FA Digital Working Paper</div>
      <div class="tag">Bank Reconciliation</div>
      <div class="tag">‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡πÇ‡∏¢‡∏á eLASS & ‡∏™‡∏°‡∏∏‡∏î‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£</div>
    </div>

    <div class="btn-row">
      <button class="btn-soft btn-sm"
              type="button"
              onclick="window.location.href='fa-lg-fieldwork.html'">
        ‚¨Ö ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏á‡∏≤‡∏ô‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö (‡∏≠‡∏õ‡∏ó.)
      </button>
      <button class="btn-soft btn-sm"
              type="button"
              onclick="window.location.href='fa-lg-form-8-2-2.html'">
        üíµ ‡πÑ‡∏õ‡πÅ‡∏ö‡∏ö ‡∏≠‡∏õ‡∏ó. 8.2.2 ‡∏ï‡∏£‡∏ß‡∏à‡∏ô‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î
      </button>
    </div>
  </header>

  <!-- 1. Meta -->
  <section class="section">
    <div class="section-title">
      1. ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏£‡∏±‡∏ö‡∏ï‡∏£‡∏ß‡∏à & ‡∏á‡∏ß‡∏î‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö
      <span class="badge">Meta</span>
    </div>
    <div class="grid-2">
      <div>
        <label for="fiscal_year">‡∏õ‡∏µ‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì</label>
        <select id="fiscal_year">
          <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏µ --</option>
        </select>
      </div>
      <div>
        <label for="entity_code">‡∏£‡∏´‡∏±‡∏™‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏£‡∏±‡∏ö‡∏ï‡∏£‡∏ß‡∏à</label>
        <input type="text" id="entity_code" placeholder="‡πÄ‡∏ä‡πà‡∏ô SSK-MUN-001" />
      </div>
      <div>
        <label for="entity_name">‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏£‡∏±‡∏ö‡∏ï‡∏£‡∏ß‡∏à</label>
        <input type="text" id="entity_name" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡πÄ‡∏ó‡∏®‡∏ö‡∏≤‡∏•‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏®‡∏£‡∏µ‡∏™‡∏∞‡πÄ‡∏Å‡∏©" />
      </div>
      <div>
        <label for="entity_type">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏´‡∏ô‡πà‡∏ß‡∏¢</label>
        <input type="text" id="entity_type" placeholder="‡πÄ‡∏ó‡∏®‡∏ö‡∏≤‡∏•‡πÄ‡∏°‡∏∑‡∏≠‡∏á / ‡∏≠‡∏ö‡∏ï. / ‡∏≠‡∏ö‡∏à." />
      </div>
      <div>
        <label for="province">‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î</label>
        <input type="text" id="province" placeholder="‡∏®‡∏£‡∏µ‡∏™‡∏∞‡πÄ‡∏Å‡∏©" />
      </div>
      <div>
        <label for="district">‡∏≠‡∏≥‡πÄ‡∏†‡∏≠</label>
        <input type="text" id="district" placeholder="‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏®‡∏£‡∏µ‡∏™‡∏∞‡πÄ‡∏Å‡∏©" />
      </div>
      <div>
        <label for="audit_date">‡∏á‡∏ß‡∏î‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö (‡∏ì ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà)</label>
        <input type="date" id="audit_date" />
      </div>
      <div>
        <label for="sai_province">‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏ú‡πà‡∏ô‡∏î‡∏¥‡∏ô‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î</label>
        <input type="text" id="sai_province" placeholder="‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏ú‡πà‡∏ô‡∏î‡∏¥‡∏ô‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏®‡∏£‡∏µ‡∏™‡∏∞‡πÄ‡∏Å‡∏©" />
      </div>
      <div>
        <label for="stmt_date">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏á‡∏ö‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏¢‡∏≠‡∏î‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£</label>
        <input type="date" id="stmt_date" />
      </div>
      <div>
        <label for="objective">‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö</label>
        <textarea id="objective" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏¢‡∏≠‡∏î‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÄ‡∏á‡∏¥‡∏ô‡∏ù‡∏≤‡∏Å‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£‡∏ï‡∏≤‡∏°‡∏á‡∏ö‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏¢‡∏≠‡∏î ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏á‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô ‡πÅ‡∏•‡∏∞ eLASS ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà"></textarea>
      </div>
    </div>

    <div class="btn-row no-print" style="margin-top:12px;">
      <button class="btn-soft btn-sm" type="button" onclick="loadFromStorage()">‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å LocalStorage</button>
      <button class="btn-soft btn-sm" type="button" onclick="clearForm()">‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡∏ô‡πâ‡∏≤‡∏ü‡∏≠‡∏£‡πå‡∏°</button>
    </div>
  </section>

  <!-- 2. ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡πÄ‡∏á‡∏¥‡∏ô‡∏ù‡∏≤‡∏Å -->
  <section class="section">
    <div class="section-title">
      2. ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡πÄ‡∏á‡∏¥‡∏ô‡∏ù‡∏≤‡∏Å‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£ / ‡∏á‡∏ö‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏¢‡∏≠‡∏î
      <span class="badge">Bank Accounts</span>
    </div>
    <div class="hint">
      ‡πÉ‡∏™‡πà‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡πÄ‡∏á‡∏¥‡∏ô‡∏ù‡∏≤‡∏Å‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÄ‡∏•‡πà‡∏°: ‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£, ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ö‡∏±‡∏ç‡∏ä‡∏µ, ‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ç‡∏ä‡∏µ, ‡∏¢‡∏≠‡∏î‡∏à‡∏≤‡∏Å eLASS ‡πÅ‡∏•‡∏∞‡∏¢‡∏≠‡∏î‡∏ï‡∏≤‡∏°‡∏ö‡∏±‡∏ç‡∏ä‡∏µ ‡∏≠‡∏õ‡∏ó. / ‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô‡∏†‡∏≤‡∏¢‡πÉ‡∏ô ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ú‡∏•‡∏ï‡πà‡∏≤‡∏á‡πÉ‡∏´‡πâ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
    </div>
    <table id="bank_table">
      <thead>
        <tr>
          <th style="width:80px;">‡∏£‡∏´‡∏±‡∏™‡∏ö‡∏±‡∏ç‡∏ä‡∏µ</th>
          <th>‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£</th>
          <th>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ö‡∏±‡∏ç‡∏ä‡∏µ / ‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ç‡∏ä‡∏µ</th>
          <th style="width:120px;">‡∏¢‡∏≠‡∏î‡∏à‡∏≤‡∏Å eLASS</th>
          <th style="width:120px;">‡∏¢‡∏≠‡∏î‡∏ï‡∏≤‡∏°‡∏ö‡∏±‡∏ç‡∏ä‡∏µ ‡∏≠‡∏õ‡∏ó.</th>
          <th style="width:120px;">‡∏¢‡∏≠‡∏î‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô‡∏†‡∏≤‡∏¢‡πÉ‡∏ô</th>
          <th style="width:100px;">‡∏ú‡∏•‡∏ï‡πà‡∏≤‡∏á</th>
          <th>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏</th>
          <th class="no-print" style="width:60px;">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
        </tr>
      </thead>
      <tbody>
        <!-- ‡πÅ‡∏ñ‡∏ß‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á 3 ‡πÅ‡∏ñ‡∏ß -->
        <tr>
          <td><input type="text" placeholder="110101" /></td>
          <td><input type="text" placeholder="‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£‡∏Å‡∏£‡∏∏‡∏á‡πÑ‡∏ó‡∏¢ ‡∏à‡∏≥‡∏Å‡∏±‡∏î (‡∏°‡∏´‡∏≤‡∏ä‡∏ô) ‡∏™‡∏≤‡∏Ç‡∏≤..." /></td>
          <td><input type="text" placeholder="‡∏Å‡∏£‡∏∞‡πÅ‡∏™‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô ‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ç‡∏ä‡∏µ..." /></td>
          <td><input type="number" step="0.01" value="0" oninput="recalcBanks()" /></td>
          <td><input type="number" step="0.01" value="0" oninput="recalcBanks()" /></td>
          <td><input type="number" step="0.01" value="0" oninput="recalcBanks()" /></td>
          <td class="text-right diff-cell">0.00</td>
          <td><input type="text" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£..." /></td>
          <td class="no-print text-center">
            <button class="btn-ghost btn-sm" type="button" onclick="removeBankRow(this)">‡∏•‡∏ö</button>
          </td>
        </tr>
        <tr>
          <td><input type="text" /></td>
          <td><input type="text" /></td>
          <td><input type="text" /></td>
          <td><input type="number" step="0.01" value="0" oninput="recalcBanks()" /></td>
          <td><input type="number" step="0.01" value="0" oninput="recalcBanks()" /></td>
          <td><input type="number" step="0.01" value="0" oninput="recalcBanks()" /></td>
          <td class="text-right diff-cell">0.00</td>
          <td><input type="text" /></td>
          <td class="no-print text-center">
            <button class="btn-ghost btn-sm" type="button" onclick="removeBankRow(this)">‡∏•‡∏ö</button>
          </td>
        </tr>
        <tr>
          <td><input type="text" /></td>
          <td><input type="text" /></td>
          <td><input type="text" /></td>
          <td><input type="number" step="0.01" value="0" oninput="recalcBanks()" /></td>
          <td><input type="number" step="0.01" value="0" oninput="recalcBanks()" /></td>
          <td><input type="number" step="0.01" value="0" oninput="recalcBanks()" /></td>
          <td class="text-right diff-cell">0.00</td>
          <td><input type="text" /></td>
          <td class="no-print text-center">
            <button class="btn-ghost btn-sm" type="button" onclick="removeBankRow(this)">‡∏•‡∏ö</button>
          </td>
        </tr>
      </tbody>
    </table>
    <div class="btn-row no-print">
      <button class="btn-ghost btn-sm" type="button" onclick="addBankRow()">+ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÅ‡∏ñ‡∏ß‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡πÄ‡∏á‡∏¥‡∏ô‡∏ù‡∏≤‡∏Å</button>
    </div>
  </section>

  <!-- 3. ‡∏™‡∏£‡∏∏‡∏õ‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏° -->
  <section class="section">
    <div class="section-title">
      3. ‡∏™‡∏£‡∏∏‡∏õ‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏° & ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö
      <span class="badge">Summary</span>
    </div>
    <div class="summary-box">
      <div class="summary-item">
        <div class="summary-label">‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°‡∏à‡∏≤‡∏Å eLASS</div>
        <div class="summary-value" id="sum_elass">0.00</div>
      </div>
      <div class="summary-item">
        <div class="summary-label">‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°‡∏ï‡∏≤‡∏°‡∏ö‡∏±‡∏ç‡∏ä‡∏µ ‡∏≠‡∏õ‡∏ó.</div>
        <div class="summary-value" id="sum_gl_lg">0.00</div>
      </div>
      <div class="summary-item">
        <div class="summary-label">‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô‡∏†‡∏≤‡∏¢‡πÉ‡∏ô</div>
        <div class="summary-value" id="sum_gl_sub">0.00</div>
      </div>
      <div class="summary-item">
        <div class="summary-label">‡∏ú‡∏•‡∏ï‡πà‡∏≤‡∏á‡∏£‡∏ß‡∏° (‡∏≠‡∏õ‡∏ó.+‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô - eLASS)</div>
        <div class="summary-value" id="sum_diff">0.00</div>
      </div>
    </div>

    <label for="conclusion" style="margin-top:10px;">‡∏Ç‡πâ‡∏≠‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö</label>
    <textarea id="conclusion" placeholder="‡∏™‡∏£‡∏∏‡∏õ‡∏ß‡πà‡∏≤‡∏°‡∏µ‡∏¢‡∏≠‡∏î‡∏ï‡πà‡∏≤‡∏á‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà ‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏ ‡πÅ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞ ‡πÄ‡∏ä‡πà‡∏ô ‡∏û‡∏ö‡∏ú‡∏•‡∏ï‡πà‡∏≤‡∏á‡∏à‡∏≤‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏•‡∏á‡∏ö‡∏±‡∏ç‡∏ä‡∏µ / ‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡πÉ‡∏ö‡πÅ‡∏à‡πâ‡∏á‡∏¢‡∏≠‡∏î / ‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ú‡∏¥‡∏î ‡∏Ø‡∏•‡∏Ø"></textarea>
  </section>

  <!-- 4. ‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô -->
  <section class="section">
    <div class="section-title">
      4. ‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ö‡∏£‡∏≠‡∏á
      <span class="badge">Signatures</span>
    </div>
    <table id="sign_table">
      <thead>
        <tr>
          <th>‡∏ö‡∏ó‡∏ö‡∏≤‡∏ó</th>
          <th>‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏•</th>
          <th>‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á</th>
          <th style="width:120px;">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏•‡∏á‡∏ô‡∏≤‡∏°</th>
          <th class="no-print" style="width:60px;">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
        </tr>
      </thead>
      <tbody>
      </tbody>
    </table>
    <div class="btn-row no-print">
      <button class="btn-ghost btn-sm" type="button" onclick="addSignRow()">+ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ä‡πà‡∏≠‡∏á‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô</button>
    </div>
  </section>

  <!-- 5. Output -->
  <section class="section no-print">
    <div class="section-title">
      5. ‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡πÄ‡∏Å‡πá‡∏ö / Export / ‡∏û‡∏¥‡∏°‡∏û‡πå
      <span class="badge">Output</span>
    </div>
    <div class="btn-row">
      <button class="btn-primary" type="button" onclick="saveToStorage()">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏•‡∏á‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á (LocalStorage)</button>
      <button class="btn-soft" type="button" onclick="loadFromStorage()">üì• ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏ß‡πâ</button>
      <button class="btn-soft" type="button" onclick="window.print()">üñ® ‡∏û‡∏¥‡∏°‡∏û‡πå / Export ‡πÄ‡∏õ‡πá‡∏ô PDF</button>
      <button class="btn-danger" type="button" onclick="clearForm()">üóë ‡∏•‡πâ‡∏≤‡∏á‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏ô‡∏µ‡πâ</button>
    </div>
    <div class="hint">
      ‡∏Ç‡∏ì‡∏∞‡∏ô‡∏µ‡πâ‡πÉ‡∏ä‡πâ LocalStorage ‡πÉ‡∏ô Browser ‡πÄ‡∏õ‡πá‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß ‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏•‡∏≤‡∏á‡πÉ‡∏ô‡∏Ç‡∏±‡πâ‡∏ô‡∏ñ‡∏±‡∏î‡πÑ‡∏õ
    </div>
  </section>

</div>

<script>
  function formatMoney(num){
    return (num || 0).toLocaleString("th-TH",{minimumFractionDigits:2,maximumFractionDigits:2});
  }

  // ----- ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£ -----
  function addBankRow(){
    const tbody=document.querySelector("#bank_table tbody");
    const tr=document.createElement("tr");
    tr.innerHTML=`
      <td><input type="text" /></td>
      <td><input type="text" /></td>
      <td><input type="text" /></td>
      <td><input type="number" step="0.01" value="0" oninput="recalcBanks()" /></td>
      <td><input type="number" step="0.01" value="0" oninput="recalcBanks()" /></td>
      <td><input type="number" step="0.01" value="0" oninput="recalcBanks()" /></td>
      <td class="text-right diff-cell">0.00</td>
      <td><input type="text" /></td>
      <td class="no-print text-center">
        <button class="btn-ghost btn-sm" type="button" onclick="removeBankRow(this)">‡∏•‡∏ö</button>
      </td>
    `;
    tbody.appendChild(tr);
  }

  function removeBankRow(btn){
    const tr=btn.closest("tr");
    tr.parentElement.removeChild(tr);
    recalcBanks();
  }

  function recalcBanks(){
    const rows=document.querySelectorAll("#bank_table tbody tr");
    let sumElass=0, sumGlLg=0, sumGlSub=0, sumDiff=0;
    rows.forEach(row=>{
      const inputs=row.querySelectorAll("input[type='number']");
      const elass=parseFloat(inputs[0].value || "0");
      const gl_lg=parseFloat(inputs[1].value || "0");
      const gl_sub=parseFloat(inputs[2].value || "0");
      const diff=(gl_lg+gl_sub)-elass;
      row.querySelector(".diff-cell").textContent=formatMoney(diff);
      sumElass+=elass;
      sumGlLg+=gl_lg;
      sumGlSub+=gl_sub;
      sumDiff+=diff;
    });
    document.getElementById("sum_elass").textContent=formatMoney(sumElass);
    document.getElementById("sum_gl_lg").textContent=formatMoney(sumGlLg);
    document.getElementById("sum_gl_sub").textContent=formatMoney(sumGlSub);
    document.getElementById("sum_diff").textContent=formatMoney(sumDiff);
  }

  // ----- ‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô -----
  function addSignRow(data){
    const tbody=document.querySelector("#sign_table tbody");
    const tr=document.createElement("tr");
    tr.innerHTML=`
      <td><input type="text" value="${data?.role || ""}" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏ó‡∏≥ / ‡∏ú‡∏π‡πâ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö / ‡∏ú‡∏≠.‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ï‡∏£‡∏ß‡∏à" /></td>
      <td><input type="text" value="${data?.name || ""}" /></td>
      <td><input type="text" value="${data?.position || ""}" /></td>
      <td><input type="date" value="${data?.signed_date || ""}" /></td>
      <td class="no-print text-center">
        <button class="btn-ghost btn-sm" type="button" onclick="removeSignRow(this)">‡∏•‡∏ö</button>
      </td>
    `;
    tbody.appendChild(tr);
  }

  function removeSignRow(btn){
    const tr=btn.closest("tr");
    tr.parentElement.removeChild(tr);
  }

  // ----- Storage -----
  function getStorageKey(){
    const fy=document.getElementById("fiscal_year").value || "no-year";
    const code=document.getElementById("entity_code").value || "no-entity";
    return `fa_lg_form_8_2_3::${fy}::${code}`;
  }

  function collectFormData(){
    const data={
      meta:{
        fiscal_year:document.getElementById("fiscal_year").value,
        entity_code:document.getElementById("entity_code").value,
        entity_name:document.getElementById("entity_name").value,
        entity_type:document.getElementById("entity_type").value,
        province:document.getElementById("province").value,
        district:document.getElementById("district").value,
        audit_date:document.getElementById("audit_date").value,
        sai_province:document.getElementById("sai_province").value,
        stmt_date:document.getElementById("stmt_date").value,
        objective:document.getElementById("objective").value
      },
      bank_accounts:[],
      summary:{
        sum_elass:0,
        sum_gl_lg:0,
        sum_gl_sub:0,
        sum_diff:0,
        conclusion:document.getElementById("conclusion").value
      },
      signatures:[]
    };

    // bank rows
    document.querySelectorAll("#bank_table tbody tr").forEach(tr=>{
      const tds=tr.querySelectorAll("td");
      const nums=tr.querySelectorAll("input[type='number']");
      const diffText=tr.querySelector(".diff-cell").textContent.replace(/,/g,"");
      data.bank_accounts.push({
        account_code:tds[0].querySelector("input").value,
        bank_name:tds[1].querySelector("input").value,
        account_type_no:tds[2].querySelector("input").value,
        elass_balance:parseFloat(nums[0].value || "0"),
        gl_balance_lg:parseFloat(nums[1].value || "0"),
        gl_balance_sub:parseFloat(nums[2].value || "0"),
        difference:parseFloat(diffText || "0"),
        remark:tds[7].querySelector("input").value
      });
    });

    // summary (‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ã‡πâ‡∏≥‡∏à‡∏≤‡∏Å DOM ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏±‡∏ß‡∏£‡πå)
    const rows=document.querySelectorAll("#bank_table tbody tr");
    let sumElass=0, sumGlLg=0, sumGlSub=0, sumDiff=0;
    rows.forEach(row=>{
      const nums=row.querySelectorAll("input[type='number']");
      const elass=parseFloat(nums[0].value || "0");
      const gl_lg=parseFloat(nums[1].value || "0");
      const gl_sub=parseFloat(nums[2].value || "0");
      const diff=(gl_lg+gl_sub)-elass;
      sumElass+=elass;
      sumGlLg+=gl_lg;
      sumGlSub+=gl_sub;
      sumDiff+=diff;
    });
    data.summary.sum_elass=sumElass;
    data.summary.sum_gl_lg=sumGlLg;
    data.summary.sum_gl_sub=sumGlSub;
    data.summary.sum_diff=sumDiff;

    // signatures
    document.querySelectorAll("#sign_table tbody tr").forEach(tr=>{
      const inputs=tr.querySelectorAll("input");
      data.signatures.push({
        role:inputs[0].value,
        name:inputs[1].value,
        position:inputs[2].value,
        signed_date:inputs[3].value
      });
    });

    return data;
  }

  function fillFormFromData(data){
    if(!data) return;
    if(data.meta){
      document.getElementById("fiscal_year").value=data.meta.fiscal_year || "";
      document.getElementById("entity_code").value=data.meta.entity_code || "";
      document.getElementById("entity_name").value=data.meta.entity_name || "";
      document.getElementById("entity_type").value=data.meta.entity_type || "";
      document.getElementById("province").value=data.meta.province || "";
      document.getElementById("district").value=data.meta.district || "";
      document.getElementById("audit_date").value=data.meta.audit_date || "";
      document.getElementById("sai_province").value=data.meta.sai_province || "";
      document.getElementById("stmt_date").value=data.meta.stmt_date || "";
      document.getElementById("objective").value=data.meta.objective || "";
    }

    // bank accounts
    const tbody=document.querySelector("#bank_table tbody");
    tbody.innerHTML="";
    (data.bank_accounts || []).forEach(b=>{
      const tr=document.createElement("tr");
      tr.innerHTML=`
        <td><input type="text" value="${b.account_code || ""}" /></td>
        <td><input type="text" value="${b.bank_name || ""}" /></td>
        <td><input type="text" value="${b.account_type_no || ""}" /></td>
        <td><input type="number" step="0.01" value="${b.elass_balance || 0}" oninput="recalcBanks()" /></td>
        <td><input type="number" step="0.01" value="${b.gl_balance_lg || 0}" oninput="recalcBanks()" /></td>
        <td><input type="number" step="0.01" value="${b.gl_balance_sub || 0}" oninput="recalcBanks()" /></td>
        <td class="text-right diff-cell">${formatMoney(b.difference || 0)}</td>
        <td><input type="text" value="${b.remark || ""}" /></td>
        <td class="no-print text-center">
          <button class="btn-ghost btn-sm" type="button" onclick="removeBankRow(this)">‡∏•‡∏ö</button>
        </td>
      `;
      tbody.appendChild(tr);
    });
    if(!data.bank_accounts || data.bank_accounts.length===0){
      addBankRow();
      addBankRow();
      addBankRow();
    }
    recalcBanks();

    if(data.summary){
      document.getElementById("conclusion").value=data.summary.conclusion || "";
      document.getElementById("sum_elass").textContent=formatMoney(data.summary.sum_elass || 0);
      document.getElementById("sum_gl_lg").textContent=formatMoney(data.summary.sum_gl_lg || 0);
      document.getElementById("sum_gl_sub").textContent=formatMoney(data.summary.sum_gl_sub || 0);
      document.getElementById("sum_diff").textContent=formatMoney(data.summary.sum_diff || 0);
    }

    // signatures
    const stb=document.querySelector("#sign_table tbody");
    stb.innerHTML="";
    (data.signatures || []).forEach(s=>addSignRow(s));
    if(!data.signatures || data.signatures.length===0){
      addSignRow({role:"‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏ó‡∏≥"});
      addSignRow({role:"‡∏ú‡∏π‡πâ‡∏™‡∏≠‡∏ö‡∏ó‡∏≤‡∏ô"});
      addSignRow({role:"‡∏ú‡∏π‡πâ‡∏≠‡∏≥‡∏ô‡∏ß‡∏¢‡∏Å‡∏≤‡∏£‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ó‡∏µ‡πà 4"});
    }
  }

  function saveToStorage(){
    const key=getStorageKey();
    const data=collectFormData();
    try{
      localStorage.setItem(key,JSON.stringify(data));
      alert("‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ü‡∏≠‡∏£‡πå‡∏° 8.2.3 ‡∏•‡∏á LocalStorage ‡πÅ‡∏•‡πâ‡∏ß\nKey: "+key);
    }catch(e){
      alert("‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: "+e.message);
    }
  }

  function loadFromStorage(){
    const key=getStorageKey();
    const raw=localStorage.getItem(key);
    if(!raw){
      alert("‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡πÄ‡∏Ñ‡∏¢‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏ß‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö key ‡∏ô‡∏µ‡πâ\n‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏õ‡∏µ‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì ‡πÅ‡∏•‡∏∞‡∏£‡∏´‡∏±‡∏™‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏£‡∏±‡∏ö‡∏ï‡∏£‡∏ß‡∏à");
      return;
    }
    try{
      const data=JSON.parse(raw);
      fillFormFromData(data);
      alert("‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏ß‡πâ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢");
    }catch(e){
      alert("‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏≠‡πà‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡πá‡∏ö‡πÑ‡∏ß‡πâ‡πÑ‡∏î‡πâ: "+e.message);
    }
  }

  function clearForm(){
    if(!confirm("‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏ô‡∏µ‡πâ? ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏à‡∏∞‡∏´‡∏≤‡∏¢‡πÑ‡∏õ")) return;
    document.querySelectorAll("input,textarea,select").forEach(el=>{
      if(el.type==="checkbox" || el.type==="radio") el.checked=false;
      else el.value="";
    });

    const tbody=document.querySelector("#bank_table tbody");
    tbody.innerHTML="";
    addBankRow();
    addBankRow();
    addBankRow();
    recalcBanks();

    document.getElementById("conclusion").value="";
    document.getElementById("sum_elass").textContent="0.00";
    document.getElementById("sum_gl_lg").textContent="0.00";
    document.getElementById("sum_gl_sub").textContent="0.00";
    document.getElementById("sum_diff").textContent="0.00";

    const stb=document.querySelector("#sign_table tbody");
    stb.innerHTML="";
    addSignRow({role:"‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏ó‡∏≥"});
    addSignRow({role:"‡∏ú‡∏π‡πâ‡∏™‡∏≠‡∏ö‡∏ó‡∏≤‡∏ô"});
    addSignRow({role:"‡∏ú‡∏π‡πâ‡∏≠‡∏≥‡∏ô‡∏ß‡∏¢‡∏Å‡∏≤‡∏£‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ó‡∏µ‡πà 4"});
  }

  document.addEventListener("DOMContentLoaded",()=>{
    // ‡∏õ‡∏µ‡∏á‡∏ö 2562‚Äì2590
    const fy=document.getElementById("fiscal_year");
    for(let y=2562;y<=2590;y++){
      const opt=document.createElement("option");
      opt.value=y;
      opt.textContent=y;
      fy.appendChild(opt);
    }
    // ‡πÅ‡∏ñ‡∏ß‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏°‡∏µ‡πÅ‡∏•‡πâ‡∏ß‡πÉ‡∏ô HTML (3 ‡πÅ‡∏ñ‡∏ß)
    recalcBanks();
    // ‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô
    addSignRow({role:"‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏ó‡∏≥"});
    addSignRow({role:"‡∏ú‡∏π‡πâ‡∏™‡∏≠‡∏ö‡∏ó‡∏≤‡∏ô"});
    addSignRow({role:"‡∏ú‡∏π‡πâ‡∏≠‡∏≥‡∏ô‡∏ß‡∏¢‡∏Å‡∏≤‡∏£‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ó‡∏µ‡πà 4"});
  });
</script>

</body>
</html>
