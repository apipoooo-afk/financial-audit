<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <title>‡∏≠‡∏õ‡∏ó. 8.8 ‚Äì ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏õ‡∏£‡∏∞‡πÄ‡∏î‡πá‡∏ô</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root{
      --bg:#060818;
      --card:#11152b;
      --border:#262b46;
      --text:#f5f7ff;
      --muted:#a3acc7;
      --accent:#42a5f5;
      --accent2:#26c6da;
      --pink:#f48fb1;
      --success:#66bb6a;
      --danger:#ef5350;
      --warning:#ffb74d;
    }
    *{box-sizing:border-box;}
    body{
      margin:0;
      font-family:"Segoe UI", Tahoma, sans-serif;
      background:var(--bg);
      color:var(--text);
    }
    header{
      padding:20px;
      text-align:center;
      background:linear-gradient(120deg,#0d47a1,#42a5f5,#7b1e3c);
      box-shadow:0 4px 15px rgba(0,0,0,0.5);
    }
    header h1{margin:0;font-size:26px;font-weight:800;}
    header p{margin:6px 0 0 0;font-size:13px;opacity:0.9;}

    .container{
      padding:20px;
      max-width:1200px;
      margin:auto;
    }

    .toolbar{
      margin-bottom:20px;
      display:flex;
      gap:10px;
      flex-wrap:wrap;
    }
    button{
      background:var(--accent);
      border:none;
      color:#fff;
      padding:10px 16px;
      border-radius:8px;
      cursor:pointer;
      font-size:13px;
      font-weight:600;
      display:inline-flex;
      align-items:center;
      gap:6px;
    }
    button.export{background:var(--success);}
    button.load{background:var(--accent2);}
    button.save{background:#0d47a1;}
    button.add-row{background:var(--pink);}
    button.ai{background:var(--warning);}
    button.qa{background:var(--danger);}

    button:hover{opacity:0.9;}

    .meta-card{
      background:var(--card);
      border:1px solid var(--border);
      border-radius:12px;
      padding:14px 16px;
      margin-bottom:18px;
      display:grid;
      grid-template-columns:repeat(auto-fit,minmax(180px,1fr));
      gap:10px 16px;
      font-size:13px;
    }
    .meta-field label{
      display:block;
      font-size:12px;
      color:var(--muted);
      margin-bottom:3px;
    }
    .meta-field span.en{
      font-size:11px;
      opacity:0.75;
    }
    .meta-field input,
    .meta-field select{
      width:100%;
      padding:6px 8px;
      border-radius:6px;
      border:1px solid var(--border);
      background:#0b1024;
      color:var(--text);
      font-size:13px;
    }

    table{
      width:100%;
      border-collapse:collapse;
      margin-top:15px;
      background:var(--card);
    }
    th,td{
      padding:8px;
      border:1px solid var(--border);
      font-size:13px;
      vertical-align:top;
    }
    th{
      background:#0d47a1;
      font-weight:700;
      text-align:center;
    }
    input[type="text"],
    textarea,
    select.risk-select{
      width:100%;
      padding:6px;
      border-radius:6px;
      border:1px solid var(--border);
      background:#0b1024;
      color:var(--text);
      font-size:13px;
    }
    textarea{height:80px;resize:vertical;}

    .attach-btn{
      background:#7b1e3c;
      padding:6px 10px;
      border-radius:8px;
      font-size:12px;
      border:none;
      color:#fff;
      cursor:pointer;
      width:100%;
    }

    .summary{
      margin-top:24px;
      background:var(--card);
      padding:18px;
      border-radius:12px;
      border:1px solid var(--border);
      font-size:13px;
    }
    .summary h3{margin-top:0;margin-bottom:8px;}
    .summary-grid{
      display:grid;
      grid-template-columns:repeat(auto-fit,minmax(160px,1fr));
      gap:10px 16px;
      margin-bottom:10px;
    }
    .summary-item{
      border-radius:10px;
      border:1px solid var(--border);
      padding:8px 10px;
    }
    .summary-item strong{display:block;font-size:18px;margin-bottom:4px;}
    .summary-item span.label{font-size:12px;color:var(--muted);}

    .note{
      font-size:11px;
      color:var(--muted);
      margin-top:4px;
    }

    .footer-sign{
      margin-top:24px;
      display:grid;
      grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
      gap:16px;
      font-size:13px;
    }
    .sign-block{
      border-radius:10px;
      border:1px dashed var(--border);
      padding:12px 14px;
      background:#0b1024;
    }
    .sign-block label{
      display:block;
      font-size:12px;
      color:var(--muted);
      margin-bottom:3px;
    }
    .sign-block input{
      width:100%;
      padding:6px 8px;
      border-radius:6px;
      border:1px solid var(--border);
      background:#060818;
      color:var(--text);
    }

    @media print{
      header{box-shadow:none;}
      .toolbar{display:none;}
      body{background:#fff;color:#000;}
      .container{max-width:100%;padding:10mm;}
      .meta-card,
      .summary,
      .sign-block{
        background:#fff;
        border-color:#000;
      }
      input,textarea,select{
        border-color:#000;
        background:#fff;
        color:#000;
      }
      button{display:none;}
    }
  </style>
</head>
<body>

<header>
  <h1>‡∏≠‡∏õ‡∏ó. 8.8 ‚Äì ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏õ‡∏£‡∏∞‡πÄ‡∏î‡πá‡∏ô</h1>
  <p>‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏®‡∏£‡∏µ‡∏™‡∏∞‡πÄ‡∏Å‡∏© | ‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô‡∏≠‡∏õ‡∏ó. (Fieldwork)</p>
</header>

<div class="container">

  <!-- TOOLBAR -->
  <div class="toolbar">
    <button class="load" onclick="loadData()">
      üì• <span>‡πÇ‡∏´‡∏•‡∏î‡∏à‡∏≤‡∏Å‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</span>
    </button>
    <button class="save" onclick="saveData()">
      üíæ <span>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏•‡∏á‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</span>
    </button>
    <button class="add-row" onclick="addRow()">
      ‚ûï <span>‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö</span>
    </button>
    <button class="ai" onclick="aiSummarize()">
      ü§ñ <span>AI ‡∏ä‡πà‡∏ß‡∏¢‡∏™‡∏£‡∏∏‡∏õ</span>
    </button>
    <button class="qa" onclick="runQA()">
      ‚úÖ <span>‡∏™‡∏≠‡∏ö‡∏ó‡∏≤‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô</span>
    </button>
    <button class="export" onclick="exportPDF()">
      üìÑ <span>Export PDF (A4)</span>
    </button>
  </div>

  <!-- META: ‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏£‡∏±‡∏ö‡∏ï‡∏£‡∏ß‡∏à -->
  <div class="meta-card">
    <div class="meta-field">
      <label>‡∏õ‡∏µ‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì <span class="en">Fiscal Year</span></label>
      <select id="fy">
        <option value="">- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏µ -</option>
        <option>2565</option>
        <option>2566</option>
        <option>2567</option>
        <option>2568</option>
        <option>2569</option>
      </select>
    </div>
    <div class="meta-field">
      <label>‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏£‡∏±‡∏ö‡∏ï‡∏£‡∏ß‡∏à <span class="en">Audited Entity</span></label>
      <input id="entity" type="text" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡πÄ‡∏ó‡∏®‡∏ö‡∏≤‡∏•‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏®‡∏£‡∏µ‡∏™‡∏∞‡πÄ‡∏Å‡∏©">
    </div>
    <div class="meta-field">
      <label>‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î <span class="en">Province</span></label>
      <input id="province" type="text" value="‡∏®‡∏£‡∏µ‡∏™‡∏∞‡πÄ‡∏Å‡∏©">
    </div>
    <div class="meta-field">
      <label>‡∏≠‡∏≥‡πÄ‡∏†‡∏≠ <span class="en">District</span></label>
      <input id="district" type="text">
    </div>
    <div class="meta-field">
      <label>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó ‡∏≠‡∏õ‡∏ó. <span class="en">LG Type</span></label>
      <select id="lgType">
        <option value="">- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å -</option>
        <option>‡πÄ‡∏ó‡∏®‡∏ö‡∏≤‡∏•‡∏ô‡∏Ñ‡∏£</option>
        <option>‡πÄ‡∏ó‡∏®‡∏ö‡∏≤‡∏•‡πÄ‡∏°‡∏∑‡∏≠‡∏á</option>
        <option>‡πÄ‡∏ó‡∏®‡∏ö‡∏≤‡∏•‡∏ï‡∏≥‡∏ö‡∏•</option>
        <option>‡∏≠‡∏ö‡∏ï.</option>
        <option>‡∏≠‡∏∑‡πà‡∏ô‡πÜ</option>
      </select>
    </div>
    <div class="meta-field">
      <label>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡∏£‡∏ß‡∏à <span class="en">Start Date</span></label>
      <input id="startDate" type="date">
    </div>
    <div class="meta-field">
      <label>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î‡∏ï‡∏£‡∏ß‡∏à <span class="en">End Date</span></label>
      <input id="endDate" type="date">
    </div>
  </div>

  <!-- ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡πÄ‡∏î‡πá‡∏ô -->
  <table id="auditTable">
    <thead>
      <tr>
        <th style="width:50px;">‡∏•‡∏≥‡∏î‡∏±‡∏ö<br><span style="font-size:11px;">No.</span></th>
        <th style="width:260px;">‡∏õ‡∏£‡∏∞‡πÄ‡∏î‡πá‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö<br><span style="font-size:11px;">Audit Issue</span></th>
        <th>‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Ç‡πâ‡∏≠‡πÄ‡∏ó‡πá‡∏à‡∏à‡∏£‡∏¥‡∏á<br><span style="font-size:11px;">Findings / Facts</span></th>
        <th style="width:220px;">‡∏Ç‡πâ‡∏≠‡∏™‡∏£‡∏∏‡∏õ‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö<br><span style="font-size:11px;">Auditor's Conclusion</span></th>
        <th style="width:110px;">‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á<br><span style="font-size:11px;">Risk Level</span></th>
        <th style="width:120px;">‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô<br><span style="font-size:11px;">Evidence</span></th>
      </tr>
    </thead>
    <tbody id="auditBody">
      <!-- Default Rows -->
      <tr>
        <td>1</td>
        <td><input type="text" value="‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏ó‡∏µ‡πà‡∏Ç‡∏≤‡∏î‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å"></td>
        <td><textarea></textarea></td>
        <td><textarea></textarea></td>
        <td>
          <select class="risk-select" onchange="updateStats()">
            <option value="">-</option>
            <option value="‡∏™‡∏π‡∏á">‡∏™‡∏π‡∏á</option>
            <option value="‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á">‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á</option>
            <option value="‡∏ï‡πà‡∏≥">‡∏ï‡πà‡∏≥</option>
          </select>
        </td>
        <td>
          <button class="attach-btn" onclick="openFileDialog(this)">üìé ‡πÅ‡∏ô‡∏ö‡πÑ‡∏ü‡∏•‡πå</button>
          <input type="file" style="display:none;">
        </td>
      </tr>
      <tr>
        <td>2</td>
        <td><input type="text" value="‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡πÑ‡∏°‡πà‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏õ‡∏ï‡∏≤‡∏°‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö"></td>
        <td><textarea></textarea></td>
        <td><textarea></textarea></td>
        <td>
          <select class="risk-select" onchange="updateStats()">
            <option value="">-</option>
            <option value="‡∏™‡∏π‡∏á">‡∏™‡∏π‡∏á</option>
            <option value="‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á">‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á</option>
            <option value="‡∏ï‡πà‡∏≥">‡∏ï‡πà‡∏≥</option>
          </select>
        </td>
        <td>
          <button class="attach-btn" onclick="openFileDialog(this)">üìé ‡πÅ‡∏ô‡∏ö‡πÑ‡∏ü‡∏•‡πå</button>
          <input type="file" style="display:none;">
        </td>
      </tr>
      <tr>
        <td>3</td>
        <td><input type="text" value="‡∏™‡∏¥‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏π‡∏ç‡∏´‡∏≤‡∏¢ / ‡πÑ‡∏°‡πà‡∏û‡∏ö‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö"></td>
        <td><textarea></textarea></td>
        <td><textarea></textarea></td>
        <td>
          <select class="risk-select" onchange="updateStats()">
            <option value="">-</option>
            <option value="‡∏™‡∏π‡∏á">‡∏™‡∏π‡∏á</option>
            <option value="‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á">‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á</option>
            <option value="‡∏ï‡πà‡∏≥">‡∏ï‡πà‡∏≥</option>
          </select>
        </td>
        <td>
          <button class="attach-btn" onclick="openFileDialog(this)">üìé ‡πÅ‡∏ô‡∏ö‡πÑ‡∏ü‡∏•‡πå</button>
          <input type="file" style="display:none;">
        </td>
      </tr>
      <tr>
        <td>4</td>
        <td><input type="text" value="‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏õ‡∏Å‡∏ï‡∏¥‡πÉ‡∏ô‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ö‡∏¥‡∏Å"></td>
        <td><textarea></textarea></td>
        <td><textarea></textarea></td>
        <td>
          <select class="risk-select" onchange="updateStats()">
            <option value="">-</option>
            <option value="‡∏™‡∏π‡∏á">‡∏™‡∏π‡∏á</option>
            <option value="‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á">‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á</option>
            <option value="‡∏ï‡πà‡∏≥">‡∏ï‡πà‡∏≥</option>
          </select>
        </td>
        <td>
          <button class="attach-btn" onclick="openFileDialog(this)">üìé ‡πÅ‡∏ô‡∏ö‡πÑ‡∏ü‡∏•‡πå</button>
          <input type="file" style="display:none;">
        </td>
      </tr>
      <tr>
        <td>5</td>
        <td><input type="text" value="‡∏≠‡∏∑‡πà‡∏ô‡πÜ (‡∏ú‡∏π‡πâ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏£‡∏∞‡∏ö‡∏∏)"></td>
        <td><textarea></textarea></td>
        <td><textarea></textarea></td>
        <td>
          <select class="risk-select" onchange="updateStats()">
            <option value="">-</option>
            <option value="‡∏™‡∏π‡∏á">‡∏™‡∏π‡∏á</option>
            <option value="‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á">‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á</option>
            <option value="‡∏ï‡πà‡∏≥">‡∏ï‡πà‡∏≥</option>
          </select>
        </td>
        <td>
          <button class="attach-btn" onclick="openFileDialog(this)">üìé ‡πÅ‡∏ô‡∏ö‡πÑ‡∏ü‡∏•‡πå</button>
          <input type="file" style="display:none;">
        </td>
      </tr>
    </tbody>
  </table>

  <!-- SUMMARY -->
  <div class="summary">
    <h3>‡∏™‡∏£‡∏∏‡∏õ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö</h3>
    <div class="summary-grid">
      <div class="summary-item">
        <strong id="statTotal">0</strong>
        <span class="label">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏õ‡∏£‡∏∞‡πÄ‡∏î‡πá‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£)</span>
      </div>
      <div class="summary-item">
        <strong id="statHigh">0</strong>
        <span class="label">‡∏õ‡∏£‡∏∞‡πÄ‡∏î‡πá‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏™‡∏π‡∏á</span>
      </div>
      <div class="summary-item">
        <strong id="statMedium">0</strong>
        <span class="label">‡∏õ‡∏£‡∏∞‡πÄ‡∏î‡πá‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á</span>
      </div>
      <div class="summary-item">
        <strong id="statLow">0</strong>
        <span class="label">‡∏õ‡∏£‡∏∞‡πÄ‡∏î‡πá‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏ï‡πà‡∏≥</span>
      </div>
    </div>
    <textarea id="finalSummary" placeholder="‡∏™‡∏£‡∏∏‡∏õ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏° ‡∏Ç‡πâ‡∏≠‡∏ö‡∏Å‡∏û‡∏£‡πà‡∏≠‡∏á‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç ‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö ‡πÅ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞‡πÉ‡∏ô‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°..."></textarea>
    <div class="note">
      * ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÉ‡∏ô‡∏ä‡πà‡∏≠‡∏á‡∏ô‡∏µ‡πâ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏´‡πâ AI ‡∏ä‡πà‡∏ß‡∏¢‡∏£‡πà‡∏≤‡∏á‡πÑ‡∏î‡πâ ‡πÇ‡∏î‡∏¢‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° ‚ÄúAI ‡∏ä‡πà‡∏ß‡∏¢‡∏™‡∏£‡∏∏‡∏õ‚Äù
    </div>
  </div>

  <!-- ‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏ó‡∏≥ / ‡∏ú‡∏π‡πâ‡∏™‡∏≠‡∏ö‡∏ó‡∏≤‡∏ô -->
  <div class="footer-sign">
    <div class="sign-block">
      <label>‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏ó‡∏≥ (‡∏ú‡∏π‡πâ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö) / Prepared by</label>
      <input id="preparedBy" type="text" placeholder="‡∏ä‡∏∑‡πà‡∏≠ ‚Äì ‡∏™‡∏Å‡∏∏‡∏•">
      <label style="margin-top:6px;">‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á / Position</label>
      <input id="preparedPos" type="text">
    </div>
    <div class="sign-block">
      <label>‡∏ú‡∏π‡πâ‡∏™‡∏≠‡∏ö‡∏ó‡∏≤‡∏ô / Reviewed by</label>
      <input id="reviewedBy" type="text" placeholder="‡∏ä‡∏∑‡πà‡∏≠ ‚Äì ‡∏™‡∏Å‡∏∏‡∏•">
      <label style="margin-top:6px;">‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á / Position</label>
      <input id="reviewedPos" type="text">
    </div>
  </div>

</div>

<script>
function addRow(){
  const table = document.getElementById("auditBody");
  const rowCount = table.rows.length + 1;

  const row = document.createElement("tr");
  row.innerHTML = `
    <td>${rowCount}</td>
    <td><input type="text" /></td>
    <td><textarea></textarea></td>
    <td><textarea></textarea></td>
    <td>
      <select class="risk-select" onchange="updateStats()">
        <option value="">-</option>
        <option value="‡∏™‡∏π‡∏á">‡∏™‡∏π‡∏á</option>
        <option value="‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á">‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á</option>
        <option value="‡∏ï‡πà‡∏≥">‡∏ï‡πà‡∏≥</option>
      </select>
    </td>
    <td>
      <button class="attach-btn" onclick="openFileDialog(this)">üìé ‡πÅ‡∏ô‡∏ö‡πÑ‡∏ü‡∏•‡πå</button>
      <input type="file" style="display:none;">
    </td>
  `;
  table.appendChild(row);
  updateStats();
}

function openFileDialog(btn){
  const fileInput = btn.nextElementSibling;
  if(fileInput) fileInput.click();
}

// MOCK: ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡∏ê‡∏≤‡∏ô
function loadData(){
  alert("TODO: ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏° API ‡∏à‡∏£‡∏¥‡∏á ‡πÄ‡∏ä‡πà‡∏ô GET /api/fa/lg/8-8?entityId=xxx\n‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô mock ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö UI");
  // ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á JSON ‡∏ó‡∏µ‡πà‡∏Ñ‡∏ß‡∏£‡πÉ‡∏ä‡πâ
  // fetch('/api/fa/lg/8-8?entityId=xxx')
  //   .then(r=>r.json())
  //   .then(data=>{ ...‡πÄ‡∏ï‡∏¥‡∏°‡∏Ñ‡πà‡∏≤‡πÉ‡∏™‡πà‡∏ü‡∏≠‡∏£‡πå‡∏°... });
}

// MOCK: ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏•‡∏á‡∏ê‡∏≤‡∏ô
function saveData(){
  const payload = collectFormData();
  console.log("FA 8.8 payload", payload);
  alert("TODO: POST ‡πÑ‡∏õ‡∏¢‡∏±‡∏á /api/fa/lg/8-8\n‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÉ‡∏ô console (F12)");
  // fetch('/api/fa/lg/8-8',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(payload)})
  //   .then(r=>r.json())
  //   .then(res=>alert('‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à'));
}

// ‡∏£‡∏ß‡∏ö‡∏£‡∏ß‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏ü‡∏≠‡∏£‡πå‡∏°
function collectFormData(){
  const rows = [];
  const tbody = document.getElementById("auditBody");
  [...tbody.rows].forEach((tr,idx)=>{
    const cells = tr.cells;
    const issue = cells[1].querySelector("input")?.value || "";
    const fact  = cells[2].querySelector("textarea")?.value || "";
    const concl = cells[3].querySelector("textarea")?.value || "";
    const risk  = cells[4].querySelector("select")?.value || "";
    rows.push({
      no: idx+1,
      issue,
      fact,
      conclusion: concl,
      risk
      // ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏: ‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏ô‡∏ö ‡πÉ‡∏´‡πâ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà backend / upload ‡πÅ‡∏¢‡∏Å endpoint
    });
  });

  return {
    meta:{
      fy: document.getElementById("fy").value,
      entity: document.getElementById("entity").value,
      province: document.getElementById("province").value,
      district: document.getElementById("district").value,
      lgType: document.getElementById("lgType").value,
      startDate: document.getElementById("startDate").value,
      endDate: document.getElementById("endDate").value
    },
    rows,
    stats:{
      total: rows.length,
      // ‡∏à‡∏∞ recalculated ‡∏ó‡∏µ‡πà backend ‡∏Å‡πá‡πÑ‡∏î‡πâ
    },
    finalSummary: document.getElementById("finalSummary").value,
    preparedBy: document.getElementById("preparedBy").value,
    preparedPos: document.getElementById("preparedPos").value,
    reviewedBy: document.getElementById("reviewedBy").value,
    reviewedPos: document.getElementById("reviewedPos").value
  };
}

// ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á
function updateStats(){
  const selects = document.querySelectorAll(".risk-select");
  let total = 0, high=0, med=0, low=0;
  selects.forEach(sel=>{
    const v = sel.value;
    if(v) total++;
    if(v==="‡∏™‡∏π‡∏á") high++;
    if(v==="‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á") med++;
    if(v==="‡∏ï‡πà‡∏≥") low++;
  });
  document.getElementById("statTotal").textContent = total;
  document.getElementById("statHigh").textContent = high;
  document.getElementById("statMedium").textContent = med;
  document.getElementById("statLow").textContent = low;
}

// AI ‡∏ä‡πà‡∏ß‡∏¢‡∏™‡∏£‡∏∏‡∏õ (placeholder)
function aiSummarize(){
  const payload = collectFormData();
  console.log("‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ AI", payload);
  alert("TODO: ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏° AI backend (‡πÄ‡∏ä‡πà‡∏ô n8n ‚Üí OpenAI/Gemini) ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡πà‡∏≤‡∏á‡∏™‡∏£‡∏∏‡∏õ‡∏•‡∏á‡∏ä‡πà‡∏≠‡∏á‡∏™‡∏£‡∏∏‡∏õ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°");
  // ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á:
  // fetch('/api/ai/summarize-8-8',{method:'POST',body:JSON.stringify(payload)})
  //   .then(r=>r.json())
  //   .then(res=>{ document.getElementById("finalSummary").value = res.summary; });
}

// QA ‡∏ï‡∏£‡∏ß‡∏à‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô (placeholder)
function runQA(){
  const payload = collectFormData();
  let missing = 0;
  payload.rows.forEach(r=>{
    if(!r.issue && !r.fact && !r.conclusion) return; // ‡∏Ç‡πâ‡∏≤‡∏°‡πÅ‡∏ñ‡∏ß‡∏ß‡πà‡∏≤‡∏á
    if(!r.issue || !r.fact || !r.conclusion) missing++;
  });
  alert(
    "‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏™‡∏≠‡∏ö‡∏ó‡∏≤‡∏ô‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô:\n" +
    "- ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÅ‡∏ñ‡∏ß‡∏ó‡∏µ‡πà‡∏≠‡∏≤‡∏à‡∏Å‡∏£‡∏≠‡∏Å‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö: " + missing + " ‡πÅ‡∏ñ‡∏ß\n" +
    "‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏ä‡∏¥‡∏á‡∏•‡∏∂‡∏Å‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏° AI/Rule Engine ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°‡πÑ‡∏î‡πâ"
  );
  // ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏¢‡∏Å‡∏£‡∏∞‡∏î‡∏±‡∏ö‡πÄ‡∏õ‡πá‡∏ô call API QA ‡∏à‡∏£‡∏¥‡∏á‡πÑ‡∏î‡πâ
  console.log("QA payload", payload);
}

function exportPDF(){
  updateStats(); // ‡πÉ‡∏´‡πâ‡πÄ‡∏•‡∏Ç‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡∏Å‡πà‡∏≠‡∏ô‡∏û‡∏¥‡∏°‡∏û‡πå
  window.print();
}

// initial
window.addEventListener("DOMContentLoaded", updateStats);
</script>

</body>
</html>