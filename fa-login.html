<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>FA Login | Financial Audit System</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <style>
    :root{
      --bg:#060818;
      --card:#11152b;
      --border:#262b46;
      --pink:#f48fb1;
      --blue:#0d47a1;
      --muted:#a3acc7;
    }
    body{
      margin:0;
      font-family:"Segoe UI",Tahoma,sans-serif;
      background:
        radial-gradient(circle at 10% 0%, rgba(123,30,60,0.36) 0, transparent 55%),
        radial-gradient(circle at 90% 100%, rgba(66,165,245,0.32) 0, transparent 55%),
        var(--bg);
      color:#f5f7ff;
    }
    header{
      padding:20px 10px;
      text-align:center;
      background:linear-gradient(120deg,#7b1e3c,#0d47a1,#f48fb1);
      border-bottom:1px solid rgba(255,255,255,0.12);
      box-shadow:0 6px 18px rgba(0,0,0,0.6);
    }
    header h1{
      margin:0;
      font-size:28px;
      font-weight:800;
    }
    header h3{
      margin:4px 0 0;
      font-size:16px;
      opacity:.92;
    }

    .wrap{
      max-width:480px;
      margin:40px auto;
      padding:0 20px;
    }
    .card{
      background:var(--card);
      border-radius:18px;
      border:1px solid rgba(255,255,255,0.12);
      padding:24px;
      box-shadow:0 10px 28px rgba(0,0,0,0.7);
      resize:both;
      overflow:auto;
    }
    h2{margin:0 0 6px;font-size:24px;}
    .muted{color:var(--muted);font-size:15px;margin-bottom:18px;}

    label{display:block;margin:10px 0 6px;font-weight:600;}

    input[type="email"],
    input[type="password"],
    input[type="number"]{
      width:100%;
      padding:12px 14px;
      border-radius:10px;
      border:1px solid rgba(255,255,255,0.12);
      background:rgba(5,8,26,0.92);
      color:#fff;
      outline:none;
      font-size:16px;
    }
    input:focus{
      border-color:var(--pink);
      box-shadow:0 0 0 1px rgba(244,143,177,0.4);
    }

    /* ‡∏Å‡∏•‡πà‡∏≠‡∏á password + ‡∏õ‡∏∏‡πà‡∏°‡∏î‡∏π‡∏£‡∏´‡∏±‡∏™ */
    .pass-wrapper{
      position:relative;
    }
    .toggle-pass{
      position:absolute;
      right:12px;
      top:50%;
      transform:translateY(-50%);
      font-size:22px;
      cursor:pointer;
      color:#f48fb1;
      opacity:0.9;
    }
    .toggle-pass:hover{ opacity:1; }

    .human-box{
      margin-top:18px;
      padding:12px 14px;
      border-radius:12px;
      border:1px solid rgba(66,165,245,0.5);
      background:rgba(13,71,161,0.25);
      font-size:15px;
    }

    .btn-primary{
      width:100%;
      padding:14px 18px;
      border:none;
      border-radius:999px;
      font-size:18px;
      color:#fff;
      cursor:pointer;
      margin-top:18px;
      background:linear-gradient(135deg,#f48fb1,#42a5f5);
      box-shadow:0 6px 20px rgba(244,143,177,0.6);
      font-weight:800;
    }
    .btn-primary:hover{
      filter:brightness(1.05);
    }

    /* ‡∏õ‡∏∏‡πà‡∏°‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å */
    .btn-back{
      display:block;
      text-align:center;
      padding:12px;
      margin-top:20px;
      color:#fff;
      font-size:16px;
      font-weight:700;
      text-decoration:none;
      border-radius:12px;
      border:1px solid rgba(255,255,255,0.25);
      background:rgba(255,255,255,0.10);
    }
    .btn-back:hover{
      background:rgba(255,255,255,0.18);
    }

    .alert{
      margin-top:12px;
      padding:10px;
      border-radius:10px;
      background:rgba(198,40,40,0.15);
      border:1px solid rgba(198,40,40,0.7);
      font-size:14px;
      color:#ffb3b3;
      display:none;
    }
  </style>
</head>

<body>

<header>
  <h1>üîê Financial Audit ‚Äì FA Login</h1>
  <h3>‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô (FA System)</h3>
</header>

<div class="wrap">
  <div class="card">

    <h2>‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</h2>
    <p class="muted">‡πÉ‡∏ä‡πâ‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏´‡∏•‡∏±‡∏Å (‡∏´‡∏ô‡πâ‡∏≤ login.html)</p>

    <div id="msgAlert" class="alert"></div>

    <form id="faLoginForm">

      <label>‡∏≠‡∏µ‡πÄ‡∏°‡∏•</label>
      <input type="email" id="faEmail" placeholder="‡πÄ‡∏ä‡πà‡∏ô apipoooo@gmail.com" required>

      <label>‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô</label>
      <div class="pass-wrapper">
        <input type="password" id="faPass" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô" required>
        <span class="toggle-pass" id="togglePass">üëÅ</span>
      </div>

      <label style="margin-top:14px;">
        <input type="checkbox" id="rememberUser"> ‡∏à‡∏≥‡∏≠‡∏µ‡πÄ‡∏°‡∏• (‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 3 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô)
      </label>

      <div class="human-box">
        <div id="humanQ" style="font-weight:800;margin-bottom:6px;"></div>
        <input type="number" id="humanA" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏°‡∏ô‡∏∏‡∏©‡∏¢‡πå" required>
      </div>

      <button type="submit" class="btn-primary">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö FA System</button>

    </form>

    <!-- ‡∏õ‡∏∏‡πà‡∏°‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å -->
    <a href="index.html" class="btn-back">‚¨Ö ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å (Home)</a>

  </div>
</div>

<script>
/* ============ ‡∏õ‡∏∏‡πà‡∏°‡∏î‡∏π‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô ============ */
document.getElementById("togglePass").addEventListener("click", () => {
  const passField = document.getElementById("faPass");
  const icon = document.getElementById("togglePass");

  if(passField.type === "password"){
    passField.type = "text";
    icon.textContent = "üëÅ‚Äçüó®";
  } else {
    passField.type = "password";
    icon.textContent = "üëÅ";
  }
});

/* ============ Human validation ============ */
let humanCorrect = 0;
function genHumanQuestion(){
  const a = Math.floor(Math.random()*9)+1;
  const b = Math.floor(Math.random()*9)+1;
  humanCorrect = a + b;
  document.getElementById("humanQ").textContent = `‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏°‡∏ô‡∏∏‡∏©‡∏¢‡πå: ${a} + ${b} = ?`;
}
genHumanQuestion();

/* ============ ‡∏à‡∏≥‡∏≠‡∏µ‡πÄ‡∏°‡∏• 3 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ============ */
const REMEMBER_KEY = "fa-remember-email";

function rememberEmail(email){
  const ttl = 90*24*60*60*1000;
  localStorage.setItem(REMEMBER_KEY, JSON.stringify({
    email, expiresAt: Date.now() + ttl
  }));
}
function loadRememberedEmail(){
  const raw = localStorage.getItem(REMEMBER_KEY);
  if(!raw) return;
  const data = JSON.parse(raw);
  if(Date.now() > data.expiresAt){
    localStorage.removeItem(REMEMBER_KEY);
    return;
  }
  faEmail.value = data.email;
  rememberUser.checked = true;
}
loadRememberedEmail();

/* ============ ‡πÇ‡∏´‡∏•‡∏î‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‡∏´‡∏•‡∏±‡∏Å ============ */
function loadUsers(){
  try{
    const raw = localStorage.getItem("fas-users");
    return raw ? JSON.parse(raw) : [];
  }catch{ return []; }
}

/* ============ ‡∏™‡∏£‡πâ‡∏≤‡∏á session ============ */
function createSession(email){
  const ttl = 8*60*60*1000;
  localStorage.setItem("fas-session", JSON.stringify({
    email,
    loginAt: Date.now(),
    expiresAt: Date.now() + ttl
  }));
}

/* ============ Login ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå ============ */
document.getElementById("faLoginForm").addEventListener("submit", e=>{
  e.preventDefault();

  const email = faEmail.value.trim().toLowerCase();
  const pass  = faPass.value.trim();
  const ans   = humanA.value.trim();

  if(Number(ans) !== humanCorrect){
    msgAlert.style.display = "block";
    msgAlert.textContent = "‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏õ‡πá‡∏ô‡∏°‡∏ô‡∏∏‡∏©‡∏¢‡πå‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á";
    genHumanQuestion();
    return;
  }

  const users = loadUsers();
  const user  = users.find(u => (u.email||"").toLowerCase() === email);

  if(!user){
    alert("‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏ô‡∏µ‡πâ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÉ‡∏´‡∏°‡πà");
    location.href = "login.html#register-section";
    return;
  }

  if(user.password !== pass){
    alert("‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á");
    location.href = "login.html#register-section";
    return;
  }

  if(user.status !== "approved"){
    alert("‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥");
    location.href = "login.html#register-section";
    return;
  }

  if(rememberUser.checked){
    rememberEmail(email);
  }else{
    localStorage.removeItem(REMEMBER_KEY);
  }

  createSession(email);
  location.href = "fa-menu.html";
});
</script>

</body>
</html>
