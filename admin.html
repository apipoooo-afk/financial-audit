<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <title>Admin Console | Financial Audit System</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root{
      --primary:#0d47a1;
      --primary-2:#42a5f5;
      --accent:#ffd54f;
      --bg:#060818;
      --bg-soft:#0b1024;
      --card:#11152b;
      --text:#f5f7ff;
      --muted:#a3acc7;
      --border:#262b46;
      --maroon:#7b1e3c;
      --pink:#f48fb1;
      --chip-bg:rgba(244,143,177,0.12);
      --chip-border:rgba(244,143,177,0.5);
      --success:#66bb6a;
      --warning:#ffca28;
      --danger:#ef5350;
    }

    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:"Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      background:
        radial-gradient(circle at 10% 0%, rgba(123,30,60,0.36) 0, transparent 55%),
        radial-gradient(circle at 90% 100%, rgba(66,165,245,0.32) 0, transparent 55%),
        radial-gradient(circle at 0% 100%, rgba(244,143,177,0.25) 0, transparent 55%),
        var(--bg);
      color:var(--text);
      transition:background .25s ease,color .25s ease;
    }
    a{color:var(--pink); text-decoration:none}
    a:hover{text-decoration:underline}

    .container{max-width:1120px; margin:0 auto; padding:0 20px;}

    header{
      position:sticky; top:0; z-index:50;
      background:linear-gradient(120deg,var(--maroon),var(--primary),var(--pink));
      box-shadow:0 10px 28px rgba(0,0,0,.55);
      border-bottom:1px solid rgba(255,255,255,0.06);
      backdrop-filter:blur(16px);
    }
    .header-inner{
      display:flex; align-items:center; justify-content:space-between;
      padding:10px 0; gap:16px;
    }
    .brand{
      display:flex; align-items:center; gap:10px;
      font-weight:700; font-size:18px;
      letter-spacing:.03em;
    }
    .brand img{
      height:40px;
      border-radius:50%;
      background:#fff;
      padding:4px;
      box-shadow:0 4px 10px rgba(0,0,0,0.4);
    }
    .brand span.small{
      display:block; font-size:11px; font-weight:500; opacity:.85;
    }
    .header-right{
      display:flex; align-items:center; gap:10px; flex-wrap:wrap;
      font-size:12px;
    }
    .chip{
      display:inline-flex; align-items:center; gap:6px;
      padding:6px 10px; border-radius:999px;
      background:var(--chip-bg);
      border:1px solid var(--chip-border);
      font-size:11px; font-weight:600;
    }
    .chip span.dot{
      width:8px; height:8px; border-radius:50%;
      background:#69f0ae; box-shadow:0 0 8px #69f0ae;
    }
    .back-link{
      padding:6px 10px; border-radius:999px;
      border:1px solid rgba(255,255,255,0.4);
      background:rgba(0,0,0,0.2);
      color:#fff; text-decoration:none;
      display:inline-flex; align-items:center; gap:6px;
    }
    .back-link:hover{
      background:rgba(0,0,0,0.4);
    }

    main{padding:30px 0 24px;}

    h1{font-size:24px; margin:0 0 10px;}
    h2{font-size:20px; margin:0 0 10px;}
    h3{font-size:16px; margin:0 0 8px; color:#e0e5ff;}
    .muted{color:var(--muted); font-size:12px;}

    .card{
      background:linear-gradient(145deg,rgba(17,21,43,0.98),rgba(25,31,60,0.98));
      border-radius:14px;
      border:1px solid rgba(255,255,255,0.06);
      box-shadow:0 14px 34px rgba(0,0,0,.8);
      padding:18px;
      position:relative;
      overflow:hidden;
    }
    .card::before{
      content:"";
      position:absolute; inset:-40%;
      background:radial-gradient(circle at 0 0, rgba(244,143,177,0.18) 0, transparent 55%);
      opacity:0; transition:opacity .25s ease;
      pointer-events:none;
    }
    .card:hover::before{opacity:1;}
    .card>*{position:relative; z-index:1;}

    /* ‡∏™‡∏µ‡πÅ‡∏¢‡∏Å‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏£‡∏∞‡∏ö‡∏ö‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤ admin */
    .card-login{border-top:3px solid #42a5f5;}
    .card-request{border-top:3px solid #f48fb1;}
    .card-reset{border-top:3px solid #ffca28;}
    .card-admin-current{border-top:3px solid #26a69a;}
    .card-admin-summary{border-top:3px solid #ab47bc;}
    .card-admin-create{border-top:3px solid #66bb6a;}
    .card-admin-list{border-top:3px solid #ffa726;}
    .card-requests-main{border-top:3px solid #ec407a;}
    .card-future{border-top:3px solid #5c6bc0;}

    label{display:block; font-size:13px; font-weight:600; margin:8px 0 4px;}
    input, select{
      width:100%; padding:8px 10px; border-radius:8px;
      border:1px solid rgba(255,255,255,0.12);
      background:rgba(5,8,26,0.9);
      color:#fff;
      font-size:13px;
      outline:none;
    }
    input:focus, select:focus{
      border-color:var(--pink);
      box-shadow:0 0 0 1px rgba(244,143,177,0.4);
    }
    button{
      padding:8px 14px;
      border-radius:999px;
      border:none;
      cursor:pointer;
      font-size:13px;
      font-weight:700;
      color:#fff;
      background:linear-gradient(135deg,var(--primary-2),var(--maroon));
      box-shadow:0 6px 16px rgba(13,71,161,0.7);
    }
    button:hover{
      filter:brightness(1.04);
      box-shadow:0 0 14px rgba(66,165,245,0.85);
    }
    .btn-secondary{
      background:rgba(255,255,255,0.06);
      border:1px solid rgba(255,255,255,0.2);
      box-shadow:none;
    }
    .btn-danger{
      background:#c62828;
      box-shadow:0 6px 16px rgba(198,40,40,0.7);
    }

    .status{
      display:inline-block;
      padding:4px 8px;
      border-radius:999px;
      font-size:11px;
      font-weight:700;
    }
    .status-ACTIVE{
      background:rgba(129,199,132,0.12); color:#69f0ae;
      border:1px solid rgba(129,199,132,0.6);
    }
    .status-SUSPENDED{
      background:rgba(255,213,79,0.1); color:#ffca28;
      border:1px solid rgba(255,213,79,0.55);
    }
    .status-REVOKED{
      background:rgba(239,83,80,0.12); color:#ff8a80;
      border:1px solid rgba(239,83,80,0.6);
    }

    table{
      width:100%; border-collapse:collapse; font-size:12px; margin-top:6px;
    }
    th, td{
      border:1px solid rgba(255,255,255,0.1);
      padding:6px 8px;
      text-align:left;
      vertical-align:middle;
    }
    th{
      background:linear-gradient(90deg,rgba(13,71,161,0.85),rgba(123,30,60,0.75));
      color:#fff;
      font-weight:600;
    }
    .actions{display:flex; flex-wrap:wrap; gap:4px;}

    .tag-role{
      padding:3px 6px;
      border-radius:999px;
      font-size:11px;
      border:1px solid rgba(255,255,255,0.25);
    }

    /* Layout: ‡πÉ‡∏´‡πâ‡πÄ‡∏´‡πá‡∏ô‡∏ó‡∏∏‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‡πÉ‡∏ô‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß (‡∏ö‡∏ô‡∏à‡∏≠‡πÉ‡∏´‡∏ç‡πà) */
    #loginSection{
      margin:32px auto;
      max-width:1120px;
    }
    .login-grid{
      display:grid;
      grid-template-columns:repeat(3,minmax(260px,1fr));
      gap:16px;
      align-items:flex-start;
    }

    #consoleSection{
      margin-top:24px;
    }
    .console-grid{
      display:grid;
      grid-template-columns:repeat(3,minmax(260px,1fr));
      gap:16px;
      align-items:flex-start;
    }

    @media(max-width:1024px){
      .login-grid,
      .console-grid{
        grid-template-columns:repeat(2,minmax(260px,1fr));
      }
    }
    @media(max-width:720px){
      .login-grid,
      .console-grid{
        grid-template-columns:1fr;
      }
    }

    /* Toast / Notification */
    .toast-container{
      position:fixed;
      bottom:20px;
      right:20px;
      z-index:200;
      display:flex;
      flex-direction:column;
      gap:8px;
    }
    .toast{
      min-width:220px;
      max-width:320px;
      padding:10px 14px;
      border-radius:10px;
      font-size:12px;
      box-shadow:0 8px 20px rgba(0,0,0,0.7);
      display:flex;
      align-items:flex-start;
      gap:8px;
      border:1px solid rgba(255,255,255,0.18);
      backdrop-filter:blur(10px);
    }
    .toast-success{
      background:rgba(102,187,106,0.12);
      color:#c8e6c9;
    }
    .toast-warning{
      background:rgba(255,202,40,0.16);
      color:#ffecb3;
    }
    .toast-error{
      background:rgba(239,83,80,0.16);
      color:#ffcdd2;
    }
    .toast-neutral{
      background:rgba(66,165,245,0.16);
      color:#bbdefb;
    }
    .toast-dot{
      width:10px; height:10px; border-radius:50%;
      margin-top:3px;
      flex-shrink:0;
    }
    .toast-success .toast-dot{background:var(--success);}
    .toast-warning .toast-dot{background:var(--warning);}
    .toast-error .toast-dot{background:var(--danger);}
    .toast-neutral .toast-dot{background:var(--primary-2);}

    @media(max-width:600px){
      .header-inner{flex-direction:column; align-items:flex-start;}
      main{padding-top:22px;}
      .toast-container{right:10px; left:10px;}
    }

    /* ‡πÅ‡∏ñ‡∏ö‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô */
    .password-expiry-banner{
      margin-top:10px;
      padding:8px 10px;
      border-radius:10px;
      font-size:11px;
      background:rgba(255,202,40,0.12);
      border:1px solid rgba(255,202,40,0.5);
      color:#ffecb3;
    }
    .password-expiry-danger{
      background:rgba(239,83,80,0.18);
      border-color:rgba(239,83,80,0.7);
      color:#ffcdd2;
    }
  </style>
</head>
<body>
  <header>
    <div class="container header-inner">
      <div class="brand">
        <img src="images/oag-logo.png" alt="OAG Logo">
        <div>
          Admin Console
          <span class="small">Financial Audit System ‚Ä¢ Platform Owner Panel</span>
        </div>
      </div>
      <div class="header-right">
        <span class="chip">
          <span class="dot"></span>
          ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ú‡∏π‡πâ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏û‡∏•‡∏ï‡∏ü‡∏≠‡∏£‡πå‡∏° / ‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏°‡∏≠‡∏ö‡∏´‡∏°‡∏≤‡∏¢
        </span>
        <a href="index.html" class="back-link">‚¨Ö ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏´‡∏•‡∏±‡∏Å</a>
      </div>
    </div>
  </header>

  <!-- Toast notifications -->
  <div class="toast-container" id="toastContainer"></div>

  <main class="container">
    <!-- LOGIN + REQUEST + RESET ‡∏à‡∏±‡∏î‡πÄ‡∏õ‡πá‡∏ô 3 ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå -->
    <section id="loginSection">
      <div class="login-grid">
        <!-- Login -->
        <div class="card card-login">
          <h1>‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÅ‡∏û‡∏•‡∏ï‡∏ü‡∏≠‡∏£‡πå‡∏°</h1>
          <p class="muted">
            ‡∏™‡πà‡∏ß‡∏ô‡∏ô‡∏µ‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏•‡∏∞‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô
            ‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡πà‡∏ß‡∏ô‡∏ô‡∏µ‡πâ‡πÑ‡∏î‡πâ
          </p>
          <p class="muted" style="margin-top:4px;">
            ‡∏ô‡πÇ‡∏¢‡∏ö‡∏≤‡∏¢‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô: SUPER_ADMIN / ADMIN ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢‡∏ó‡∏∏‡∏Å 3 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‚Ä¢ ADMIN 1 ‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 1 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô
          </p>
          <form id="adminLoginForm" style="margin-top:10px;">
            <label for="adminUsername">‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ ‡∏´‡∏£‡∏∑‡∏≠‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô</label>
            <input type="text" id="adminUsername" required placeholder="‡πÄ‡∏ä‡πà‡∏ô root ‡∏´‡∏£‡∏∑‡∏≠ admin@example.com">

            <label for="adminPassword">‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô</label>
            <input type="password" id="adminPassword" required placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">

            <div style="margin-top:12px; display:flex; gap:8px; align-items:center; flex-wrap:wrap;">
              <button type="submit">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏£‡∏∞‡∏ö‡∏ö</button>
              <span class="muted">
                Demo: root / Admin123! ‡∏´‡∏£‡∏∑‡∏≠ apipoooo@gmail.com / Apiphu17122558
              </span>
            </div>
          </form>
          <p id="adminLoginMsg" class="muted" style="margin-top:8px;"></p>
        </div>

        <!-- Request Admin -->
        <div class="card card-request">
          <h2>‡∏Ç‡∏≠‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÄ‡∏õ‡πá‡∏ô‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö</h2>
          <p class="muted">
            ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏†‡∏≤‡∏Ñ‡∏£‡∏±‡∏ê‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏°‡∏≠‡∏ö‡∏´‡∏°‡∏≤‡∏¢‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô
            ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô ‡πÅ‡∏•‡∏∞‡∏ï‡∏±‡πâ‡∏á‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏≠‡∏á
          </p>

          <form id="adminRequestForm" style="margin-top:8px;">
            <label for="reqFirstName">‡∏ä‡∏∑‡πà‡∏≠</label>
            <input type="text" id="reqFirstName" required placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏™‡∏°‡∏ä‡∏≤‡∏¢">

            <label for="reqLastName">‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</label>
            <input type="text" id="reqLastName" required placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡πÉ‡∏à‡∏î‡∏µ">

            <label for="reqCitizenId">‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô 13 ‡∏´‡∏•‡∏±‡∏Å</label>
            <input type="text" id="reqCitizenId" required maxlength="13" placeholder="‡πÄ‡∏ä‡πà‡∏ô 1234567890123">

            <label for="reqGovId">‡∏£‡∏´‡∏±‡∏™‡∏Ç‡πâ‡∏≤‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£ / ‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£</label>
            <input type="text" id="reqGovId" required placeholder="‡πÄ‡∏ä‡πà‡∏ô 987654">

            <label for="reqPosition">‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á</label>
            <input type="text" id="reqPosition" required placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏ô‡∏±‡∏Å‡∏ß‡∏¥‡∏ä‡∏≤‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏ú‡πà‡∏ô‡∏î‡∏¥‡∏ô">

            <label for="reqEmail">‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£</label>
            <input type="email" id="reqEmail" required placeholder="‡πÄ‡∏ä‡πà‡∏ô somchai@oag.go.th">

            <label for="reqReason">‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•‡∏ó‡∏µ‡πà‡∏Ç‡∏≠‡πÄ‡∏õ‡πá‡∏ô‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö</label>
            <input type="text" id="reqReason" required placeholder="‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏™‡∏±‡πâ‡∏ô ‡πÜ">

            <label for="reqPassword">‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ (‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 8 ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£)</label>
            <input type="password" id="reqPassword" required placeholder="‡∏ï‡∏±‡πâ‡∏á‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏≠‡∏á">

            <label for="reqPasswordConfirm">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô</label>
            <input type="password" id="reqPasswordConfirm" required placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏ã‡πâ‡∏≥‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á">

            <label for="reqHumanCheck">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ß‡πà‡∏≤‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏õ‡πá‡∏ô‡∏°‡∏ô‡∏∏‡∏©‡∏¢‡πå</label>
            <div style="display:flex; gap:10px; align-items:center; flex-wrap:wrap;">
              <span id="captchaQuestion" style="font-size:14px; font-weight:600;"></span>
              <input type="number" id="reqHumanCheck" required style="width:120px;" placeholder="‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö">
            </div>

            <div style="margin-top:12px;">
              <button type="submit">‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏Ç‡∏≠‡πÄ‡∏õ‡πá‡∏ô Admin</button>
            </div>
          </form>

          <p id="adminRequestMsg" class="muted" style="margin-top:6px;"></p>
        </div>

        <!-- Reset Password -->
        <div class="card card-reset">
          <h2>‡∏•‡∏∑‡∏°‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô (‡∏Ç‡∏≠‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô)</h2>
          <p class="muted">
            ‡∏ñ‡πâ‡∏≤‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏õ‡πá‡∏ô‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡πÄ‡∏î‡∏¥‡∏°‡πÅ‡∏ï‡πà‡∏•‡∏∑‡∏°‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô
            ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏Ç‡∏≠‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà
            ‡∏Ñ‡∏≥‡∏Ç‡∏≠‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏™‡πà‡∏á‡πÉ‡∏´‡πâ SUPER_ADMIN ‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥
          </p>

          <form id="resetRequestForm" style="margin-top:8px;">
            <label for="resetFirstName">‡∏ä‡∏∑‡πà‡∏≠</label>
            <input type="text" id="resetFirstName" required placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏™‡∏°‡∏ä‡∏≤‡∏¢">

            <label for="resetLastName">‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</label>
            <input type="text" id="resetLastName" required placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡πÉ‡∏à‡∏î‡∏µ">

            <label for="resetCitizenId">‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô 13 ‡∏´‡∏•‡∏±‡∏Å</label>
            <input type="text" id="resetCitizenId" required maxlength="13" placeholder="‡πÄ‡∏ä‡πà‡∏ô 1234567890123">

            <label for="resetGovId">‡∏£‡∏´‡∏±‡∏™‡∏Ç‡πâ‡∏≤‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£ / ‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£</label>
            <input type="text" id="resetGovId" required placeholder="‡πÄ‡∏ä‡πà‡∏ô 987654">

            <label for="resetPosition">‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á</label>
            <input type="text" id="resetPosition" required placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏ô‡∏±‡∏Å‡∏ß‡∏¥‡∏ä‡∏≤‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏ú‡πà‡∏ô‡∏î‡∏¥‡∏ô">

            <label for="resetEmail">‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡πÄ‡∏õ‡πá‡∏ô‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô</label>
            <input type="email" id="resetEmail" required placeholder="‡πÄ‡∏ä‡πà‡∏ô somchai@oag.go.th">

            <label for="resetNewPassword">‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ (‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 8 ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£)</label>
            <input type="password" id="resetNewPassword" required placeholder="‡∏ï‡∏±‡πâ‡∏á‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà">

            <label for="resetNewPasswordConfirm">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà</label>
            <input type="password" id="resetNewPasswordConfirm" required placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà‡∏ã‡πâ‡∏≥‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á">

            <label for="resetHumanCheck">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ß‡πà‡∏≤‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏õ‡πá‡∏ô‡∏°‡∏ô‡∏∏‡∏©‡∏¢‡πå (‡∏ï‡∏≠‡∏ö‡πÇ‡∏à‡∏ó‡∏¢‡πå‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô)</label>
            <input type="number" id="resetHumanCheck" required style="width:120px;" placeholder="‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö">

            <div style="margin-top:12px;">
              <button type="submit">‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏Ç‡∏≠‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô</button>
            </div>
          </form>

          <p id="resetRequestMsg" class="muted" style="margin-top:6px;"></p>
        </div>
      </div>
    </section>

    <!-- ADMIN CONSOLE: ‡∏ó‡∏∏‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‡∏ß‡∏≤‡∏á‡πÄ‡∏õ‡πá‡∏ô 3 ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå -->
    <section id="consoleSection" style="display:none;">
      <div style="margin-bottom:16px;">
        <h1>‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏£‡∏∞‡∏ö‡∏ö</h1>
        <p class="muted">
          ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô ‡∏™‡∏£‡πâ‡∏≤‡∏á/‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥/‡∏£‡∏∞‡∏á‡∏±‡∏ö‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô ‡πÅ‡∏•‡∏∞‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô
          (‡∏ó‡∏∏‡∏Å‡πÇ‡∏°‡∏î‡∏π‡∏•‡∏ñ‡∏π‡∏Å‡∏à‡∏±‡∏î‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡πÉ‡∏´‡πâ‡πÄ‡∏´‡πá‡∏ô‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏±‡∏ô)
        </p>
      </div>

      <div class="console-grid">
        <!-- ‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô -->
        <div class="card card-admin-current">
          <h2>üë§ ‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô</h2>
          <p class="muted">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö Admin Console ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏Ç‡∏ì‡∏∞‡∏ô‡∏µ‡πâ</p>
          <div id="currentAdminInfo" class="muted" style="font-size:13px; margin-top:8px;">
            <!-- ‡πÄ‡∏ï‡∏¥‡∏°‡∏î‡πâ‡∏ß‡∏¢ JS -->
          </div>
          <div style="margin-top:12px; display:flex; gap:8px; flex-wrap:wrap;">
            <button id="logoutBtn" class="btn-secondary">‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏£‡∏∞‡∏ö‡∏ö</button>
          </div>
        </div>

        <!-- ‡∏™‡∏£‡∏∏‡∏õ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô -->
        <div class="card card-admin-summary">
          <h2>‡∏™‡∏£‡∏∏‡∏õ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô</h2>
          <p class="muted">‡∏î‡∏π‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î, ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ ‡πÅ‡∏•‡∏∞ Role ‡∏ï‡πà‡∏≤‡∏á ‡πÜ</p>
          <div id="adminSummary" class="muted" style="margin-top:8px; font-size:13px;">
            <!-- ‡πÄ‡∏ï‡∏¥‡∏°‡∏î‡πâ‡∏ß‡∏¢ JS -->
          </div>
        </div>

        <!-- Audit Log (‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï) -->
        <div class="card card-future">
          <h2>üìú Audit Log (‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏ô‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï)</h2>
          <p class="muted">
            ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏£‡∏∞‡∏ö‡∏ö‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô ‡πÄ‡∏ä‡πà‡∏ô ‡πÉ‡∏Ñ‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á/‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç/‡∏•‡∏ö‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏ß‡∏•‡∏≤‡πÉ‡∏î
            ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ï‡πà‡∏≠‡∏¢‡∏≠‡∏î‡∏î‡πâ‡∏ß‡∏¢ API ‡πÄ‡∏ä‡πà‡∏ô <code>/api/admin/audit-log</code>
          </p>
        </div>

        <!-- ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡πÉ‡∏´‡∏°‡πà -->
        <div class="card card-admin-create">
          <h2>‚ûï ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡πÉ‡∏´‡∏°‡πà</h2>
          <p class="muted">
            ‡πÄ‡∏â‡∏û‡∏≤‡∏∞ SUPER_ADMIN ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏Ñ‡∏ß‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡πÉ‡∏´‡∏°‡πà
            ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÉ‡∏´‡πâ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏ï‡∏≤‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô (Principle of Least Privilege)
          </p>
          <form id="createAdminForm" style="margin-top:8px;">
            <label for="newFullName">‡∏ä‡∏∑‡πà‡∏≠‚Äì‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</label>
            <input type="text" id="newFullName" required>

            <label for="newEmail">‡∏≠‡∏µ‡πÄ‡∏°‡∏•</label>
            <input type="email" id="newEmail" required placeholder="‡πÄ‡∏ä‡πà‡∏ô admin@example.com">

            <label for="newUsername">Username</label>
            <input type="text" id="newUsername" required placeholder="‡πÄ‡∏ä‡πà‡∏ô admin001">

            <label for="newPassword">‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏ï‡∏±‡πâ‡∏á‡∏ï‡πâ‡∏ô</label>
            <input type="text" id="newPassword" required placeholder="‡πÄ‡∏ä‡πà‡∏ô StrongPass!234">

            <label for="newRole">‡∏ö‡∏ó‡∏ö‡∏≤‡∏ó (Role)</label>
            <select id="newRole">
              <option value="ADMIN">ADMIN ‚Äì ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ (‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏‡πÉ‡∏ô 3 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô)</option>
              <option value="ADMIN1">ADMIN 1 ‚Äì ‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏£‡∏∞‡∏ö‡∏ö (‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏‡πÉ‡∏ô 1 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô)</option>
              <option value="VIEWER">VIEWER ‚Äì ‡∏≠‡πà‡∏≤‡∏ô‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß</option>
              <option value="SUPER_ADMIN">SUPER_ADMIN ‚Äì ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î (‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏‡πÉ‡∏ô 3 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô)</option>
            </select>

            <p class="muted" style="margin-top:8px;">
              * ‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á SUPER_ADMIN ‡πÉ‡∏´‡∏°‡πà‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Å‡∏£‡∏ì‡∏µ‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡∏à‡∏£‡∏¥‡∏á ‡πÜ
            </p>

            <div style="margin-top:10px;">
              <button type="submit">‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô</button>
            </div>
          </form>
          <p id="createAdminMsg" class="muted" style="margin-top:6px;"></p>
        </div>

        <!-- ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô -->
        <div class="card card-admin-list">
          <h2>üßë‚Äçüíº ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏£‡∏∞‡∏ö‡∏ö</h2>
          <p class="muted">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ Role / ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ / ‡∏•‡∏ö‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß</p>
          <div style="max-height:260px; overflow:auto; margin-top:6px;">
            <table>
              <thead>
                <tr>
                  <th>‡∏ä‡∏∑‡πà‡∏≠‚Äì‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</th>
                  <th>Username / Email</th>
                  <th>Role</th>
                  <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                  <th>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                </tr>
              </thead>
              <tbody id="adminsTable"></tbody>
            </table>
          </div>
        </div>

        <!-- ‡∏Ñ‡∏≥‡∏Ç‡∏≠ Admin + Reset -->
        <div class="card card-requests-main">
          <h2>‡∏Ñ‡∏≥‡∏Ç‡∏≠‡πÄ‡∏õ‡πá‡∏ô Admin / ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô</h2>
          <p class="muted">
            ‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏≥‡∏Ç‡∏≠‡∏ó‡∏µ‡πà‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏™‡πà‡∏á‡∏à‡∏≤‡∏Å‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô<br>
            - NEW_ADMIN: ‡∏Ç‡∏≠‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÄ‡∏õ‡πá‡∏ô‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡πÉ‡∏´‡∏°‡πà<br>
            - RESET_PASSWORD: ‡∏Ç‡∏≠‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô (‡πÄ‡∏â‡∏û‡∏≤‡∏∞ SUPER_ADMIN ‡∏ó‡∏µ‡πà‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÑ‡∏î‡πâ)<br><br>
            ‡∏õ‡∏∏‡πà‡∏°‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£:<br>
            ‚Ä¢ ADMIN ‚Üí ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡πÄ‡∏ï‡πá‡∏°‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå<br>
            ‚Ä¢ ADMIN 1 ‚Üí ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô<br>
            ‚Ä¢ ‡∏õ‡∏è‡∏¥‡πÄ‡∏™‡∏ò ‚Üí ‡∏•‡∏ö‡∏Ñ‡∏≥‡∏Ç‡∏≠‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö
          </p>
          <div style="max-height:260px; overflow:auto; margin-top:6px;">
            <table>
              <thead>
                <tr>
                  <th>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Ñ‡∏≥‡∏Ç‡∏≠</th>
                  <th>‡∏ä‡∏∑‡πà‡∏≠‚Äì‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</th>
                  <th>‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô</th>
                  <th>‡∏£‡∏´‡∏±‡∏™‡∏Ç‡πâ‡∏≤‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£</th>
                  <th>‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á</th>
                  <th>‡∏≠‡∏µ‡πÄ‡∏°‡∏•</th>
                  <th>‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•</th>
                  <th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏Ç‡∏≠</th>
                  <th>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                </tr>
              </thead>
              <tbody id="adminRequestsTable"></tbody>
            </table>
          </div>
        </div>
      </div>
    </section>
  </main>

  <script>
    // Toast helper
    const toastContainer = document.getElementById("toastContainer");
    function showToast(message, type = "neutral"){
      const toast = document.createElement("div");
      const cls = {
        success:"toast-success",
        warning:"toast-warning",
        error:"toast-error",
        neutral:"toast-neutral"
      }[type] || "toast-neutral";
      toast.className = "toast " + cls;
      toast.innerHTML = `
        <div class="toast-dot"></div>
        <div>${message}</div>
      `;
      toastContainer.appendChild(toast);
      setTimeout(()=>{ toast.style.opacity = "0"; }, 2600);
      setTimeout(()=>{ if(toast.parentNode) toast.parentNode.removeChild(toast); }, 3200);
    }

    // DEMO store
    const adminStore = {
      admins: [
        {
          id: 1,
          fullName: "‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡πÅ‡∏û‡∏•‡∏ï‡∏ü‡∏≠‡∏£‡πå‡∏°",
          email: "root@example.com",
          username: "root",
          password: "Admin123!",
          role: "SUPER_ADMIN",
          status: "ACTIVE",
          lastLoginAt: null,
          passwordLastChangedAt: new Date().toISOString()
        },
        {
          id: 2,
          fullName: "‡∏™‡∏∏‡∏î‡∏≤ ‡∏™‡∏≤‡∏¢‡πÉ‡∏à",
          email: "suda-admin@example.com",
          username: "suda-admin",
          password: "Admin456!",
          role: "ADMIN",
          status: "ACTIVE",
          lastLoginAt: null,
          passwordLastChangedAt: new Date().toISOString()
        },
        {
          id: 3,
          fullName: "apipoooo",
          email: "apipoooo@gmail.com",
          username: "apipoooo",
          password: "Apiphu17122558",
          role: "SUPER_ADMIN",
          status: "ACTIVE",
          lastLoginAt: null,
          passwordLastChangedAt: new Date().toISOString()
        }
      ],
      currentAdmin: null,
      adminRequests: JSON.parse(localStorage.getItem("fas-admin-requests") || "[]")
    };

    function saveAdminRequests(){
      try{
        localStorage.setItem("fas-admin-requests", JSON.stringify(adminStore.adminRequests));
      }catch(e){
        console.warn("‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å fas-admin-requests ‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à", e);
      }
    }

    const loginSection   = document.getElementById("loginSection");
    const consoleSection = document.getElementById("consoleSection");
    const loginMsg       = document.getElementById("adminLoginMsg");
    const currentAdminInfoEl = document.getElementById("currentAdminInfo");
    const adminSummaryEl = document.getElementById("adminSummary");
    const adminsTableEl  = document.getElementById("adminsTable");
    const createAdminMsg = document.getElementById("createAdminMsg");
    const adminRequestsTableEl = document.getElementById("adminRequestsTable");
    const adminRequestMsg = document.getElementById("adminRequestMsg");
    const resetRequestMsg = document.getElementById("resetRequestMsg");

    // CAPTCHA & Thai ID
    let captchaA = 0;
    let captchaB = 0;

    function generateCaptcha(){
      captchaA = Math.floor(Math.random() * 9) + 1;
      captchaB = Math.floor(Math.random() * 9) + 1;
      const el = document.getElementById("captchaQuestion");
      if(el){
        el.textContent = `‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì: ${captchaA} + ${captchaB} = ?`;
      }
    }

    function isValidThaiID(id){
      if(!/^[0-9]{13}$/.test(id)) return false;
      let sum = 0;
      for(let i=0; i<12; i++){
        sum += Number(id.charAt(i)) * (13 - i);
      }
      let checkDigit = (11 - (sum % 11)) % 10;
      return checkDigit === Number(id.charAt(12));
    }

    function isCurrentSuperAdmin(){
      return adminStore.currentAdmin && adminStore.currentAdmin.role === "SUPER_ADMIN";
    }

    // password expiry
    function getPasswordExpiryInfo(admin){
      if(!admin.passwordLastChangedAt) return {expired:false, daysLeft:null, maxDays:null};

      let maxDays = null;
      if(admin.role === "ADMIN1"){
        maxDays = 30;
      }else if(admin.role === "ADMIN" || admin.role === "SUPER_ADMIN"){
        maxDays = 90;
      }else{
        return {expired:false, daysLeft:null, maxDays:null};
      }

      const now = new Date();
      const last = new Date(admin.passwordLastChangedAt);
      const diffMs = now - last;
      const usedDays = Math.floor(diffMs / (1000 * 60 * 60 * 24));
      const daysLeft = maxDays - usedDays;
      return {
        expired: daysLeft < 0,
        daysLeft,
        maxDays
      };
    }

    function showConsole(){
      loginSection.style.display = "none";
      consoleSection.style.display = "block";
    }
    function showLogin(){
      loginSection.style.display = "block";
      consoleSection.style.display = "none";
    }

    function renderCurrentAdminInfo(){
      const a = adminStore.currentAdmin;
      if(!a){
        currentAdminInfoEl.innerHTML = "<span class='muted'>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏£‡∏∞‡∏ö‡∏ö</span>";
        return;
      }
      const expInfo = getPasswordExpiryInfo(a);
      let expHtml = "";
      if(expInfo.maxDays){
        if(expInfo.expired){
          expHtml = `
            <div class="password-expiry-banner password-expiry-danger">
              ‚õî ‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏‡πÄ‡∏Å‡∏¥‡∏ô‡∏ô‡πÇ‡∏¢‡∏ö‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÅ‡∏•‡πâ‡∏ß (${expInfo.maxDays} ‡∏ß‡∏±‡∏ô)
              ‡πÇ‡∏õ‡∏£‡∏î‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠ SUPER_ADMIN ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÇ‡∏î‡∏¢‡∏î‡πà‡∏ß‡∏ô
            </div>
          `;
        }else if(expInfo.daysLeft <= 7){
          expHtml = `
            <div class="password-expiry-banner">
              ‚ö† ‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏à‡∏∞‡∏Ñ‡∏£‡∏ö‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÉ‡∏ô‡∏≠‡∏µ‡∏Å ${expInfo.daysLeft} ‡∏ß‡∏±‡∏ô
              ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏•‡πà‡∏ß‡∏á‡∏´‡∏ô‡πâ‡∏≤
            </div>
          `;
        }else{
          expHtml = `
            <div class="password-expiry-banner">
              ‚úÖ ‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏ä‡πà‡∏ß‡∏á‡∏≠‡∏≤‡∏¢‡∏∏‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô (‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì ${expInfo.daysLeft} ‡∏ß‡∏±‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡∏Ñ‡∏£‡∏ö‡∏Å‡∏≥‡∏´‡∏ô‡∏î)
            </div>
          `;
        }
      }

      currentAdminInfoEl.innerHTML = `
        <div><strong>‡∏ä‡∏∑‡πà‡∏≠:</strong> ${a.fullName}</div>
        <div><strong>Username:</strong> ${a.username}</div>
        <div><strong>Email:</strong> ${a.email}</div>
        <div><strong>Role:</strong> <span class="tag-role">${a.role}</span></div>
        <div><strong>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞:</strong> <span class="status status-${a.status}">${a.status}</span></div>
        <div><strong>‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î:</strong> ${a.lastLoginAt ? new Date(a.lastLoginAt).toLocaleString() : "-"}</div>
        ${expHtml}
      `;
    }

    function renderAdminSummary(){
      const total = adminStore.admins.length;
      const active = adminStore.admins.filter(a => a.status === "ACTIVE").length;
      const suspended = adminStore.admins.filter(a => a.status === "SUSPENDED").length;
      const revoked = adminStore.admins.filter(a => a.status === "REVOKED").length;

      adminSummaryEl.innerHTML = `
        <div>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î: <strong>${total}</strong></div>
        <div>Active: <strong>${active}</strong> ‚Ä¢ Suspended: <strong>${suspended}</strong> ‚Ä¢ Revoked: <strong>${revoked}</strong></div>
        <div style="margin-top:4px;">
          <span class="badge-small">SUPER_ADMIN: ${adminStore.admins.filter(a => a.role === "SUPER_ADMIN").length}</span>
          <span class="badge-small">ADMIN: ${adminStore.admins.filter(a => a.role === "ADMIN").length}</span>
          <span class="badge-small">ADMIN1: ${adminStore.admins.filter(a => a.role === "ADMIN1").length}</span>
          <span class="badge-small">VIEWER: ${adminStore.admins.filter(a => a.role === "VIEWER").length}</span>
        </div>
      `;
    }

    function renderAdminsTable(){
      adminsTableEl.innerHTML = "";
      adminStore.admins.forEach(a => {
        const expInfo = getPasswordExpiryInfo(a);
        let expBadge = "";
        if(expInfo.maxDays){
          if(expInfo.expired){
            expBadge = `<div class="badge-small" style="border-color:#ef5350; color:#ffcdd2;">‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏</div>`;
          }else if(expInfo.daysLeft <= 7){
            expBadge = `<div class="badge-small" style="border-color:#ffca28; color:#ffecb3;">‡πÉ‡∏Å‡∏•‡πâ‡∏Ñ‡∏£‡∏ö‡∏Å‡∏≥‡∏´‡∏ô‡∏î (${expInfo.daysLeft} ‡∏ß‡∏±‡∏ô)</div>`;
          }else{
            expBadge = `<div class="badge-small">‡πÄ‡∏´‡∏•‡∏∑‡∏≠ ${expInfo.daysLeft} ‡∏ß‡∏±‡∏ô</div>`;
          }
        }

        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td>${a.fullName}</td>
          <td>
            <div>${a.username}</div>
            <div class="muted">${a.email}</div>
          </td>
          <td>
            <select data-admin-id="${a.id}" class="role-select">
              <option value="SUPER_ADMIN" ${a.role==="SUPER_ADMIN"?"selected":""}>SUPER_ADMIN</option>
              <option value="ADMIN" ${a.role==="ADMIN"?"selected":""}>ADMIN</option>
              <option value="ADMIN1" ${a.role==="ADMIN1"?"selected":""}>ADMIN 1 (‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏£‡∏∞‡∏ö‡∏ö)</option>
              <option value="VIEWER" ${a.role==="VIEWER"?"selected":""}>VIEWER</option>
            </select>
            ${expBadge}
          </td>
          <td><span class="status status-${a.status}">${a.status}</span></td>
          <td class="actions">
            <button class="btn-secondary" data-action="toggleStatus" data-id="${a.id}">
              ${a.status === "ACTIVE" ? "‡∏£‡∏∞‡∏á‡∏±‡∏ö" : "‡∏õ‡∏•‡∏î‡∏£‡∏∞‡∏á‡∏±‡∏ö"}
            </button>
            <button class="btn-secondary" data-action="resetPwd" data-id="${a.id}">‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô (DEMO)</button>
            <button class="btn-danger" data-action="deleteAdmin" data-id="${a.id}">‡∏•‡∏ö</button>
          </td>
        `;
        adminsTableEl.appendChild(tr);
      });

      document.querySelectorAll(".role-select").forEach(sel=>{
        sel.addEventListener("change", e=>{
          const id = Number(e.target.getAttribute("data-admin-id"));
          const admin = adminStore.admins.find(a=>a.id===id);
          if(!admin) return;
          const newRole = e.target.value;
          admin.role = newRole;
          renderAdminSummary();
          renderAdminsTable();
          if(adminStore.currentAdmin && adminStore.currentAdmin.id === id){
            renderCurrentAdminInfo();
          }
          showToast("‡∏£‡∏∞‡∏ö‡∏ö‡πÑ‡∏î‡πâ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô Role ‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡πÅ‡∏•‡πâ‡∏ß", "success");
        });
      });
    }

    function renderAdminRequestsTable(){
      adminRequestsTableEl.innerHTML = "";
      if(adminStore.adminRequests.length === 0){
        const tr = document.createElement("tr");
        tr.innerHTML = `<td colspan="9" class="muted">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡∏≥‡∏Ç‡∏≠‡πÄ‡∏õ‡πá‡∏ô‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö‡∏´‡∏£‡∏∑‡∏≠‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô</td>`;
        adminRequestsTableEl.appendChild(tr);
        return;
      }

      adminStore.adminRequests.forEach(req => {
        const type = req.requestType || "NEW_ADMIN";
        const typeLabel = type === "RESET_PASSWORD" ? "‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô" : "‡∏Ç‡∏≠‡πÄ‡∏õ‡πá‡∏ô Admin";
        const dateStr = req.createdAt ? new Date(req.createdAt).toLocaleString() : "-";

        let actionButtons = "";
        if(type === "NEW_ADMIN"){
          actionButtons = `
            <button class="btn-secondary" data-req-action="approveAdminFull" data-id="${req.id}">ADMIN</button>
            <button class="btn-secondary" data-req-action="approveAdmin1" data-id="${req.id}">ADMIN 1</button>
            <button class="btn-danger" data-req-action="reject" data-id="${req.id}">‡∏õ‡∏è‡∏¥‡πÄ‡∏™‡∏ò</button>
          `;
        }else if(type === "RESET_PASSWORD"){
          actionButtons = `
            <button class="btn-secondary" data-req-action="approveReset" data-id="${req.id}">‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô</button>
            <button class="btn-danger" data-req-action="reject" data-id="${req.id}">‡∏õ‡∏è‡∏¥‡πÄ‡∏™‡∏ò</button>
          `;
        }

        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td>${typeLabel}</td>
          <td>${req.fullName || ""}</td>
          <td>${req.citizenId || ""}</td>
          <td>${req.govId || ""}</td>
          <td>${req.position || ""}</td>
          <td>${req.email || ""}</td>
          <td class="muted">${req.reason || ""}</td>
          <td class="muted">${dateStr}</td>
          <td class="actions">
            ${actionButtons}
          </td>
        `;
        adminRequestsTableEl.appendChild(tr);
      });
    }

    // LOGIN
    document.getElementById("adminLoginForm").addEventListener("submit", function(e){
      e.preventDefault();
      const username = document.getElementById("adminUsername").value.trim();
      const password = document.getElementById("adminPassword").value;

      if(!username || !password){
        loginMsg.textContent = "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÅ‡∏•‡∏∞‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô";
        return;
      }

      const admin = adminStore.admins.find(a =>
        (a.username === username || a.email === username)
      );

      if(!admin || admin.password !== password){
        loginMsg.textContent = "‚ùå ‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏´‡∏£‡∏∑‡∏≠‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á";
        showToast("‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö: ‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏´‡∏£‡∏∑‡∏≠‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á", "error");
        return;
      }
      if(admin.status === "SUSPENDED"){
        loginMsg.textContent = "‚õî ‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏ô‡∏µ‡πâ‡∏ñ‡∏π‡∏Å‡∏£‡∏∞‡∏á‡∏±‡∏ö ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î (SUPER_ADMIN)";
        showToast("‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏ô‡∏µ‡πâ‡∏ñ‡∏π‡∏Å‡∏£‡∏∞‡∏á‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô", "error");
        return;
      }
      if(admin.status === "REVOKED"){
        loginMsg.textContent = "‚õî ‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏ô‡∏µ‡πâ‡∏ñ‡∏π‡∏Å‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß";
        showToast("‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏ô‡∏µ‡πâ‡∏ñ‡∏π‡∏Å‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô", "error");
        return;
      }

      const expInfo = getPasswordExpiryInfo(admin);
      if(expInfo.expired){
        loginMsg.textContent = "‚õî ‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏‡∏ï‡∏≤‡∏°‡∏ô‡πÇ‡∏¢‡∏ö‡∏≤‡∏¢ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏Ç‡∏≠‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡πÅ‡∏à‡πâ‡∏á SUPER_ADMIN";
        showToast("‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏ ‡πÄ‡∏Å‡∏¥‡∏ô‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î", "error");
        return;
      }

      admin.lastLoginAt = new Date().toISOString();
      adminStore.currentAdmin = admin;
      loginMsg.textContent = "";
      showConsole();
      renderCurrentAdminInfo();
      renderAdminSummary();
      renderAdminsTable();
      renderAdminRequestsTable();
      showToast("‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à", "success");
    });

    document.getElementById("logoutBtn").addEventListener("click", function(){
      adminStore.currentAdmin = null;
      showLogin();
      document.getElementById("adminPassword").value = "";
      loginMsg.textContent = "‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢";
      showToast("‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏•‡πâ‡∏ß", "neutral");
    });

    // CREATE ADMIN
    document.getElementById("createAdminForm").addEventListener("submit", function(e){
      e.preventDefault();
      const fullName = document.getElementById("newFullName").value.trim();
      const email = document.getElementById("newEmail").value.trim();
      const username = document.getElementById("newUsername").value.trim();
      const password = document.getElementById("newPassword").value;
      const role = document.getElementById("newRole").value;
      createAdminMsg.textContent = "";

      if(!fullName || !email || !username || !password){
        createAdminMsg.textContent = "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô";
        showToast("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏Å‡πà‡∏≠‡∏ô‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å", "warning");
        return;
      }
      if(adminStore.admins.some(a => a.username === username || a.email === email)){
        createAdminMsg.textContent = "‡∏°‡∏µ‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ Username ‡∏´‡∏£‡∏∑‡∏≠ Email ‡∏ô‡∏µ‡πâ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß";
        showToast("‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ã‡πâ‡∏≥: Username ‡∏´‡∏£‡∏∑‡∏≠ Email ‡∏ñ‡∏π‡∏Å‡πÉ‡∏ä‡πâ‡πÅ‡∏•‡πâ‡∏ß", "error");
        return;
      }

      const newAdmin = {
        id: adminStore.admins.length ? Math.max(...adminStore.admins.map(a=>a.id))+1 : 1,
        fullName, email, username, password,
        role,
        status: "ACTIVE",
        lastLoginAt: null,
        passwordLastChangedAt: new Date().toISOString()
      };
      adminStore.admins.push(newAdmin);
      createAdminMsg.textContent = "‚úÖ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡πÉ‡∏´‡∏°‡πà‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢";
      renderAdminSummary();
      renderAdminsTable();
      e.target.reset();
      showToast("‡∏£‡∏∞‡∏ö‡∏ö‡πÑ‡∏î‡πâ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡πÉ‡∏´‡∏°‡πà‡πÅ‡∏•‡πâ‡∏ß", "success");
    });

    // Request Admin
    document.getElementById("adminRequestForm").addEventListener("submit", function(e){
      e.preventDefault();

      const firstName  = document.getElementById("reqFirstName").value.trim();
      const lastName   = document.getElementById("reqLastName").value.trim();
      const citizenId  = document.getElementById("reqCitizenId").value.trim();
      const govId      = document.getElementById("reqGovId").value.trim();
      const position   = document.getElementById("reqPosition").value.trim();
      const email      = document.getElementById("reqEmail").value.trim();
      const reason     = document.getElementById("reqReason").value.trim();
      const pwd        = document.getElementById("reqPassword").value;
      const pwd2       = document.getElementById("reqPasswordConfirm").value;
      const humanAns   = Number(document.getElementById("reqHumanCheck").value.trim());
      adminRequestMsg.textContent = "";

      if(!firstName || !lastName || !citizenId || !govId || !position || !email || !reason || !pwd || !pwd2){
        adminRequestMsg.textContent = "‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô";
        showToast("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏≥‡∏Ç‡∏≠‡πÄ‡∏õ‡πá‡∏ô Admin ‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö", "warning");
        return;
      }

      if(!isValidThaiID(citizenId)){
        adminRequestMsg.textContent = "‚ùå ‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á";
        showToast("‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á", "error");
        return;
      }

      if(pwd.length < 8){
        adminRequestMsg.textContent = "‚ùå ‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 8 ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£";
        showToast("‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏™‡∏±‡πâ‡∏ô‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ ‡∏ï‡πâ‡∏≠‡∏á 8 ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏Ç‡∏∂‡πâ‡∏ô‡πÑ‡∏õ", "warning");
        return;
      }

      if(pwd !== pwd2){
        adminRequestMsg.textContent = "‚ùå ‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ô";
        showToast("‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ô", "error");
        return;
      }

      if(humanAns !== (captchaA + captchaB)){
        adminRequestMsg.textContent = "‚ùå ‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö CAPTCHA ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà";
        generateCaptcha();
        showToast("CAPTCHA ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà", "error");
        return;
      }

      if(adminStore.adminRequests.some(r => r.email === email && (r.requestType === "NEW_ADMIN" || !r.requestType))){
        adminRequestMsg.textContent = "‚ö†Ô∏è ‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏î‡πâ‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏Ç‡∏≠‡πÄ‡∏õ‡πá‡∏ô Admin ‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏≠‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤";
        showToast("‡∏°‡∏µ‡∏Ñ‡∏≥‡∏Ç‡∏≠‡πÄ‡∏õ‡πá‡∏ô Admin ‡∏Ç‡∏≠‡∏á‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡∏ô‡∏µ‡πâ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß", "warning");
        return;
      }

      const newReq = {
        id: adminStore.adminRequests.length ? Math.max(...adminStore.adminRequests.map(r=>r.id))+1 : 1,
        requestType: "NEW_ADMIN",
        fullName: `${firstName} ${lastName}`,
        firstName,
        lastName,
        citizenId,
        govId,
        position,
        email,
        reason,
        desiredPassword: pwd,
        createdAt: new Date().toISOString()
      };

      adminStore.adminRequests.push(newReq);
      saveAdminRequests();

      adminRequestMsg.textContent = "‚úÖ ‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏Ç‡∏≠‡πÄ‡∏õ‡πá‡∏ô Admin ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‡πÇ‡∏õ‡∏£‡∏î‡∏£‡∏≠‡∏Å‡∏≤‡∏£‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡∏à‡∏≤‡∏Å‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö";
      e.target.reset();
      generateCaptcha();
      renderAdminRequestsTable();
      showToast("‡∏£‡∏∞‡∏ö‡∏ö‡πÑ‡∏î‡πâ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ñ‡∏≥‡∏Ç‡∏≠‡πÄ‡∏õ‡πá‡∏ô Admin ‡πÅ‡∏•‡πâ‡∏ß", "success");
    });

    // Reset Password Request
    document.getElementById("resetRequestForm").addEventListener("submit", function(e){
      e.preventDefault();

      const firstName  = document.getElementById("resetFirstName").value.trim();
      const lastName   = document.getElementById("resetLastName").value.trim();
      const citizenId  = document.getElementById("resetCitizenId").value.trim();
      const govId      = document.getElementById("resetGovId").value.trim();
      const position   = document.getElementById("resetPosition").value.trim();
      const email      = document.getElementById("resetEmail").value.trim();
      const newPwd     = document.getElementById("resetNewPassword").value;
      const newPwd2    = document.getElementById("resetNewPasswordConfirm").value;
      const humanAns   = Number(document.getElementById("resetHumanCheck").value.trim());
      resetRequestMsg.textContent = "";

      if(!firstName || !lastName || !citizenId || !govId || !position || !email || !newPwd || !newPwd2){
        resetRequestMsg.textContent = "‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô";
        showToast("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏≥‡∏Ç‡∏≠‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö", "warning");
        return;
      }

      if(!isValidThaiID(citizenId)){
        resetRequestMsg.textContent = "‚ùå ‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á";
        showToast("‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á", "error");
        return;
      }

      if(newPwd.length < 8){
        resetRequestMsg.textContent = "‚ùå ‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 8 ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£";
        showToast("‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà‡∏™‡∏±‡πâ‡∏ô‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ ‡∏ï‡πâ‡∏≠‡∏á 8 ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏Ç‡∏∂‡πâ‡∏ô‡πÑ‡∏õ", "warning");
        return;
      }

      if(newPwd !== newPwd2){
        resetRequestMsg.textContent = "‚ùå ‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ô";
        showToast("‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ô", "error");
        return;
      }

      if(humanAns !== (captchaA + captchaB)){
        resetRequestMsg.textContent = "‚ùå ‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö CAPTCHA ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà";
        generateCaptcha();
        showToast("CAPTCHA ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà", "error");
        return;
      }

      const targetAdmin = adminStore.admins.find(a => a.email === email);
      if(!targetAdmin){
        resetRequestMsg.textContent = "‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡∏ô‡∏µ‡πâ‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö";
        showToast("‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡∏ô‡∏µ‡πâ", "error");
        return;
      }

      if(adminStore.adminRequests.some(r => r.email === email && r.requestType === "RESET_PASSWORD")){
        resetRequestMsg.textContent = "‚ö†Ô∏è ‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏î‡πâ‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏Ç‡∏≠‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏≠‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤";
        showToast("‡∏°‡∏µ‡∏Ñ‡∏≥‡∏Ç‡∏≠‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡∏ô‡∏µ‡πâ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß", "warning");
        return;
      }

      const newReq = {
        id: adminStore.adminRequests.length ? Math.max(...adminStore.adminRequests.map(r=>r.id))+1 : 1,
        requestType: "RESET_PASSWORD",
        fullName: `${firstName} ${lastName}`,
        firstName,
        lastName,
        citizenId,
        govId,
        position,
        email,
        reason: "‡∏Ç‡∏≠‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö",
        desiredPassword: newPwd,
        createdAt: new Date().toISOString()
      };

      adminStore.adminRequests.push(newReq);
      saveAdminRequests();

      resetRequestMsg.textContent = "‚úÖ ‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏Ç‡∏≠‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‡πÇ‡∏õ‡∏£‡∏î‡∏£‡∏≠ SUPER_ADMIN ‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤";
      e.target.reset();
      generateCaptcha();
      renderAdminRequestsTable();
      showToast("‡∏£‡∏∞‡∏ö‡∏ö‡πÑ‡∏î‡πâ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ñ‡∏≥‡∏Ç‡∏≠‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß", "success");
    });

    // ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏Ç‡∏≠ (Approve / Reject)
    adminRequestsTableEl.addEventListener("click", function(e){
      const btn = e.target.closest("button");
      if(!btn) return;
      const action = btn.getAttribute("data-req-action");
      const id = Number(btn.getAttribute("data-id"));
      const req = adminStore.adminRequests.find(r => r.id === id);
      if(!req) return;

      const type = req.requestType || "NEW_ADMIN";

      if(action === "reject"){
        if(!confirm("‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏õ‡∏è‡∏¥‡πÄ‡∏™‡∏ò‡∏Ñ‡∏≥‡∏Ç‡∏≠‡∏ô‡∏µ‡πâ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?")) return;
        adminStore.adminRequests = adminStore.adminRequests.filter(r => r.id !== id);
        saveAdminRequests();
        renderAdminRequestsTable();
        showToast("‡∏£‡∏∞‡∏ö‡∏ö‡πÑ‡∏î‡πâ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏õ‡∏è‡∏¥‡πÄ‡∏™‡∏ò‡∏Ñ‡∏≥‡∏Ç‡∏≠‡πÅ‡∏•‡πâ‡∏ß", "neutral");
        return;
      }

      if(action === "approveReset" && type === "RESET_PASSWORD"){
        if(!isCurrentSuperAdmin()){
          showToast("‡πÄ‡∏â‡∏û‡∏≤‡∏∞ SUPER_ADMIN ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏î‡πâ", "error");
          return;
        }
        const admin = adminStore.admins.find(a => a.email === req.email);
        if(!admin){
          showToast("‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô", "error");
          return;
        }
        admin.password = req.desiredPassword || admin.password;
        admin.status = "ACTIVE";
        admin.passwordLastChangedAt = new Date().toISOString();
        showToast(`‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÉ‡∏´‡πâ ${admin.fullName} ‡πÅ‡∏•‡πâ‡∏ß`, "success");
        adminStore.adminRequests = adminStore.adminRequests.filter(r => r.id !== id);
        saveAdminRequests();
        renderAdminsTable();
        renderAdminSummary();
        renderAdminRequestsTable();
        return;
      }

      if(type !== "NEW_ADMIN") return;

      let roleToAssign;
      if(action === "approveAdminFull"){
        roleToAssign = "ADMIN";
      }else if(action === "approveAdmin1"){
        roleToAssign = "ADMIN1";
      }else{
        return;
      }

      let admin = adminStore.admins.find(a => a.email === req.email);
      if(admin){
        admin.role = roleToAssign;
        admin.status = "ACTIVE";
        if(req.desiredPassword){
          admin.password = req.desiredPassword;
          admin.passwordLastChangedAt = new Date().toISOString();
        }
        showToast(`‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏ö‡∏ó‡∏ö‡∏≤‡∏ó‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡πÄ‡∏õ‡πá‡∏ô ${roleToAssign}`, "success");
      }else{
        const usernameFromEmail = req.email.split("@")[0] || ("admin" + id);
        const desiredPassword = req.desiredPassword || ("ChangeMe" + id + "!");
        admin = {
          id: adminStore.admins.length ? Math.max(...adminStore.admins.map(a=>a.id))+1 : 1,
          fullName: req.fullName,
          email: req.email,
          username: usernameFromEmail,
          password: desiredPassword,
          role: roleToAssign,
          status: "ACTIVE",
          lastLoginAt: null,
          passwordLastChangedAt: new Date().toISOString()
        };
        adminStore.admins.push(admin);
        showToast(`‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡πÉ‡∏´‡∏°‡πà Role: ${roleToAssign}`, "success");
      }

      adminStore.adminRequests = adminStore.adminRequests.filter(r => r.id !== id);
      saveAdminRequests();
      renderAdminSummary();
      renderAdminsTable();
      renderAdminRequestsTable();
    });

    // Table actions (Admins)
    adminsTableEl.addEventListener("click", function(e){
      const btn = e.target.closest("button");
      if(!btn) return;
      const action = btn.getAttribute("data-action");
      const id = Number(btn.getAttribute("data-id"));
      const admin = adminStore.admins.find(a => a.id === id);
      if(!admin) return;

      if(action === "toggleStatus"){
        admin.status = admin.status === "ACTIVE" ? "SUSPENDED" : "ACTIVE";
        renderAdminSummary();
        renderAdminsTable();
        if(adminStore.currentAdmin && adminStore.currentAdmin.id === admin.id){
          renderCurrentAdminInfo();
        }
        showToast("‡∏£‡∏∞‡∏ö‡∏ö‡πÑ‡∏î‡πâ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡πÅ‡∏•‡πâ‡∏ß", "success");
      }

      if(action === "resetPwd"){
        const newPwd = prompt("‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà (DEMO):", "");
        if(!newPwd) return;
        admin.password = newPwd;
        admin.passwordLastChangedAt = new Date().toISOString();
        showToast("‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô (DEMO) ‡πÅ‡∏•‡∏∞‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß", "success");
      }

      if(action === "deleteAdmin"){
        if(!confirm("‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡∏ô‡∏µ‡πâ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?")) return;
        if(adminStore.currentAdmin && adminStore.currentAdmin.id === admin.id){
          showToast("‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏•‡∏ö‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏≠‡∏¢‡∏π‡πà", "warning");
          return;
        }
        const idx = adminStore.admins.findIndex(a=>a.id===id);
        if(idx !== -1) adminStore.admins.splice(idx,1);
        renderAdminSummary();
        renderAdminsTable();
        showToast("‡∏•‡∏ö‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏•‡πâ‡∏ß", "neutral");
      }
    });

    // Init
    function init(){
      showLogin();
      generateCaptcha();
      renderAdminRequestsTable();
    }
    init();
  </script>
</body>
</html>
