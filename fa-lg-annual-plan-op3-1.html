<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>FA ‚Äì LG Annual | ‡∏≠‡∏õ‡∏ó.3.1 ‚Äì ‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏á‡∏≤‡∏ô‡∏ï‡πà‡∏≠‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á (Going Concern)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <style>
    :root{
      --bg:#060818;
      --card:#11152b;
      --border:#262b46;
      --accent:#42a5f5;
      --accent2:#26c6da;
      --muted:#a3acc7;
      --text:#f5f7ff;
      --pink:#f48fb1;
    }
    *{box-sizing:border-box;}

    body{
      margin:0;
      font-family:"Segoe UI", Tahoma, sans-serif;
      background:
        radial-gradient(circle at 10% 0%, rgba(123,30,60,0.36) 0, transparent 55%),
        radial-gradient(circle at 90% 100%, rgba(66,165,245,0.32) 0, transparent 55%),
        radial-gradient(circle at 0% 100%, rgba(38,198,218,0.22) 0, transparent 55%),
        var(--bg);
      color:var(--text);
      min-height:100vh;
      font-size:140%;
    }

    header{
      padding:16px 10px 12px;
      text-align:center;
      background:linear-gradient(120deg,#0d47a1,#42a5f5,#26c6da);
      box-shadow:0 4px 16px rgba(0,0,0,0.7);
      position:sticky;
      top:0;
      z-index:20;
    }
    header h2{ margin:0; font-size:20px; }
    header .sub{ font-size:13px; opacity:.9; }

    main{
      max-width:1100px;
      margin:20px auto 28px;
      padding:0 16px 20px;
    }

    .nav-top{
      display:flex;
      gap:8px;
      flex-wrap:wrap;
      margin-bottom:14px;
    }
    .btn-nav{
      padding:6px 12px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,0.45);
      background:rgba(0,0,0,0.35);
      color:#fff;
      font-size:12px;
      text-decoration:none;
      display:inline-flex;
      align-items:center;
      gap:6px;
    }
    .btn-nav:hover{ background:rgba(0,0,0,0.6); }

    .card{
      background:var(--card);
      border-radius:18px;
      border:1px solid rgba(255,255,255,0.12);
      padding:16px 14px 16px;
      box-shadow:0 10px 30px rgba(0,0,0,0.9);
      margin-bottom:16px;
    }
    .card-header{
      display:flex;
      justify-content:space-between;
      gap:10px;
      align-items:flex-start;
      margin-bottom:10px;
    }
    .card-title{
      font-size:16px;
      font-weight:600;
    }
    .card-sub{
      font-size:12px;
      color:var(--muted);
    }
    .chip{
      padding:4px 10px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,0.2);
      font-size:11px;
      background:rgba(0,0,0,0.35);
      white-space:nowrap;
    }

    .form-grid{
      display:grid;
      grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
      gap:10px 14px;
      margin-top:4px;
    }

    label{
      font-size:12px;
      display:block;
      margin-bottom:2px;
      color:#e3f2fd;
    }
    .input, select, textarea{
      width:100%;
      padding:6px 8px;
      border-radius:10px;
      border:1px solid var(--border);
      background:#080c1b;
      color:var(--text);
      font-size:12px;
    }
    textarea{
      min-height:70px;
      resize:vertical;
    }
    .input:focus, select:focus, textarea:focus{
      outline:none;
      border-color:var(--accent2);
      box-shadow:0 0 0 1px rgba(38,198,218,0.5);
    }

    .section-title{
      font-size:14px;
      font-weight:600;
      margin:10px 0 6px;
    }
    .hint{
      font-size:11px;
      color:var(--muted);
      margin-bottom:6px;
    }

    .btn-row{
      display:flex;
      flex-wrap:wrap;
      gap:8px;
      margin-top:10px;
    }
    .btn{
      padding:6px 12px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,0.4);
      background:rgba(0,0,0,0.4);
      color:#fff;
      font-size:12px;
      cursor:pointer;
    }
    .btn-primary{
      border-color:var(--accent);
      background:linear-gradient(120deg,#0d47a1,#42a5f5);
    }
    .btn-danger{
      border-color:#f44336;
      background:linear-gradient(120deg,#b71c1c,#f44336);
    }
    .btn-success{
      border-color:#4caf50;
      background:linear-gradient(120deg,#1b5e20,#4caf50);
    }
    .btn-info{
      border-color:#26c6da;
      background:linear-gradient(120deg,#006064,#26c6da);
    }
    .btn-ai{
      border-color:#f48fb1;
      background:linear-gradient(120deg,#7b1e3c,#f48fb1);
    }
    .btn-sm{
      font-size:11px;
      padding:3px 8px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,0.4);
      background:rgba(0,0,0,0.45);
      color:#fff;
      cursor:pointer;
    }
    .btn:hover,
    .btn-sm:hover{
      background:rgba(0,0,0,0.7);
    }
    .btn-primary:hover,
    .btn-danger:hover,
    .btn-success:hover,
    .btn-info:hover,
    .btn-ai:hover{
      filter:brightness(1.1);
    }

    .ai-btn-inline{
      margin-top:4px;
      display:inline-flex;
      gap:6px;
      flex-wrap:wrap;
    }

    .footer-note{
      font-size:10px;
      color:var(--muted);
      margin-top:6px;
    }

    .file-list{
      font-size:11px;
      color:var(--muted);
      margin-top:4px;
      max-height:80px;
      overflow:auto;
    }

    /* ---------- A4 PREVIEW ---------- */
    .a4-wrapper{
      margin-top:18px;
    }

    .a4-title{
      font-size:14px;
      font-weight:600;
      margin-bottom:6px;
    }

    .a4-page{
      width:210mm;
      min-height:297mm;
      margin:0 auto 16px;
      background:#ffffff;
      color:#000000;
      box-shadow:0 0 8px rgba(0,0,0,0.5);
      padding:12mm;
      font-size:11pt;
      position:relative;
    }

    .a4-header-center{
      text-align:center;
      margin-bottom:6px;
      font-size:12pt;
      font-weight:600;
    }
    .a4-subheader{
      text-align:center;
      font-size:10pt;
      margin-bottom:8px;
    }
    .a4-row{
      display:flex;
      justify-content:space-between;
      font-size:10pt;
      margin-bottom:4px;
    }
    .a4-row span{
      display:inline-block;
      min-width:80px;
    }
    .a4-row .value{
      border-bottom:1px solid #000;
      min-width:160px;
      display:inline-block;
      padding:0 2px;
    }

    .a4-block-title{
      font-size:10pt;
      font-weight:600;
      margin-top:8px;
    }
    .a4-block-content{
      font-size:10pt;
      margin-top:3px;
    }

    .a4-footer{
      position:absolute;
      bottom:8mm;
      left:12mm;
      right:12mm;
      font-size:8pt;
      display:flex;
      justify-content:space-between;
    }

    /* PRINT */
    @page{
      size:A4;
      margin:12mm;
    }
    @media print{
      body{
        background:#ffffff;
        color:#000000;
        font-size:11pt;
      }
      header,
      .nav-top,
      .card:not(.card-a4),
      .no-print{
        display:none !important;
      }
      .a4-page{
        box-shadow:none;
        margin:0;
        width:auto;
        min-height:auto;
        padding:0;
      }
      main{
        max-width:100%;
        margin:0;
        padding:0;
      }
    }

    @media (max-width:900px){
      .a4-page{
        width:100%;
        min-height:auto;
      }
    }

    @media (max-width:600px){
      .card-header{
        flex-direction:column;
        align-items:flex-start;
      }
    }
  </style>
</head>
<body>

<header>
  <h2>üèõÔ∏è ‡∏≠‡∏õ‡∏ó.3.1 ‚Äì ‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏á‡∏≤‡∏ô‡∏ï‡πà‡∏≠‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á (Going Concern)</h2>
  <div class="sub">
    Going Concern Assessment ‚Äì ‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô‡∏Ç‡∏≠‡∏á‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£‡∏õ‡∏Å‡∏Ñ‡∏£‡∏≠‡∏á‡∏™‡πà‡∏ß‡∏ô‡∏ó‡πâ‡∏≠‡∏á‡∏ñ‡∏¥‡πà‡∏ô
  </div>
</header>

<main>

  <div class="nav-top">
    <a href="fa-lg-annual-plan.html" class="btn-nav">
      <span>üß≠</span> ‡πÄ‡∏°‡∏ô‡∏π‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏Å‡∏≤‡∏£‡∏ß‡∏≤‡∏á‡πÅ‡∏ú‡∏ô
    </a>
    <a href="fa-lg-annual.html" class="btn-nav">
      <span>üìÖ</span> ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏µ / ‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏£‡∏±‡∏ö‡∏ï‡∏£‡∏ß‡∏à
    </a>
    <a href="fa-menu.html" class="btn-nav">
      <span>üìÇ</span> FA Main Menu
    </a>
    <a href="index.html" class="btn-nav">
      <span>üè†</span> ‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å‡∏£‡∏∞‡∏ö‡∏ö
    </a>
  </div>

  <!-- CARD 1: Basic info -->
  <section class="card">
    <div class="card-header">
      <div>
        <div class="card-title">‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 1 ‚Äì ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô ‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡πÇ‡∏¢‡∏á‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°</div>
        <div class="card-sub">
          ‡∏ú‡∏π‡∏Å‡∏õ‡∏µ‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‚Äì‡∏á‡∏ß‡∏î‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‚Äì‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏£‡∏±‡∏ö‡∏ï‡∏£‡∏ß‡∏à‡∏Å‡∏±‡∏ö‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á (‡∏≠‡∏õ‡∏ó.3 ‚Äì ‡∏≠‡∏õ‡∏ó.8.31)
          ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏ä‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏ö‡∏£‡∏¥‡∏ö‡∏ó‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤ Going Concern
        </div>
      </div>
      <div class="chip">‡∏≠‡∏õ‡∏ó.3.1 ‚Ä¢ Going Concern</div>
    </div>

    <div class="hint">
      ‚öôÔ∏è ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏£‡∏±‡∏ö‡∏ï‡∏£‡∏ß‡∏à‡∏à‡∏∞‡∏î‡∏∂‡∏á‡∏à‡∏≤‡∏Å <code>localStorage["fa-db-data-gov"]</code>  
      ‡∏´‡∏≤‡∏Å‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤ <code>fa-db-data-gov.html</code> ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 1 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÇ‡∏´‡∏•‡∏î‡∏ê‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á
    </div>
    <div id="govDbStatus" class="hint"></div>

    <div class="form-grid">
      <div>
        <label for="fy">‡∏õ‡∏µ‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì (2565 ‚Äì 2582)</label>
        <select id="fy" class="input">
          <option value="">‚Äî ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏µ‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì ‚Äî</option>
          <option>2565</option><option>2566</option><option>2567</option>
          <option>2568</option><option>2569</option><option>2570</option>
          <option>2571</option><option>2572</option><option>2573</option>
          <option>2574</option><option>2575</option><option>2576</option>
          <option>2577</option><option>2578</option><option>2579</option>
          <option>2580</option><option>2581</option><option>2582</option>
        </select>
      </div>

      <div>
        <label for="period">‡∏á‡∏ß‡∏î‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà (30 ‡∏Å‡∏±‡∏ô‡∏¢‡∏≤‡∏¢‡∏ô 2566 ‚Äì 2582)</label>
        <select id="period" class="input">
          <option value="">‚Äî ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏á‡∏ß‡∏î‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà ‚Äî</option>
          <!-- ‡πÄ‡∏ï‡∏¥‡∏°‡∏î‡πâ‡∏ß‡∏¢ JS -->
        </select>
      </div>

      <div>
        <label for="province">‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î (‡∏à‡∏≤‡∏Å‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏•‡∏≤‡∏á)</label>
        <select id="province" class="input">
          <option value="">‚Äî ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î ‚Äî</option>
        </select>
      </div>

      <div>
        <label for="amphoe">‡∏≠‡∏≥‡πÄ‡∏†‡∏≠ / ‡πÄ‡∏Ç‡∏ï (‡∏à‡∏≤‡∏Å‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏•‡∏≤‡∏á)</label>
        <select id="amphoe" class="input">
          <option value="">‚Äî ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏≠‡∏≥‡πÄ‡∏†‡∏≠ / ‡πÄ‡∏Ç‡∏ï ‚Äî</option>
        </select>
      </div>

      <div>
        <label for="auditee">‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏£‡∏±‡∏ö‡∏ï‡∏£‡∏ß‡∏à / ‡∏≠‡∏õ‡∏ó. (‡∏à‡∏≤‡∏Å‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏•‡∏≤‡∏á)</label>
        <select id="auditee" class="input">
          <option value="">‚Äî ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏£‡∏±‡∏ö‡∏ï‡∏£‡∏ß‡∏à ‚Äî</option>
        </select>
      </div>

      <div>
        <label for="formRef">‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏° (‡∏≠‡∏õ‡∏ó.3 ‚Äì ‡∏≠‡∏õ‡∏ó.8.31)</label>
        <select id="formRef" class="input">
          <option value="">‚Äî ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏° ‚Äî</option>
          <!-- ‡πÄ‡∏ï‡∏¥‡∏°‡∏î‡πâ‡∏ß‡∏¢ JS -->
        </select>
      </div>
    </div>

    <div class="section-title">1.2 ‡∏™‡∏£‡∏∏‡∏õ‡∏™‡∏≤‡∏£‡∏∞‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏à‡∏≤‡∏Å‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ö Going Concern</div>
    <textarea id="gcContext" class="input" placeholder="‡∏™‡∏£‡∏∏‡∏õ‡∏õ‡∏£‡∏∞‡πÄ‡∏î‡πá‡∏ô‡∏à‡∏≤‡∏Å‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°/‡∏á‡∏ö‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ö Going Concern ‡πÄ‡∏ä‡πà‡∏ô ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á RMM (‡∏≠‡∏õ‡∏ó.4), Materiality (3.5‚Äì3.6), ‡∏õ‡∏£‡∏∞‡πÄ‡∏î‡πá‡∏ô‡∏à‡∏≤‡∏Å 8.x ‡∏Ø‡∏•‡∏Ø"></textarea>
    <div class="ai-btn-inline no-print">
      <button type="button" class="btn-sm btn-ai" onclick="aiSuggestForField('gcContext','‡∏ö‡∏£‡∏¥‡∏ö‡∏ó‡πÅ‡∏•‡∏∞‡∏™‡∏≤‡∏£‡∏∞‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏à‡∏≤‡∏Å‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ö Going Concern')">ü§ñ AI ‡∏ä‡πà‡∏ß‡∏¢‡∏£‡πà‡∏≤‡∏á/‡∏™‡∏£‡∏∏‡∏õ</button>
      <button type="button" class="btn-sm" onclick="appendRawDataTo('gcContext')">üìé ‡πÅ‡∏ô‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏î‡∏¥‡∏ö‡∏à‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå/‡πÄ‡∏ß‡πá‡∏ö</button>
    </div>
  </section>

  <!-- CARD 2: Data source (file / web) -->
  <section class="card">
    <div class="card-header">
      <div>
        <div class="card-title">‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 2 ‚Äì ‡πÅ‡∏´‡∏•‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô Going Concern</div>
        <div class="card-sub">
          ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå (CSV/Excel/Text) ‡∏´‡∏£‡∏∑‡∏≠‡∏à‡∏≤‡∏Å‡πÄ‡∏ß‡πá‡∏ö (‡πÄ‡∏ä‡πà‡∏ô e-LAAS, ‡πÄ‡∏ß‡πá‡∏ö‡πÑ‡∏ã‡∏ï‡πå ‡∏≠‡∏õ‡∏ó., BI) ‡∏°‡∏≤‡πÉ‡∏ä‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏ê‡∏≤‡∏ô‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå
        </div>
      </div>
      <div class="chip">Data Source ‚Ä¢ File / Web</div>
    </div>

    <div class="section-title">2.1 ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå</div>
    <div class="form-grid">
      <div>
        <label for="dataFiles">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (‡πÄ‡∏ä‡πà‡∏ô CSV, TXT, JSON ‡∏Ø‡∏•‡∏Ø)</label>
        <input id="dataFiles" class="input" type="file" multiple onchange="handleFiles(this.files)">
      </div>
      <div>
        <label>‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å</label>
        <div id="fileList" class="file-list">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå</div>
      </div>
    </div>

    <div class="section-title">2.2 ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Web / API</div>
    <div class="form-grid">
      <div>
        <label for="dataUrl">URL (‡πÄ‡∏ä‡πà‡∏ô ‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô, API ‡∏†‡∏≤‡∏¢‡πÉ‡∏ô)</label>
        <input id="dataUrl" class="input" type="url" placeholder="‡πÄ‡∏ä‡πà‡∏ô https://example.go.th/report/2567">
      </div>
      <div>
        <label>&nbsp;</label>
        <button type="button" class="btn" onclick="fetchFromWeb()">üåê ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Web (‡∏ó‡∏î‡∏•‡∏≠‡∏á)</button>
      </div>
    </div>

    <div class="section-title">2.3 ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏î‡∏¥‡∏ö‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô Going Concern</div>
    <textarea id="rawData" class="input" placeholder="‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏£‡∏ß‡∏ö‡∏£‡∏ß‡∏°‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°/‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏≠‡πà‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏•‡∏∞‡∏à‡∏≤‡∏Å URL ‡∏°‡∏≤‡πÑ‡∏ß‡πâ‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ AI/‡∏ú‡∏π‡πâ‡∏ï‡∏£‡∏ß‡∏à‡πÉ‡∏ä‡πâ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏ï‡πà‡∏≠"></textarea>
    <div class="ai-btn-inline no-print">
      <button type="button" class="btn-sm btn-ai" onclick="aiSuggestForField('rawData','‡∏™‡∏£‡∏∏‡∏õ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏î‡∏¥‡∏ö‡∏ó‡∏µ‡πà‡∏£‡∏ß‡∏ö‡∏£‡∏ß‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Going Concern')">ü§ñ AI ‡∏ä‡πà‡∏ß‡∏¢‡∏à‡∏±‡∏î‡πÇ‡∏Ñ‡∏£‡∏á/‡∏™‡∏£‡∏∏‡∏õ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏î‡∏¥‡∏ö</button>
    </div>

    <div class="footer-note">
      * ‡∏Å‡∏≤‡∏£‡∏≠‡πà‡∏≤‡∏ô‡πÑ‡∏ü‡∏•‡πå Excel/‡πÑ‡∏ü‡∏•‡πå‡πÑ‡∏ö‡∏ô‡∏≤‡∏£‡∏µ ‡∏ã‡∏±‡∏ö‡∏ã‡πâ‡∏≠‡∏ô ‡∏≠‡∏≤‡∏à‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏õ‡πá‡∏ô CSV/TXT ‡∏Å‡πà‡∏≠‡∏ô  
      * ‡∏Å‡∏≤‡∏£‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Web ‡∏≠‡∏≤‡∏à‡∏ñ‡∏π‡∏Å‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏î‡πâ‡∏ß‡∏¢ CORS ‡∏Ç‡∏≠‡∏á‡πÄ‡∏ß‡πá‡∏ö‡πÑ‡∏ã‡∏ï‡πå‡∏õ‡∏•‡∏≤‡∏¢‡∏ó‡∏≤‡∏á
    </div>
  </section>

  <!-- CARD 3: Going Concern assessment fields -->
  <section class="card">
    <div class="card-header">
      <div>
        <div class="card-title">‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 3 ‚Äì ‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏±‡∏¢‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ö Going Concern</div>
        <div class="card-sub">
          ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡πÄ‡∏ó‡πá‡∏à‡∏à‡∏£‡∏¥‡∏á ‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏ì‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á ‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏ï‡∏≤‡∏°‡∏°‡∏∏‡∏°‡∏°‡∏≠‡∏á‡∏î‡πâ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô ‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏á‡∏≤‡∏ô ‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢/‡∏Ç‡πâ‡∏≠‡∏ú‡∏π‡∏Å‡∏û‡∏±‡∏ô
          ‡πÅ‡∏•‡∏∞‡πÅ‡∏ú‡∏ô‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£
        </div>
      </div>
      <div class="chip">Risk Indicators ‚Ä¢ Management Plans</div>
    </div>

    <div class="section-title">3.1 ‡∏î‡πâ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏•‡∏∞‡∏™‡∏†‡∏≤‡∏û‡∏Ñ‡∏•‡πà‡∏≠‡∏á</div>
    <div class="hint">
      ‡πÄ‡∏ä‡πà‡∏ô ‡∏ê‡∏≤‡∏ô‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏´‡∏•‡∏±‡∏Å, ‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏î‡∏î‡∏∏‡∏•‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡∏ï‡πà‡∏≠‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á, ‡∏´‡∏ô‡∏µ‡πâ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏á‡∏ä‡∏≥‡∏£‡∏∞, ‡∏Ç‡πâ‡∏≠‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏î‡πâ‡∏≤‡∏ô‡∏Å‡∏£‡∏∞‡πÅ‡∏™‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î, ‡∏Ç‡πâ‡∏≠‡∏™‡∏±‡∏á‡πÄ‡∏Å‡∏ï‡∏à‡∏≤‡∏Å‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤ ‡∏Ø‡∏•‡∏Ø
    </div>
    <textarea id="gcFinancial" class="input" placeholder="‡∏ö‡∏£‡∏£‡∏¢‡∏≤‡∏¢‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô/‡∏™‡∏†‡∏≤‡∏û‡∏Ñ‡∏•‡πà‡∏≠‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏á‡∏≤‡∏ô‡∏ï‡πà‡∏≠‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á"></textarea>
    <div class="ai-btn-inline no-print">
      <button type="button" class="btn-sm btn-ai" onclick="aiSuggestForField('gcFinancial','‡∏î‡πâ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏•‡∏∞‡∏™‡∏†‡∏≤‡∏û‡∏Ñ‡∏•‡πà‡∏≠‡∏á')">ü§ñ AI ‡∏ä‡πà‡∏ß‡∏¢‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏î‡πâ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô</button>
      <button type="button" class="btn-sm" onclick="appendRawDataTo('gcFinancial')">üìé ‡∏î‡∏∂‡∏á‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏î‡∏¥‡∏ö</button>
    </div>

    <div class="section-title">3.2 ‡∏î‡πâ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏á‡∏≤‡∏ô / ‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô</div>
    <div class="hint">
      ‡πÄ‡∏ä‡πà‡∏ô ‡∏Å‡∏≤‡∏£‡∏´‡∏¢‡∏∏‡∏î‡∏ä‡∏∞‡∏á‡∏±‡∏Å‡∏Ç‡∏≠‡∏á‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏∞, ‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∏‡∏ô‡∏Ç‡∏ô‡∏≤‡∏î‡πÉ‡∏´‡∏ç‡πà, ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô, ‡∏Å‡∏≤‡∏£‡∏™‡∏π‡∏ç‡πÄ‡∏™‡∏µ‡∏¢‡∏ö‡∏∏‡∏Ñ‡∏•‡∏≤‡∏Å‡∏£‡∏´‡∏•‡∏±‡∏Å ‡∏Ø‡∏•‡∏Ø
    </div>
    <textarea id="gcOperations" class="input" placeholder="‡∏ö‡∏£‡∏£‡∏¢‡∏≤‡∏¢‡∏õ‡∏£‡∏∞‡πÄ‡∏î‡πá‡∏ô‡∏î‡πâ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏ú‡∏•‡∏ï‡πà‡∏≠ Going Concern"></textarea>
    <div class="ai-btn-inline no-print">
      <button type="button" class="btn-sm btn-ai" onclick="aiSuggestForField('gcOperations','‡∏î‡πâ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏á‡∏≤‡∏ô/‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏∞')">ü§ñ AI ‡∏ä‡πà‡∏ß‡∏¢‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏î‡πâ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏á‡∏≤‡∏ô</button>
      <button type="button" class="btn-sm" onclick="appendRawDataTo('gcOperations')">üìé ‡∏î‡∏∂‡∏á‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏î‡∏¥‡∏ö</button>
    </div>

    <div class="section-title">3.3 ‡∏î‡πâ‡∏≤‡∏ô‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢ ‡∏Ç‡πâ‡∏≠‡∏ú‡∏π‡∏Å‡∏û‡∏±‡∏ô ‡πÅ‡∏•‡∏∞‡∏Ñ‡∏î‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°</div>
    <div class="hint">
      ‡πÄ‡∏ä‡πà‡∏ô ‡∏Ñ‡∏î‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏°‡∏≤‡∏Å, ‡∏Ç‡πâ‡∏≠‡∏û‡∏¥‡∏û‡∏≤‡∏ó‡∏ó‡∏µ‡πà‡∏≠‡∏≤‡∏à‡∏™‡πà‡∏á‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏°‡∏µ‡∏ô‡∏±‡∏¢‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç, ‡∏Ç‡πâ‡∏≠‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏ï‡∏≤‡∏°‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢/‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏®‡∏≤‡∏• ‡∏Ø‡∏•‡∏Ø
    </div>
    <textarea id="gcLegal" class="input" placeholder="‡∏ö‡∏£‡∏£‡∏¢‡∏≤‡∏¢‡∏Ñ‡∏î‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°/‡∏Ç‡πâ‡∏≠‡∏ú‡∏π‡∏Å‡∏û‡∏±‡∏ô/‡∏õ‡∏£‡∏∞‡πÄ‡∏î‡πá‡∏ô‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏ú‡∏•‡∏ï‡πà‡∏≠ Going Concern"></textarea>
    <div class="ai-btn-inline no-print">
      <button type="button" class="btn-sm btn-ai" onclick="aiSuggestForField('gcLegal','‡∏î‡πâ‡∏≤‡∏ô‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢ ‡∏Ç‡πâ‡∏≠‡∏ú‡∏π‡∏Å‡∏û‡∏±‡∏ô ‡πÅ‡∏•‡∏∞‡∏Ñ‡∏î‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°')">ü§ñ AI ‡∏ä‡πà‡∏ß‡∏¢‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏î‡πâ‡∏≤‡∏ô‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢</button>
      <button type="button" class="btn-sm" onclick="appendRawDataTo('gcLegal')">üìé ‡∏î‡∏∂‡∏á‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏î‡∏¥‡∏ö</button>
    </div>

    <div class="section-title">3.4 ‡∏õ‡∏±‡∏à‡∏à‡∏±‡∏¢‡∏≠‡∏∑‡πà‡∏ô ‡πÜ ‡∏ó‡∏µ‡πà‡∏≠‡∏≤‡∏à‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏á‡∏≤‡∏ô‡∏ï‡πà‡∏≠‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á</div>
    <div class="hint">
      ‡πÄ‡∏ä‡πà‡∏ô ‡∏†‡∏±‡∏¢‡∏û‡∏¥‡∏ö‡∏±‡∏ï‡∏¥, ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ç‡∏±‡∏î‡πÅ‡∏¢‡πâ‡∏á‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡πÉ‡∏ô‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà, ‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏ä‡∏¥‡∏á‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÉ‡∏´‡∏ç‡πà ‡∏Ø‡∏•‡∏Ø
    </div>
    <textarea id="gcOther" class="input" placeholder="‡∏õ‡∏±‡∏à‡∏à‡∏±‡∏¢‡∏≠‡∏∑‡πà‡∏ô ‡πÜ ‡∏ô‡∏≠‡∏Å‡πÄ‡∏´‡∏ô‡∏∑‡∏≠‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠ 3.1‚Äì3.3"></textarea>
    <div class="ai-btn-inline no-print">
      <button type="button" class="btn-sm btn-ai" onclick="aiSuggestForField('gcOther','‡∏õ‡∏±‡∏à‡∏à‡∏±‡∏¢‡∏≠‡∏∑‡πà‡∏ô ‡πÜ ‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ö Going Concern')">ü§ñ AI ‡∏ä‡πà‡∏ß‡∏¢‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏õ‡∏±‡∏à‡∏à‡∏±‡∏¢‡∏≠‡∏∑‡πà‡∏ô ‡πÜ</button>
      <button type="button" class="btn-sm" onclick="appendRawDataTo('gcOther')">üìé ‡∏î‡∏∂‡∏á‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏î‡∏¥‡∏ö</button>
    </div>

    <div class="section-title">3.5 ‡πÅ‡∏ú‡∏ô‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏ï‡∏≠‡∏ö‡∏™‡∏ô‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡∏ù‡πà‡∏≤‡∏¢‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£</div>
    <div class="hint">
      ‡πÄ‡∏ä‡πà‡∏ô ‡πÅ‡∏ú‡∏ô‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ, ‡∏õ‡∏£‡∏±‡∏ö‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏´‡∏ô‡∏µ‡πâ, ‡∏•‡∏î‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢, ‡∏õ‡∏£‡∏±‡∏ö‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£, ‡πÅ‡∏ú‡∏ô‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£ ‡∏Ø‡∏•‡∏Ø
    </div>
    <textarea id="gcMgmtPlan" class="input" placeholder="‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏ú‡∏ô/‡∏°‡∏≤‡∏ï‡∏£‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏ù‡πà‡∏≤‡∏¢‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏à‡∏∞‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏•‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á Going Concern"></textarea>
    <div class="ai-btn-inline no-print">
      <button type="button" class="btn-sm btn-ai" onclick="aiSuggestForField('gcMgmtPlan','‡πÅ‡∏ú‡∏ô‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏ï‡∏≠‡∏ö‡∏™‡∏ô‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡∏ù‡πà‡∏≤‡∏¢‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£')">ü§ñ AI ‡∏ä‡πà‡∏ß‡∏¢‡∏à‡∏±‡∏î‡πÇ‡∏Ñ‡∏£‡∏á‡πÅ‡∏ú‡∏ô</button>
      <button type="button" class="btn-sm" onclick="appendRawDataTo('gcMgmtPlan')">üìé ‡∏î‡∏∂‡∏á‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏î‡∏¥‡∏ö</button>
    </div>

    <div class="section-title">3.6 ‡∏Ç‡πâ‡∏≠‡∏™‡∏£‡∏∏‡∏õ‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö Going Concern</div>
    <div class="hint">
      ‡πÉ‡∏´‡πâ‡∏™‡∏£‡∏∏‡∏õ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡πÑ‡∏°‡πà‡πÅ‡∏ô‡πà‡∏ô‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏ô‡∏±‡∏¢‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà ‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡∏ï‡∏≠‡∏ö‡∏™‡∏ô‡∏≠‡∏á‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö ‡πÅ‡∏•‡∏∞‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏ï‡πà‡∏≠‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ú‡∏π‡πâ‡∏™‡∏≠‡∏ö‡∏ö‡∏±‡∏ç‡∏ä‡∏µ
    </div>
    <textarea id="gcConclusion" class="input" placeholder="‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô Going Concern (‡∏°‡∏µ/‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÄ‡∏´‡∏ï‡∏∏‡∏™‡∏á‡∏™‡∏±‡∏¢‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏°‡∏µ‡∏ô‡∏±‡∏¢‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç + ‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏• + ‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡∏™‡∏∞‡∏ó‡πâ‡∏≠‡∏ô‡πÉ‡∏ô‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô)"></textarea>
    <div class="ai-btn-inline no-print">
      <button type="button" class="btn-sm btn-ai" onclick="aiSuggestConclusion()">ü§ñ AI ‡∏ä‡πà‡∏ß‡∏¢‡∏£‡πà‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏™‡∏£‡∏∏‡∏õ Going Concern</button>
      <button type="button" class="btn-sm" onclick="appendRawDataTo('gcConclusion')">üìé ‡∏î‡∏∂‡∏á‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏î‡∏¥‡∏ö</button>
    </div>
  </section>

  <!-- CARD 4: AI Overall + integration -->
  <section class="card">
    <div class="card-header">
      <div>
        <div class="card-title">‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 4 ‚Äì ‡πÉ‡∏´‡πâ AI ‡∏ä‡πà‡∏ß‡∏¢‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏° ‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏ï‡πà‡∏≠‡∏£‡∏∞‡∏ö‡∏ö</div>
        <div class="card-sub">
          ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏£‡∏∏‡∏õ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡∏≥‡πÑ‡∏õ‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏≠‡∏ö‡∏ó‡∏≤‡∏ô ‡πÅ‡∏•‡∏∞‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏©‡∏ó‡∏≥‡∏Å‡∏≤‡∏£
        </div>
      </div>
      <div class="chip">AI Summary ‚Ä¢ Review / Working Paper</div>
    </div>

    <div class="section-title">4.1 ‡πÇ‡∏à‡∏ó‡∏¢‡πå‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ AI/‡∏ú‡∏π‡πâ‡∏ï‡∏£‡∏ß‡∏à‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå</div>
    <textarea id="aiQuestion" class="input" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏ß‡πà‡∏≤‡∏°‡∏µ‡πÄ‡∏´‡∏ï‡∏∏‡∏™‡∏á‡∏™‡∏±‡∏¢‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏°‡∏µ‡∏ô‡∏±‡∏¢‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏ï‡πà‡∏≠ Going Concern ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà ‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏£‡πÄ‡∏™‡∏ô‡∏≠‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏´‡πá‡∏ô‡∏ú‡∏π‡πâ‡∏™‡∏≠‡∏ö‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£"></textarea>

    <div class="section-title">4.2 ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡πÇ‡∏î‡∏¢ AI / ‡∏ú‡∏π‡πâ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö</div>
    <textarea id="aiOverall" class="input" placeholder="‡∏™‡∏£‡∏∏‡∏õ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏° (‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏™‡πà‡∏á‡πÑ‡∏õ‡πÅ‡∏™‡∏î‡∏á‡πÉ‡∏ô‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏° A4 ‡∏î‡πâ‡∏ß‡∏¢)"></textarea>

    <div class="btn-row no-print">
      <button type="button" class="btn-ai" onclick="fakeAiAnalyzeAll()">ü§ñ ‡πÉ‡∏´‡πâ AI ‡∏ä‡πà‡∏ß‡∏¢‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏∏‡∏Å‡∏ä‡πà‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á (Prototype)</button>
      <button type="button" class="btn" onclick="pushToA4()">‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏° A4</button>
      <button type="button" class="btn-success" onclick="sendToReviewSystem()">‡∏™‡πà‡∏á‡πÑ‡∏õ‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏≠‡∏ö‡∏ó‡∏≤‡∏ô (Review)</button>
      <button type="button" class="btn-info" onclick="sendToWorkingpaperDb()">‡∏™‡πà‡∏á‡πÑ‡∏õ‡∏£‡∏∞‡∏ö‡∏ö‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏©‡∏ó‡∏≥‡∏Å‡∏≤‡∏£ (WP DB)</button>
    </div>

    <div class="footer-note">
      * ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô AI ‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô Prototype ‡πÉ‡∏ô Browser ‚Äì ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ API AI ‡∏à‡∏£‡∏¥‡∏á‡∏†‡∏≤‡∏¢‡∏´‡∏•‡∏±‡∏á‡πÑ‡∏î‡πâ  
      * ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏à‡∏±‡∏î‡πÄ‡∏Å‡πá‡∏ö‡πÉ‡∏ô‡∏£‡∏π‡∏õ JSON ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡πà‡∏á‡∏ï‡πà‡∏≠‡∏£‡∏∞‡∏ö‡∏ö‡∏≠‡∏∑‡πà‡∏ô
    </div>
  </section>

  <!-- CARD 5: A4 + Export -->
  <section class="card card-a4">
    <div class="card-header">
      <div>
        <div class="card-title">‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 5 ‚Äì ‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏° ‡∏≠‡∏õ‡∏ó.3.1 ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö A4 ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏û‡∏¥‡∏°‡∏û‡πå / ‡πÅ‡∏ô‡∏ö‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏©‡∏ó‡∏≥‡∏Å‡∏≤‡∏£</div>
        <div class="card-sub">
          ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏õ‡∏µ‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì-‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏£‡∏±‡∏ö‡∏ï‡∏£‡∏ß‡∏à ‡πÅ‡∏•‡∏∞‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô Going Concern ‡πÉ‡∏ô‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏© A4
        </div>
      </div>
      <div class="chip">A4 Layout ‚Ä¢ Export</div>
    </div>

    <div class="btn-row no-print">
      <button type="button" class="btn" onclick="pushToA4()">‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏° A4</button>
      <button type="button" class="btn btn-primary" onclick="window.print()">‡∏û‡∏¥‡∏°‡∏û‡πå / Export PDF (A4)</button>
      <button type="button" class="btn" onclick="exportA4Html()">Export ‡πÄ‡∏õ‡πá‡∏ô HTML (A4 ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏´‡∏ô‡πâ‡∏≤)</button>
      <button type="button" class="btn btn-danger" onclick="exportJson()">Export ‡πÄ‡∏õ‡πá‡∏ô JSON (‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°)</button>
      <button type="button" class="btn-success" onclick="sendToReviewSystem()">‡∏™‡πà‡∏á‡πÑ‡∏õ‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏≠‡∏ö‡∏ó‡∏≤‡∏ô (Review)</button>
      <button type="button" class="btn-info" onclick="sendToWorkingpaperDb()">‡∏™‡πà‡∏á‡πÑ‡∏õ‡∏£‡∏∞‡∏ö‡∏ö‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏©‡∏ó‡∏≥‡∏Å‡∏≤‡∏£ (WP DB)</button>
    </div>

    <div class="a4-wrapper">
      <div class="a4-title">‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏° ‡∏≠‡∏õ‡∏ó.3.1 ‚Äì Going Concern ‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏© A4</div>

      <div class="a4-page" id="a4Page">
        <div class="a4-header-center">
          ‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏° ‡∏≠‡∏õ‡∏ó.3.1 ‚Äì ‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏á‡∏≤‡∏ô‡∏ï‡πà‡∏≠‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á (Going Concern)
        </div>
        <div class="a4-subheader">
          ‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô‡∏Ç‡∏≠‡∏á‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£‡∏õ‡∏Å‡∏Ñ‡∏£‡∏≠‡∏á‡∏™‡πà‡∏ß‡∏ô‡∏ó‡πâ‡∏≠‡∏á‡∏ñ‡∏¥‡πà‡∏ô
        </div>

        <div class="a4-row">
          <div>
            <span>‡∏õ‡∏µ‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì</span>
            <span class="value" id="a4Fy">&nbsp;</span>
          </div>
          <div>
            <span>‡∏á‡∏ß‡∏î‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</span>
            <span class="value" id="a4Period">&nbsp;</span>
          </div>
        </div>
        <div class="a4-row">
          <div>
            <span>‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏£‡∏±‡∏ö‡∏ï‡∏£‡∏ß‡∏à</span>
            <span class="value" id="a4Auditee">&nbsp;</span>
          </div>
          <div>
            <span>‡∏≠‡∏≥‡πÄ‡∏†‡∏≠ / ‡πÄ‡∏Ç‡∏ï</span>
            <span class="value" id="a4Amphoe">&nbsp;</span>
          </div>
        </div>
        <div class="a4-row">
          <div>
            <span>‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î</span>
            <span class="value" id="a4Province">&nbsp;</span>
          </div>
          <div>
            <span>‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°</span>
            <span class="value" id="a4FormRef">&nbsp;</span>
          </div>
        </div>

        <div class="a4-block-title">1. ‡∏™‡∏≤‡∏£‡∏∞‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏à‡∏≤‡∏Å‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ö Going Concern</div>
        <div class="a4-block-content" id="a4GcContext"></div>

        <div class="a4-block-title">2. ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÅ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏î‡∏¥‡∏ö‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô (‡∏™‡∏£‡∏∏‡∏õ)</div>
        <div class="a4-block-content" id="a4RawData"></div>

        <div class="a4-block-title">3. ‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏±‡∏¢‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ö Going Concern</div>
        <div class="a4-block-content">
          <strong>3.1 ‡∏î‡πâ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏•‡∏∞‡∏™‡∏†‡∏≤‡∏û‡∏Ñ‡∏•‡πà‡∏≠‡∏á</strong>
          <div id="a4GcFinancial"></div>
        </div>
        <div class="a4-block-content">
          <strong>3.2 ‡∏î‡πâ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏á‡∏≤‡∏ô / ‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô</strong>
          <div id="a4GcOperations"></div>
        </div>
        <div class="a4-block-content">
          <strong>3.3 ‡∏î‡πâ‡∏≤‡∏ô‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢ ‡∏Ç‡πâ‡∏≠‡∏ú‡∏π‡∏Å‡∏û‡∏±‡∏ô ‡πÅ‡∏•‡∏∞‡∏Ñ‡∏î‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°</strong>
          <div id="a4GcLegal"></div>
        </div>
        <div class="a4-block-content">
          <strong>3.4 ‡∏õ‡∏±‡∏à‡∏à‡∏±‡∏¢‡∏≠‡∏∑‡πà‡∏ô ‡πÜ</strong>
          <div id="a4GcOther"></div>
        </div>
        <div class="a4-block-content">
          <strong>3.5 ‡πÅ‡∏ú‡∏ô‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏ï‡∏≠‡∏ö‡∏™‡∏ô‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡∏ù‡πà‡∏≤‡∏¢‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£</strong>
          <div id="a4GcMgmtPlan"></div>
        </div>

        <div class="a4-block-title">4. ‡∏Ç‡πâ‡∏≠‡∏™‡∏£‡∏∏‡∏õ‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö Going Concern</div>
        <div class="a4-block-content" id="a4GcConclusion"></div>

        <div class="a4-block-title">5. ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡πÇ‡∏î‡∏¢ AI / ‡∏ú‡∏π‡πâ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö</div>
        <div class="a4-block-content" id="a4AiOverall"></div>

        <div class="a4-footer">
          <div>‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏° ‡∏≠‡∏õ‡∏ó.3.1 ‚Äì Going Concern ‚Äì FA LG Annual</div>
          <div id="a4FooterMeta">‡∏û‡∏¥‡∏°‡∏û‡πå‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö FA ‚Äì LG</div>
        </div>
      </div>
    </div>
  </section>

</main>

<script>
  /* ---------- Helper ---------- */

  function nl2br(text){
    if(!text) return '';
    return text.replace(/\n/g,'<br>');
  }

  function setStatus(msg, isError){
    const el = document.getElementById('govDbStatus');
    if(!el) return;
    el.textContent = msg || '';
    el.style.color = isError ? '#ffab91' : '#a3acc7';
  }

  /* ---------- Gov DB (fa-db-data-gov) ---------- */

  let LG_DB = [];

  function getProvinceField(row){
    return row.province || row.Province || row.prov || row['‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î'] || '';
  }
  function getAmphoeField(row){
    return row.amphoe || row.district || row.District || row['‡∏≠‡∏≥‡πÄ‡∏†‡∏≠'] || row['‡πÄ‡∏Ç‡∏ï'] || '';
  }
  function getAuditeeNameField(row){
    return (
      row.auditee ||
      row.unitName ||
      row.unit ||
      row['‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏£‡∏±‡∏ö‡∏ï‡∏£‡∏ß‡∏à'] ||
      row['‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô'] ||
      ''
    );
  }

  function fillSelectOptions(select, items, placeholder){
    if(!select) return;
    select.innerHTML = '';
    const opt0 = document.createElement('option');
    opt0.value = '';
    opt0.textContent = placeholder;
    select.appendChild(opt0);
    items.forEach(v => {
      const o = document.createElement('option');
      o.value = v;
      o.textContent = v;
      select.appendChild(o);
    });
  }

  function initGovDbFromLocalStorage(){
    try{
      const raw = localStorage.getItem('fa-db-data-gov');
      if(!raw){
        setStatus('‚ö† ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô localStorage["fa-db-data-gov"] ‚Äì ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤ fa-db-data-gov.html ‡πÉ‡∏´‡πâ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡πà‡∏≠‡∏ô', true);
        return;
      }
      const data = JSON.parse(raw);
      if(!Array.isArray(data)){
        setStatus('‚ö† ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• fa-db-data-gov ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà Array', true);
        return;
      }
      LG_DB = data;

      const provinces = [...new Set(
        LG_DB.map(getProvinceField).filter(Boolean)
      )].sort((a,b)=>a.localeCompare(b,'th-TH'));

      const provinceSelect = document.getElementById('province');
      fillSelectOptions(provinceSelect, provinces, '‚Äî ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î ‚Äî');

      setStatus(`‚úÖ ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏£‡∏±‡∏ö‡∏ï‡∏£‡∏ß‡∏à‡∏à‡∏≤‡∏Å‡∏ê‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: ${LG_DB.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£`, false);
    }catch(e){
      console.error(e);
      setStatus('‚ö† ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡∏Ç‡∏ì‡∏∞‡∏≠‡πà‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• fa-db-data-gov ‡∏à‡∏≤‡∏Å localStorage', true);
    }
  }

  function onProvinceChange(){
    const province = document.getElementById('province').value || '';
    const amphoeSelect = document.getElementById('amphoe');
    const auditeeSelect = document.getElementById('auditee');

    if(!province){
      fillSelectOptions(amphoeSelect, [], '‚Äî ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏≠‡∏≥‡πÄ‡∏†‡∏≠ / ‡πÄ‡∏Ç‡∏ï ‚Äî');
      fillSelectOptions(auditeeSelect, [], '‚Äî ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏£‡∏±‡∏ö‡∏ï‡∏£‡∏ß‡∏à ‚Äî');
      return;
    }

    const amphoeList = [...new Set(
      LG_DB
        .filter(row => getProvinceField(row) === province)
        .map(getAmphoeField)
        .filter(Boolean)
    )].sort((a,b)=>a.localeCompare(b,'th-TH'));

    fillSelectOptions(amphoeSelect, amphoeList, '‚Äî ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏≠‡∏≥‡πÄ‡∏†‡∏≠ / ‡πÄ‡∏Ç‡∏ï ‚Äî');
    fillSelectOptions(auditeeSelect, [], '‚Äî ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏£‡∏±‡∏ö‡∏ï‡∏£‡∏ß‡∏à ‚Äî');
  }

  function onAmphoeChange(){
    const province = document.getElementById('province').value || '';
    const amphoe = document.getElementById('amphoe').value || '';
    const auditeeSelect = document.getElementById('auditee');

    if(!province || !amphoe){
      fillSelectOptions(auditeeSelect, [], '‚Äî ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏£‡∏±‡∏ö‡∏ï‡∏£‡∏ß‡∏à ‚Äî');
      return;
    }

    const units = LG_DB.filter(row =>
      getProvinceField(row) === province &&
      getAmphoeField(row) === amphoe
    );

    const names = [...new Set(
      units.map(getAuditeeNameField).filter(Boolean)
    )].sort((a,b)=>a.localeCompare(b,'th-TH'));

    fillSelectOptions(auditeeSelect, names, '‚Äî ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏£‡∏±‡∏ö‡∏ï‡∏£‡∏ß‡∏à ‚Äî');
  }

  /* ---------- ‡∏á‡∏ß‡∏î‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà + ‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á ---------- */

  function initPeriods(){
    const periodSelect = document.getElementById('period');
    if(!periodSelect) return;
    for(let y=2566; y<=2582; y++){
      const txt = '30 ‡∏Å‡∏±‡∏ô‡∏¢‡∏≤‡∏¢‡∏ô ' + y;
      const opt = document.createElement('option');
      opt.value = txt;
      opt.textContent = txt;
      periodSelect.appendChild(opt);
    }
  }

  function initFormRefs(){
    const select = document.getElementById('formRef');
    if(!select) return;

    const formsSet = new Set();

    [
      '‡∏≠‡∏õ‡∏ó.3','‡∏≠‡∏õ‡∏ó.3.1','‡∏≠‡∏õ‡∏ó.4','‡∏≠‡∏õ‡∏ó.5','‡∏≠‡∏õ‡∏ó.5.1','‡∏≠‡∏õ‡∏ó.5.2',
      '‡∏≠‡∏õ‡∏ó.3.5','‡∏≠‡∏õ‡∏ó.3.6',
      '‡∏≠‡∏õ‡∏ó.8.2','‡∏≠‡∏õ‡∏ó.8.2.1','‡∏≠‡∏õ‡∏ó.8.2.2','‡∏≠‡∏õ‡∏ó.8.2.3'
    ].forEach(f => formsSet.add(f));

    for(let i=1; i<=31; i++){
      formsSet.add('‡∏≠‡∏õ‡∏ó.8.' + i);
    }

    const forms = Array.from(formsSet).sort((a,b)=>a.localeCompare(b,'th-TH',{numeric:true}));

    forms.forEach(f => {
      const opt = document.createElement('option');
      opt.value = f;
      opt.textContent = f;
      select.appendChild(opt);
    });
  }

  /* ---------- File & Web data ---------- */

  function handleFiles(files){
    const listEl = document.getElementById('fileList');
    const rawEl  = document.getElementById('rawData');
    if(!files || files.length === 0){
      if(listEl) listEl.textContent = '‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå';
      return;
    }

    const lines = [];
    const readers = [];
    for(let i=0; i<files.length; i++){
      const f = files[i];
      lines.push(`‚Ä¢ ${f.name} (${f.type || 'unknown'}, ${f.size} bytes)`);
      const reader = new FileReader();
      readers.push(new Promise((resolve) => {
        reader.onload = () => resolve({name:f.name, content:reader.result});
        reader.onerror = () => resolve({name:f.name, content:''});
      }));
      reader.readAsText(f, 'utf-8');
    }

    if(listEl) listEl.innerHTML = lines.join('<br>');

    Promise.all(readers).then(results => {
      let txt = rawEl.value || '';
      if(txt) txt += '\n\n';
      txt += '===== ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î =====\n';
      results.forEach(r => {
        txt += `\n--- ${r.name} ---\n`;
        txt += (r.content || '').substring(0,4000); // ‡∏Å‡∏±‡∏ô‡∏¢‡∏≤‡∏ß‡πÄ‡∏Å‡∏¥‡∏ô
        if((r.content || '').length > 4000){
          txt += '\n...[‡∏ï‡∏±‡∏î‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ö‡∏≤‡∏á‡∏™‡πà‡∏ß‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏£‡∏∞‡∏ä‡∏±‡∏ö]...\n';
        }
      });
      rawEl.value = txt;
    });
  }

  function fetchFromWeb(){
    const url = document.getElementById('dataUrl').value || '';
    const rawEl = document.getElementById('rawData');
    if(!url){
      alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å URL ‡∏Å‡πà‡∏≠‡∏ô');
      return;
    }
    fetch(url, {mode:'cors'}).then(res => res.text()).then(text => {
      let txt = rawEl.value || '';
      if(txt) txt += '\n\n';
      txt += '===== ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Web: ' + url + ' =====\n';
      txt += text.substring(0,4000);
      if(text.length > 4000){
        txt += '\n...[‡∏ï‡∏±‡∏î‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ö‡∏≤‡∏á‡∏™‡πà‡∏ß‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏£‡∏∞‡∏ä‡∏±‡∏ö]...\n';
      }
      rawEl.value = txt;
      alert('‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Web ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à (‡∏ï‡∏±‡∏î‡∏ï‡∏≠‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏£‡∏∞‡∏ä‡∏±‡∏ö)');
    }).catch(err => {
      console.error(err);
      alert('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Web ‡πÑ‡∏î‡πâ (‡∏≠‡∏≤‡∏à‡∏ï‡∏¥‡∏î CORS ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏Ñ‡∏£‡∏∑‡∏≠‡∏Ç‡πà‡∏≤‡∏¢)');
    });
  }

  function appendRawDataTo(fieldId){
    const raw = document.getElementById('rawData').value || '';
    if(!raw){
      alert('‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏î‡∏¥‡∏ö‡πÉ‡∏ô‡∏ä‡πà‡∏≠‡∏á "‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏î‡∏¥‡∏ö‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô"');
      return;
    }
    const el = document.getElementById(fieldId);
    if(!el) return;
    let txt = el.value || '';
    if(txt) txt += '\n\n';
    txt += '[‡∏ï‡∏±‡∏î‡∏ï‡∏≠‡∏ô‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏î‡∏¥‡∏ö]\n';
    txt += raw.substring(0,1000);
    if(raw.length > 1000){
      txt += '\n...[‡∏ï‡∏±‡∏î‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ö‡∏≤‡∏á‡∏™‡πà‡∏ß‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏£‡∏∞‡∏ä‡∏±‡∏ö]...\n';
    }
    el.value = txt;
  }

  /* ---------- AI helpers ---------- */

  function getBasicMeta(){
    return {
      fy      : document.getElementById('fy').value || '‚Äî',
      period  : document.getElementById('period').value || '‚Äî',
      auditee : document.getElementById('auditee').value || '‚Äî',
      amphoe  : document.getElementById('amphoe').value || '‚Äî',
      province: document.getElementById('province').value || '‚Äî',
      formRef : document.getElementById('formRef').value || '‚Äî'
    };
  }

  function aiSuggestForField(fieldId, label){
    const meta = getBasicMeta();
    const raw  = document.getElementById('rawData').value || '';
    const el   = document.getElementById(fieldId);
    if(!el) return;

    let txt = '';
    txt += `‡∏™‡∏£‡∏∏‡∏õ/‡∏£‡πà‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö: ${label}\n`;
    txt += `‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏£‡∏±‡∏ö‡∏ï‡∏£‡∏ß‡∏à: ${meta.auditee} ‡∏≠.${meta.amphoe} ‡∏à.${meta.province}\n`;
    txt += `‡∏õ‡∏µ‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì ${meta.fy} ‡∏á‡∏ß‡∏î ${meta.period} (‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°: ${meta.formRef})\n\n`;
    txt += '- ‡∏õ‡∏£‡∏∞‡πÄ‡∏î‡πá‡∏ô‡∏´‡∏•‡∏±‡∏Å‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á (‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÇ‡∏Ñ‡∏£‡∏á‡∏£‡πà‡∏≤‡∏á):\n';
    txt += '  ‚Ä¢ ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô‡πÅ‡∏•‡∏∞‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏ì‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏ó‡∏µ‡πà‡∏û‡∏ö\n';
    txt += '  ‚Ä¢ ‡∏õ‡∏±‡∏à‡∏à‡∏±‡∏¢‡πÄ‡∏ä‡∏¥‡∏á‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì (‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡∏à‡∏≤‡∏Å‡∏á‡∏ö/‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô)\n';
    txt += '  ‚Ä¢ ‡∏õ‡∏±‡∏à‡∏à‡∏±‡∏¢‡πÄ‡∏ä‡∏¥‡∏á‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û (‡∏£‡∏∞‡∏ö‡∏ö‡∏á‡∏≤‡∏ô, ‡∏ö‡∏∏‡∏Ñ‡∏•‡∏≤‡∏Å‡∏£, ‡∏™‡∏¥‡πà‡∏á‡πÅ‡∏ß‡∏î‡∏•‡πâ‡∏≠‡∏° ‡∏Ø‡∏•‡∏Ø)\n';
    txt += '  ‚Ä¢ ‡∏Ç‡πâ‡∏≠‡∏™‡∏£‡∏∏‡∏õ‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô‡∏ß‡πà‡∏≤‡∏°‡∏µ/‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏ï‡πà‡∏≠ Going Concern ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£\n\n';
    if(raw){
      txt += '[‡∏ï‡∏±‡∏î‡∏ï‡∏≠‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏à‡∏≤‡∏Å‡πÅ‡∏´‡∏•‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏î‡∏¥‡∏ö]\n';
      txt += raw.substring(0,800);
      if(raw.length > 800){
        txt += '\n...[‡∏ï‡∏±‡∏î‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ö‡∏≤‡∏á‡∏™‡πà‡∏ß‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏£‡∏∞‡∏ä‡∏±‡∏ö]...\n';
      }
    }

    el.value = txt;
    alert('‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏Ñ‡∏£‡∏á‡∏£‡πà‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö: ' + label + ' ‡πÅ‡∏•‡πâ‡∏ß (‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°‡πÑ‡∏î‡πâ)');
  }

  function aiSuggestConclusion(){
    const meta   = getBasicMeta();
    const fin    = document.getElementById('gcFinancial').value || '';
    const ops    = document.getElementById('gcOperations').value || '';
    const legal  = document.getElementById('gcLegal').value || '';
    const other  = document.getElementById('gcOther').value || '';
    const plan   = document.getElementById('gcMgmtPlan').value || '';
    const el     = document.getElementById('gcConclusion');

    let txt = '';
    txt += `‡∏Ç‡πâ‡∏≠‡∏™‡∏£‡∏∏‡∏õ‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö Going Concern ‡∏Ç‡∏≠‡∏á ${meta.auditee} ‡∏õ‡∏µ‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì ${meta.fy}\n\n`;
    txt += '1) ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏õ‡∏±‡∏à‡∏à‡∏±‡∏¢‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏ó‡∏µ‡πà‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç\n';
    if(fin)   txt += '- ‡∏î‡πâ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏•‡∏∞‡∏™‡∏†‡∏≤‡∏û‡∏Ñ‡∏•‡πà‡∏≠‡∏á: ‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡πÄ‡∏î‡πá‡∏ô‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏ß‡πâ‡πÉ‡∏ô‡∏Ç‡πâ‡∏≠ 3.1\n';
    if(ops)   txt += '- ‡∏î‡πâ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏á‡∏≤‡∏ô/‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏∞: ‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡πÄ‡∏î‡πá‡∏ô‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏ß‡πâ‡πÉ‡∏ô‡∏Ç‡πâ‡∏≠ 3.2\n';
    if(legal) txt += '- ‡∏î‡πâ‡∏≤‡∏ô‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢/‡∏Ç‡πâ‡∏≠‡∏ú‡∏π‡∏Å‡∏û‡∏±‡∏ô/‡∏Ñ‡∏î‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°: ‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡πÄ‡∏î‡πá‡∏ô‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏ß‡πâ‡πÉ‡∏ô‡∏Ç‡πâ‡∏≠ 3.3\n';
    if(other) txt += '- ‡∏õ‡∏±‡∏à‡∏à‡∏±‡∏¢‡∏≠‡∏∑‡πà‡∏ô ‡πÜ: ‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏ß‡πâ‡πÉ‡∏ô‡∏Ç‡πâ‡∏≠ 3.4\n\n';

    txt += '2) ‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö\n';
    txt += '- ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡πÑ‡∏°‡πà‡πÅ‡∏ô‡πà‡∏ô‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏ô‡∏±‡∏¢‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏ï‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏á‡∏≤‡∏ô‡∏ï‡πà‡∏≠‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á: (‡∏£‡∏∞‡∏ö‡∏∏ ‡∏°‡∏µ/‡πÑ‡∏°‡πà‡∏°‡∏µ ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•)\n';
    txt += '- ‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏ï‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ç‡∏≠‡∏ö‡πÄ‡∏Ç‡∏ï/‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°:\n';
    txt += '  ‚Ä¢ ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£/‡∏´‡∏°‡∏ß‡∏î‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°\n';
    txt += '  ‚Ä¢ ‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Å‡∏£‡∏∞‡∏ö‡∏ß‡∏ô‡∏á‡∏≤‡∏ô Analytical / Substantive ‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á\n\n';

    txt += '3) ‡πÅ‡∏ú‡∏ô‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏ï‡∏≠‡∏ö‡∏™‡∏ô‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡∏ù‡πà‡∏≤‡∏¢‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£\n';
    if(plan){
      txt += '- ‡∏™‡∏£‡∏∏‡∏õ‡πÅ‡∏ú‡∏ô‡∏ï‡∏≤‡∏°‡∏Ç‡πâ‡∏≠ 3.5 ‡πÅ‡∏•‡∏∞‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠‡∏Ç‡∏≠‡∏á‡πÅ‡∏ú‡∏ô‡∏ô‡∏±‡πâ‡∏ô‡∏ï‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏ö‡∏£‡∏£‡πÄ‡∏ó‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á Going Concern\n\n';
    }else{
      txt += '- ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏ú‡∏ô‡∏Ç‡∏≠‡∏á‡∏ù‡πà‡∏≤‡∏¢‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÉ‡∏ô‡∏Ç‡πâ‡∏≠ 3.5\n\n';
    }

    txt += '4) ‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏ú‡∏¢‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏á‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô/‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏á‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô\n\n';
    txt += '5) ‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏´‡πá‡∏ô‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡∏™‡∏≠‡∏ö‡∏ö‡∏±‡∏ç‡∏ä‡∏µ\n';
    txt += '- (‡πÄ‡∏ä‡πà‡∏ô ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏´‡πá‡∏ô‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏≤‡∏£‡πÄ‡∏ô‡πâ‡∏ô‡∏¢‡πâ‡∏≥‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á Going Concern / ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏´‡πá‡∏ô‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏°‡∏µ‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç / ‡πÑ‡∏°‡πà‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏´‡πá‡∏ô ‡∏Ø‡∏•‡∏Ø)\n';

    el.value = txt;
    alert('‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡πà‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏™‡∏£‡∏∏‡∏õ Going Concern ‡πÅ‡∏•‡πâ‡∏ß (‡πÇ‡∏õ‡∏£‡∏î‡∏ó‡∏ö‡∏ó‡∏ß‡∏ô/‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏Å‡πâ‡πÉ‡∏´‡πâ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°)');
  }

  function fakeAiAnalyzeAll(){
    const meta = getBasicMeta();
    const ctx  = document.getElementById('gcContext').value || '';
    const fin  = document.getElementById('gcFinancial').value || '';
    const ops  = document.getElementById('gcOperations').value || '';
    const leg  = document.getElementById('gcLegal').value || '';
    const oth  = document.getElementById('gcOther').value || '';
    const plan = document.getElementById('gcMgmtPlan').value || '';
    const concl= document.getElementById('gcConclusion').value || '';
    const q    = document.getElementById('aiQuestion').value || '';
    const raw  = document.getElementById('rawData').value || '';

    let txt = '';
    txt += `‚òÖ ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô Going Concern ‚Äì ${meta.auditee} ‡∏õ‡∏µ‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì ${meta.fy}\n\n`;
    if(ctx){
      txt += '1) ‡∏ö‡∏£‡∏¥‡∏ö‡∏ó‡∏à‡∏≤‡∏Å‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á\n';
      txt += ctx.substring(0,800) + '\n\n';
    }
    txt += '2) ‡∏™‡∏£‡∏∏‡∏õ‡∏õ‡∏±‡∏à‡∏à‡∏±‡∏¢‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç\n';
    if(fin) txt += '- ‡∏î‡πâ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô: ‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÉ‡∏ô‡∏Ç‡πâ‡∏≠ 3.1\n';
    if(ops) txt += '- ‡∏î‡πâ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏á‡∏≤‡∏ô: ‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÉ‡∏ô‡∏Ç‡πâ‡∏≠ 3.2\n';
    if(leg) txt += '- ‡∏î‡πâ‡∏≤‡∏ô‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢/‡∏Ç‡πâ‡∏≠‡∏ú‡∏π‡∏Å‡∏û‡∏±‡∏ô: ‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÉ‡∏ô‡∏Ç‡πâ‡∏≠ 3.3\n';
    if(oth) txt += '- ‡∏õ‡∏±‡∏à‡∏à‡∏±‡∏¢‡∏≠‡∏∑‡πà‡∏ô ‡πÜ: ‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÉ‡∏ô‡∏Ç‡πâ‡∏≠ 3.4\n';
    txt += '\n';

    txt += '3) ‡∏Å‡∏≤‡∏£‡∏ï‡∏≠‡∏ö‡∏™‡∏ô‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡∏ù‡πà‡∏≤‡∏¢‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£\n';
    if(plan){
      txt += '- ‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏ú‡∏ô/‡∏°‡∏≤‡∏ï‡∏£‡∏Å‡∏≤‡∏£‡πÉ‡∏ô‡∏Ç‡πâ‡∏≠ 3.5 ‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏õ‡πÑ‡∏î‡πâ‡πÅ‡∏•‡∏∞‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡πÉ‡∏´‡πâ‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô\n\n';
    }else{
      txt += '- ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏ú‡∏ô‡∏Ç‡∏≠‡∏á‡∏ù‡πà‡∏≤‡∏¢‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡πÉ‡∏ô‡∏Ç‡πâ‡∏≠ 3.5\n\n';
    }

    txt += '4) ‡πÅ‡∏ô‡∏ß‡∏Ñ‡∏¥‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏£‡∏∏‡∏õ Going Concern ‡πÅ‡∏•‡∏∞‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏ï‡πà‡∏≠‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô\n';
    if(concl){
      txt += '- ‡∏°‡∏µ‡∏£‡πà‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏™‡∏£‡∏∏‡∏õ‡πÉ‡∏ô‡∏Ç‡πâ‡∏≠ 3.6 ‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏ê‡∏≤‡∏ô‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏ó‡∏≥‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ú‡∏π‡πâ‡∏™‡∏≠‡∏ö‡∏ö‡∏±‡∏ç‡∏ä‡∏µ\n';
    }else{
      txt += '- ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡πà‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏™‡∏£‡∏∏‡∏õ‡πÉ‡∏ô‡∏Ç‡πâ‡∏≠ 3.6 ‡∏Ñ‡∏ß‡∏£‡∏à‡∏±‡∏î‡∏ó‡∏≥‡∏Å‡πà‡∏≠‡∏ô‡∏™‡∏£‡∏∏‡∏õ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô\n';
    }
    txt += '\n';

    if(q){
      txt += '5) ‡πÇ‡∏à‡∏ó‡∏¢‡πå‡∏ó‡∏µ‡πà‡∏ú‡∏π‡πâ‡∏ï‡∏£‡∏ß‡∏à‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ AI ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°\n';
      txt += q + '\n\n';
    }

    if(raw){
      txt += '6) ‡∏ï‡∏±‡∏î‡∏ï‡∏≠‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏î‡∏¥‡∏ö‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå\n';
      txt += raw.substring(0,800);
      if(raw.length > 800){
        txt += '\n...[‡∏ï‡∏±‡∏î‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ö‡∏≤‡∏á‡∏™‡πà‡∏ß‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏£‡∏∞‡∏ä‡∏±‡∏ö]...\n';
      }
      txt += '\n';
    }

    txt += '\n(‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏: ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô‡πÇ‡∏Ñ‡∏£‡∏á‡∏£‡πà‡∏≤‡∏á‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ä‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏õ‡∏£‡∏∞‡πÄ‡∏î‡πá‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏™‡∏≠‡∏ö‡∏ó‡∏≤‡∏ô/‡∏ó‡∏ö‡∏ó‡∏ß‡∏ô‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡πÑ‡∏î‡πâ)\n';

    document.getElementById('aiOverall').value = txt;
    alert('‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏£‡∏∏‡∏õ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÅ‡∏•‡πâ‡∏ß (‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÑ‡∏î‡πâ‡∏ï‡∏≤‡∏°‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°)');
  }

  /* ---------- Build data ‡∏Å‡∏•‡∏≤‡∏á ---------- */

  function buildFormData(){
    const data = {
      fiscalYear  : document.getElementById('fy').value || '',
      period      : document.getElementById('period').value || '',
      auditee     : document.getElementById('auditee').value || '',
      amphoe      : document.getElementById('amphoe').value || '',
      province    : document.getElementById('province').value || '',
      formRef     : document.getElementById('formRef').value || '',
      gcContext   : document.getElementById('gcContext').value || '',
      rawData     : document.getElementById('rawData').value || '',
      gcFinancial : document.getElementById('gcFinancial').value || '',
      gcOperations: document.getElementById('gcOperations').value || '',
      gcLegal     : document.getElementById('gcLegal').value || '',
      gcOther     : document.getElementById('gcOther').value || '',
      gcMgmtPlan  : document.getElementById('gcMgmtPlan').value || '',
      gcConclusion: document.getElementById('gcConclusion').value || '',
      aiQuestion  : document.getElementById('aiQuestion').value || '',
      aiOverall   : document.getElementById('aiOverall').value || '',
      meta: {
        formCode : '‡∏≠‡∏õ‡∏ó.3.1',
        module   : 'FA-LG-Annual-Planning',
        exportedAt: new Date().toISOString()
      }
    };
    return data;
  }

  /* ---------- Sync ‡πÑ‡∏õ A4 ---------- */

  function pushToA4(){
    const d = buildFormData();

    document.getElementById('a4Fy').textContent       = d.fiscalYear || '';
    document.getElementById('a4Period').textContent   = d.period || '';
    document.getElementById('a4Auditee').textContent  = d.auditee || '';
    document.getElementById('a4Amphoe').textContent   = d.amphoe || '';
    document.getElementById('a4Province').textContent = d.province || '';
    document.getElementById('a4FormRef').textContent  = d.formRef || '';

    document.getElementById('a4GcContext').innerHTML   = nl2br(d.gcContext);
    document.getElementById('a4RawData').innerHTML     = nl2br(d.rawData ? d.rawData.substring(0,1500) + (d.rawData.length>1500 ? '\n...[‡∏ï‡∏±‡∏î‡∏ï‡∏≠‡∏ô]...' : '') : '');
    document.getElementById('a4GcFinancial').innerHTML = nl2br(d.gcFinancial);
    document.getElementById('a4GcOperations').innerHTML= nl2br(d.gcOperations);
    document.getElementById('a4GcLegal').innerHTML     = nl2br(d.gcLegal);
    document.getElementById('a4GcOther').innerHTML     = nl2br(d.gcOther);
    document.getElementById('a4GcMgmtPlan').innerHTML  = nl2br(d.gcMgmtPlan);
    document.getElementById('a4GcConclusion').innerHTML= nl2br(d.gcConclusion);
    document.getElementById('a4AiOverall').innerHTML   = nl2br(d.aiOverall);

    const now = new Date();
    const ts  = now.toLocaleString('th-TH');
    document.getElementById('a4FooterMeta').textContent = '‡∏û‡∏¥‡∏°‡∏û‡πå‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö FA ‚Äì LG ‡∏ì ' + ts;
  }

  /* ---------- Export ---------- */

  function exportA4Html(){
    const a4 = document.getElementById('a4Page');
    if(!a4){
      alert('‡πÑ‡∏°‡πà‡∏û‡∏ö‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤ A4');
      return;
    }
    const htmlContent =
      '<!DOCTYPE html><html lang="th"><head><meta charset="UTF-8"><title>OP3-1-Going-Concern-A4</title>' +
      '<style>@page{size:A4;margin:12mm;}body{font-family:"TH Sarabun New","Segoe UI",sans-serif;font-size:11pt;} .a4-page{width:100%;min-height:100%;}</style>' +
      '</head><body>' + a4.outerHTML + '</body></html>';

    const blob = new Blob([htmlContent], {type:'text/html'});
    const url  = URL.createObjectURL(blob);
    const a    = document.createElement('a');
    a.href = url;
    a.download = 'op3_1_going_concern_a4.html';
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    URL.revokeObjectURL(url);
  }

  function exportJson(){
    const data = buildFormData();
    const blob = new Blob([JSON.stringify(data,null,2)], {type:'application/json'});
    const url  = URL.createObjectURL(blob);
    const a    = document.createElement('a');
    a.href = url;
    a.download = 'op3_1_going_concern.json';
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    URL.revokeObjectURL(url);
  }

  /* ---------- Integration: Review & Working Papers ---------- */

  function sendToReviewSystem(){
    const data = buildFormData();

    try{
      localStorage.setItem('fa_op3_1_last_for_review', JSON.stringify(data));
    }catch(e){
      console.error('localStorage error', e);
    }

    /*
    fetch('/api/review-system/op3-1', {
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body:JSON.stringify(data)
    });
    */

    alert('‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏° ‡∏≠‡∏õ‡∏ó.3.1 ‡∏™‡πà‡∏á‡πÑ‡∏õ ‚Äú‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏≠‡∏ö‡∏ó‡∏≤‡∏ô‚Äù (‡∏à‡∏≥‡∏•‡∏≠‡∏á) ‡πÅ‡∏•‡πâ‡∏ß \n(‡πÄ‡∏Å‡πá‡∏ö‡∏ó‡∏µ‡πà localStorage: fa_op3_1_last_for_review)');
  }

  function sendToWorkingpaperDb(){
    const data = buildFormData();

    try{
      localStorage.setItem('fa_op3_1_last_workingpaper', JSON.stringify(data));
    }catch(e){
      console.error('localStorage error', e);
    }

    /*
    fetch('/api/workingpapers/op3-1', {
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body:JSON.stringify(data)
    });
    */

    alert('‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏° ‡∏≠‡∏õ‡∏ó.3.1 ‡∏™‡πà‡∏á‡πÑ‡∏õ ‚Äú‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏©‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‚Äù (‡∏à‡∏≥‡∏•‡∏≠‡∏á) ‡πÅ‡∏•‡πâ‡∏ß \n(‡πÄ‡∏Å‡πá‡∏ö‡∏ó‡∏µ‡πà localStorage: fa_op3_1_last_workingpaper)');
  }

  /* ---------- Init ---------- */

  document.addEventListener('DOMContentLoaded', function(){
    initGovDbFromLocalStorage();
    initPeriods();
    initFormRefs();

    const provinceSelect = document.getElementById('province');
    const amphoeSelect   = document.getElementById('amphoe');

    if(provinceSelect){
      provinceSelect.addEventListener('change', onProvinceChange);
    }
    if(amphoeSelect){
      amphoeSelect.addEventListener('change', onAmphoeChange);
    }
  });
</script>

</body>
</html>
