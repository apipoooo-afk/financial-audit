<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<title>FA DB | ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏£‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô / ‡∏™‡∏∑‡πà‡∏≠‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
  :root{--bg:#060818;--card:#11152b;--muted:#a3acc7;}
  *{box-sizing:border-box;}
  body{margin:0;font-family:"Segoe UI",Arial,sans-serif;background:var(--bg);color:#fff;}
  header{padding:18px 10px;text-align:center;background:linear-gradient(120deg,#b91c1c,#0d47a1);box-shadow:0 4px 14px rgba(0,0,0,.6);}
  header h1{margin:0;font-size:22px;font-weight:800;}
  header p{margin:4px 0 0;font-size:13px;color:var(--muted);}
  .wrap{max-width:1100px;margin:18px auto 30px;padding:0 16px;}
  .top-row{display:flex;justify-content:space-between;flex-wrap:wrap;gap:8px;font-size:13px;color:var(--muted);margin-bottom:10px;}
  .stat-box span{margin-right:10px;}
  .card{background:var(--card);border-radius:16px;border:1px solid rgba(255,255,255,.14);padding:14px;margin-bottom:14px;box-shadow:0 8px 20px rgba(0,0,0,.55);}
  h2{margin:0 0 8px;font-size:18px;}
  label{display:block;font-size:12px;margin-top:6px;margin-bottom:3px;}
  input,select,textarea{width:100%;padding:7px 8px;border-radius:8px;border:1px solid rgba(255,255,255,.18);background:#05081a;color:#fff;font-size:13px;outline:none;}
  input:focus,select:focus,textarea:focus{border-color:#20c997;box-shadow:0 0 0 1px rgba(32,201,151,.4);}
  textarea{min-height:60px;resize:vertical;}
  .form-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:8px 12px;}
  .btn-row{margin-top:10px;display:flex;flex-wrap:wrap;gap:8px;align-items:center;}
  button{border:none;border-radius:999px;padding:8px 13px;font-size:12px;cursor:pointer;}
  .btn-primary{background:#22c55e;color:#000;font-weight:700;}
  .btn-secondary{background:#374151;color:#e5e7eb;}
  .btn-danger{background:#b91c1c;color:#fff;}
  .muted{font-size:12px;color:var(--muted);}
  table{width:100%;border-collapse:collapse;font-size:12px;margin-top:6px;}
  th,td{border:1px solid rgba(148,163,184,.4);padding:6px 5px;vertical-align:top;}
  th{background:#020617;font-weight:600;position:sticky;top:0;z-index:1;}
  tr:nth-child(even){background:rgba(15,23,42,.8);}
  .actions button{margin-right:4px;margin-bottom:2px;}
  a.nav{display:inline-block;margin-top:10px;margin-right:8px;color:#e0e7ff;text-decoration:none;font-size:13px;}
  @media(max-width:720px){th,td{font-size:11px;}}
</style>
</head>
<body>
<header>
  <h1>üì£ FA DB ‚Äì ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏£‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô / ‡∏™‡∏∑‡πà‡∏≠‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå</h1>
  <p>Complaints & Social / Online Media Intelligence</p>
</header>

<div class="wrap">
  <div class="top-row">
    <div>‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô (session): <strong id="userEmail">-</strong></div>
    <div class="stat-box">
      üëÅ ‡∏£‡∏≠‡∏ö‡∏ô‡∏µ‡πâ: <strong id="statCurrent">0</strong>
      üîÑ ‡∏™‡∏∞‡∏™‡∏°: <strong id="statTotal">0</strong>
    </div>
  </div>

  <!-- ‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å -->
  <div class="card">
    <h2>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏£‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô / ‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏ì‡∏à‡∏≤‡∏Å‡∏™‡∏∑‡πà‡∏≠‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå</h2>
    <form id="dataForm">
      <div class="form-grid">
        <div>
          <label>‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏£‡∏±‡∏ö‡∏ï‡∏£‡∏ß‡∏à / ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà (entity)</label>
          <input id="f-entity" required placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏≠‡∏ö‡∏ï.‡∏õ‡∏£‡∏∑‡∏≠‡πÉ‡∏´‡∏ç‡πà, ‡∏£‡∏û.‡∏™‡∏ï.‡∏ö‡πâ‡∏≤‡∏ô...">
        </div>
        <div>
          <label>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏û‡∏ö / ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏£‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô (dateReported)</label>
          <input id="f-dateReported" type="date">
        </div>
        <div>
          <label>‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á‡∏™‡∏∑‡πà‡∏≠ (channelType)</label>
          <select id="f-channelType">
            <option value="">- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å -</option>
            <option>Facebook</option>
            <option>Facebook Page</option>
            <option>Facebook Group</option>
            <option>X (Twitter)</option>
            <option>TikTok</option>
            <option>LINE</option>
            <option>YouTube</option>
            <option>Website</option>
            <option>‡∏Ç‡πà‡∏≤‡∏ß‡∏™‡∏∑‡πà‡∏≠‡∏°‡∏ß‡∏•‡∏ä‡∏ô</option>
            <option>‡∏≠‡∏∑‡πà‡∏ô ‡πÜ</option>
          </select>
        </div>
        <div>
          <label>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ú‡∏π‡πâ‡∏£‡πâ‡∏≠‡∏á (complainantType)</label>
          <select id="f-complainantType">
            <option value="">- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å -</option>
            <option>‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏‡∏ï‡∏±‡∏ß‡∏ï‡∏ô</option>
            <option>‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ</option>
            <option>‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ê</option>
            <option>‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£/‡πÄ‡∏Ñ‡∏£‡∏∑‡∏≠‡∏Ç‡πà‡∏≤‡∏¢</option>
            <option>‡∏™‡∏∑‡πà‡∏≠‡∏°‡∏ß‡∏•‡∏ä‡∏ô</option>
          </select>
        </div>
        <div>
          <label>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏õ‡∏£‡∏∞‡πÄ‡∏î‡πá‡∏ô (issueType)</label>
          <input id="f-issueType" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏ó‡∏∏‡∏à‡∏£‡∏¥‡∏ï‡∏á‡∏ö, ‡∏Æ‡∏±‡πâ‡∏ß‡∏õ‡∏£‡∏∞‡∏°‡∏π‡∏•, ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏£‡∏±‡∏ö‡∏ú‡∏•‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏ä‡∏ô‡πå">
        </div>
        <div>
          <label>‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á/‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á (severity)</label>
          <select id="f-severity">
            <option value="">- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å -</option>
            <option>‡∏ï‡πà‡∏≥</option>
            <option>‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á</option>
            <option>‡∏™‡∏π‡∏á</option>
            <option>‡∏ß‡∏¥‡∏Å‡∏§‡∏ï</option>
          </select>
        </div>
        <div>
          <label>‡∏•‡∏¥‡∏á‡∏Å‡πå / URL ‡πÇ‡∏û‡∏™‡∏ï‡πå (url)</label>
          <input id="f-url" placeholder="https://...">
        </div>
      </div>

      <label>‡∏™‡∏£‡∏∏‡∏õ‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤ / ‡∏Ç‡πâ‡∏≠‡∏Å‡∏•‡πà‡∏≤‡∏ß‡∏´‡∏≤ (summary)</label>
      <textarea id="f-summary" placeholder="‡∏™‡∏£‡∏∏‡∏õ‡πÉ‡∏à‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏£‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô / ‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏û‡∏ö‡∏à‡∏≤‡∏Å‡∏™‡∏∑‡πà‡∏≠‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå"></textarea>

      <label>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ / ‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£ (remark)</label>
      <textarea id="f-remark"></textarea>

      <div class="btn-row">
        <button type="submit" class="btn-primary" id="btnSave">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
        <button type="button" class="btn-secondary" id="btnClear">‡∏•‡πâ‡∏≤‡∏á‡∏ü‡∏≠‡∏£‡πå‡∏°</button>
      </div>
    </form>
  </div>

  <!-- ‡∏ï‡∏≤‡∏£‡∏≤‡∏á + Import/Export -->
  <div class="card">
    <h2>‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏£‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô / ‡∏™‡∏∑‡πà‡∏≠‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå</h2>
    <p class="muted">
      ‚Ä¢ ‡πÄ‡∏Å‡πá‡∏ö‡πÉ‡∏ô <code>localStorage["fa-db-data-complaint"]</code><br>
      ‚Ä¢ ‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå CSV ‡πÅ‡∏•‡∏∞‡∏à‡∏≤‡∏Å URL (‡∏Å‡∏£‡∏ì‡∏µ‡πÄ‡∏õ‡πá‡∏ô CSV/JSON ‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡∏¥‡∏î‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏∞)
    </p>
    <div class="btn-row">
      <label class="muted">
        üì• Import CSV ‡∏à‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå:
        <input type="file" id="csvFile" accept=".csv">
      </label>
      <div style="flex:1;min-width:220px;">
        <label class="muted">üì• ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å URL (CSV/JSON ‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏∞)</label>
        <input id="onlineUrl" placeholder="‡πÄ‡∏ä‡πà‡∏ô https://....csv ‡∏´‡∏£‡∏∑‡∏≠ https://.../api?format=json">
      </div>
      <button type="button" class="btn-secondary" id="btnImportOnline">‡∏î‡∏∂‡∏á‡∏à‡∏≤‡∏Å URL</button>
      <button type="button" class="btn-secondary" id="btnExport">üì§ Export CSV</button>
      <button type="button" class="btn-danger" id="btnDeleteAll">üóë ‡∏•‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
    </div>
    <p class="muted">
      ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏´‡∏±‡∏ß‡∏ï‡∏≤‡∏£‡∏≤‡∏á CSV ‡∏ó‡∏µ‡πà‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥:  
      <code>entity,dateReported,channelType,complainantType,issueType,severity,url,summary,remark</code>
    </p>

    <div style="max-height:360px;overflow:auto;margin-top:6px;">
      <table>
        <thead>
          <tr>
            <th>#</th>
            <th>‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏£‡∏±‡∏ö‡∏ï‡∏£‡∏ß‡∏à</th>
            <th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏£‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</th>
            <th>‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á</th>
            <th>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ú‡∏π‡πâ‡∏£‡πâ‡∏≠‡∏á</th>
            <th>‡∏õ‡∏£‡∏∞‡πÄ‡∏î‡πá‡∏ô</th>
            <th>‡∏£‡∏∞‡∏î‡∏±‡∏ö</th>
            <th>URL</th>
            <th>‡∏™‡∏£‡∏∏‡∏õ</th>
            <th>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏</th>
            <th>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
          </tr>
        </thead>
        <tbody id="dataBody"></tbody>
      </table>
    </div>
  </div>

  <a href="fa-database-menu.html" class="nav">‚¨Ö ‡∏Å‡∏•‡∏±‡∏ö‡πÄ‡∏°‡∏ô‡∏π‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</a>
  <a href="index.html" class="nav">‚¨Ö ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å</a>
</div>

<script>
const MODULE_KEY = "complaint";
const STORAGE_KEY = "fa-db-data-" + MODULE_KEY;
const TOTAL_KEY   = "fa-db-total-" + MODULE_KEY;
const SESSION_KEY = "fa-db-session-" + MODULE_KEY;
let data = [];
let editIndex = -1;

function checkSession(){
  const raw = localStorage.getItem("fas-session");
  if(!raw){ location.href="fa-database-login.html"; return; }
  try{
    const s = JSON.parse(raw);
    if(Date.now()>s.expiresAt){ localStorage.removeItem("fas-session"); location.href="fa-database-login.html"; return; }
    document.getElementById("userEmail").textContent = s.email || "-";
  }catch{ location.href="fa-database-login.html"; }
}
function updateStatsOnLoad(){
  const total = Number(localStorage.getItem(TOTAL_KEY)||"0")+1;
  const curr  = Number(sessionStorage.getItem(SESSION_KEY)||"0")+1;
  localStorage.setItem(TOTAL_KEY,String(total));
  sessionStorage.setItem(SESSION_KEY,String(curr));
  statTotal.textContent = total;
  statCurrent.textContent = curr;
}
function loadData(){
  try{ const raw = localStorage.getItem(STORAGE_KEY); data = raw?JSON.parse(raw):[]; }catch{ data=[]; }
}
function saveData(){ localStorage.setItem(STORAGE_KEY,JSON.stringify(data)); }
function renderTable(){
  const tbody = document.getElementById("dataBody");
  tbody.innerHTML = "";
  data.forEach((r,idx)=>{
    const tr=document.createElement("tr");
    tr.innerHTML = `
      <td>${idx+1}</td>
      <td>${r.entity||""}</td>
      <td>${r.dateReported||""}</td>
      <td>${r.channelType||""}</td>
      <td>${r.complainantType||""}</td>
      <td>${r.issueType||""}</td>
      <td>${r.severity||""}</td>
      <td>${r.url?`<a href="${r.url}" target="_blank">‡∏•‡∏¥‡∏á‡∏Å‡πå</a>`:""}</td>
      <td>${r.summary||""}</td>
      <td>${r.remark||""}</td>
      <td class="actions">
        <button type="button" onclick="editRow(${idx})">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</button>
        <button type="button" onclick="deleteRow(${idx})">‡∏•‡∏ö</button>
      </td>`;
    tbody.appendChild(tr);
  });
  if(data.length===0){
    const tr=document.createElement("tr");
    tr.innerHTML=`<td colspan="11" style="text-align:center;color:#9ca3af;">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</td>`;
    tbody.appendChild(tr);
  }
}
function clearForm(){
  f-entity.value=""; f-dateReported.value=""; f-channelType.value="";
  f-complainantType.value=""; f-issueType.value=""; f-severity.value="";
  f-url.value=""; f-summary.value=""; f-remark.value="";
  editIndex=-1; btnSave.textContent="‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•";
}
dataForm.addEventListener("submit",e=>{
  e.preventDefault();
  const row={
    entity: f-entity.value.trim(),
    dateReported: f-dateReported.value,
    channelType: f-channelType.value,
    complainantType: f-complainantType.value,
    issueTyp

