<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <title>Login | Financial Audit System</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root{
      --primary:#0d47a1;
      --primary-2:#42a5f5;
      --accent:#ffd54f;
      --bg:#060818;
      --bg-soft:#0b1024;
      --card:#11152b;
      --text:#f5f7ff;
      --muted:#a3acc7;
      --maroon:#7b1e3c;
      --pink:#f48fb1;
      --border:#262b46;
    }
    *{box-sizing:border-box;}
    body{
      margin:0;
      font-family:"Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      background:
        radial-gradient(circle at 10% 0%, rgba(123,30,60,0.36) 0, transparent 55%),
        radial-gradient(circle at 90% 100%, rgba(66,165,245,0.32) 0, transparent 55%),
        radial-gradient(circle at 0% 100%, rgba(244,143,177,0.25) 0, transparent 55%),
        var(--bg);
      color:var(--text);
    }
    a{color:var(--pink); text-decoration:none;}
    a:hover{text-decoration:underline;}

    /* time bar */
    #timeBar{
      width:100%;
      padding:8px 10px;
      text-align:center;
      background:#11152b;
      color:#f5f7ff;
      font-size:13px;
      border-bottom:1px solid rgba(255,255,255,0.15);
    }

    header{
      position:sticky; top:0; z-index:20;
      background:linear-gradient(120deg,var(--maroon),var(--primary),var(--pink));
      box-shadow:0 10px 28px rgba(0,0,0,.55);
      border-bottom:1px solid rgba(255,255,255,0.06);
      backdrop-filter:blur(16px);
    }
    .container{max-width:980px; margin:0 auto; padding:0 20px;}
    .header-inner{
      display:flex; justify-content:space-between; align-items:center;
      padding:10px 0; gap:16px;
    }
    .brand{
      display:flex; align-items:center; gap:10px;
      font-weight:700; font-size:17px;
    }
    .brand img{
      height:40px; border-radius:50%; background:#fff; padding:4px;
      box-shadow:0 4px 10px rgba(0,0,0,0.4);
    }
    nav ul{
      list-style:none; display:flex; gap:8px; margin:0; padding:0; flex-wrap:wrap;
    }
    nav a{
      color:#fff; font-size:12px;
      padding:5px 10px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,0.18);
      background:rgba(0,0,0,0.12);
    }
    nav a:hover{
      background:rgba(255,255,255,0.2);
    }

    main{padding:24px 0 40px;}
    h1{
      margin:4px 0 2px;
      font-size:24px;
    }
    p.muted-heading{
      margin:0; font-size:12px; color:var(--muted);
    }

    .grid-2{display:grid; grid-template-columns:1.3fr 0.7fr; gap:20px; margin-top:20px;}
    .grid-3{display:grid; grid-template-columns:repeat(3,1fr); gap:18px; margin-top:18px;}
    .card{
      background:linear-gradient(145deg,rgba(17,21,43,0.96),rgba(25,31,60,0.98));
      border-radius:14px;
      border:1px solid rgba(255,255,255,0.08);
      padding:18px 18px 16px;
      box-shadow:0 14px 34px rgba(0,0,0,.8);
    }
    h2{font-size:18px; margin:0 0 6px;}
    h3{font-size:15px; margin:0 0 6px;}
    .muted{font-size:12px; color:var(--muted);}

    label{
      display:block; margin-top:8px; margin-bottom:4px;
      font-size:12px; font-weight:600;
    }
    input[type="text"],
    input[type="email"],
    input[type="password"],
    input[type="tel"]{
      width:100%;
      padding:8px 9px;
      border-radius:9px;
      border:1px solid rgba(255,255,255,0.12);
      background:rgba(5,8,26,0.9);
      color:#fff;
      font-size:13px;
      outline:none;
    }
    input:focus{
      border-color:var(--pink);
      box-shadow:0 0 0 1px rgba(244,143,177,0.4);
    }
    .inline-row{
      display:flex; gap:8px; flex-wrap:wrap;
    }
    .inline-row > div{flex:1 1 0;}
    button{
      padding:9px 14px;
      border-radius:999px;
      border:none;
      cursor:pointer;
      font-size:13px;
      font-weight:700;
      color:#fff;
      background:linear-gradient(135deg,var(--primary-2),var(--maroon));
      box-shadow:0 6px 16px rgba(13,71,161,0.7);
    }
    button:hover{
      filter:brightness(1.04);
      box-shadow:0 0 16px rgba(66,165,245,0.85);
    }
    .btn-ghost{
      background:rgba(0,0,0,0.35);
      box-shadow:none;
      border:1px solid rgba(255,255,255,0.14);
    }
    .checkbox-row{
      display:flex; align-items:center; gap:6px;
      font-size:11px; margin-top:6px;
    }
    .status-badge{
      display:inline-block;
      padding:4px 9px;
      border-radius:999px;
      font-size:11px;
      border:1px solid rgba(255,255,255,0.2);
      margin-top:4px;
    }
    .status-pending{color:#ffca28; border-color:#ffca28;}
    .status-approved{color:#69f0ae; border-color:#69f0ae;}
    .msg{
      font-size:11px;
      margin-top:6px;
      min-height:14px;
    }
    .msg-error{color:#ff8a80;}
    .msg-success{color:#69f0ae;}

    .stats-row{
      display:flex;
      flex-wrap:wrap;
      gap:10px;
      margin-top:6px;
      font-size:12px;
    }
    .stats-pill{
      padding:4px 10px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,0.18);
      background:rgba(0,0,0,0.25);
    }

    .captcha-box{
      display:flex;
      gap:10px;
      align-items:center;
      flex-wrap:wrap;
      margin-top:4px;
    }
    .captcha-text{
      padding:6px 10px;
      border-radius:8px;
      background:#050814;
      border:1px dashed rgba(255,255,255,0.3);
      font-weight:700;
      letter-spacing:2px;
      font-size:13px;
      user-select:none;
    }
    .captcha-refresh{
      font-size:11px;
      cursor:pointer;
      text-decoration:underline;
      color:var(--accent);
    }

    footer{
      border-top:1px solid rgba(255,255,255,0.1);
      padding:12px 0 16px;
      background:#050714;
      font-size:11px;
      color:var(--muted);
    }
    footer .container{
      display:flex; justify-content:space-between; gap:10px; flex-wrap:wrap;
    }

    @media(max-width:900px){
      .grid-2{grid-template-columns:1fr;}
    }
    @media(max-width:720px){
      .grid-3{grid-template-columns:1fr;}
    }
  </style>
</head>
<body>
  <!-- ‡πÅ‡∏ñ‡∏ö‡πÄ‡∏ß‡∏•‡∏≤ -->
  <div id="timeBar"></div>

  <header>
    <div class="container header-inner">
      <div class="brand">
        <img src="images/oag-logo.png" alt="OAG">
        <div>
          Financial Audit System
          <div style="font-size:11px; opacity:.85;">Login &amp; Identity Management</div>
        </div>
      </div>
      <nav>
        <ul>
          <li><a href="index.html">üè† ‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å (Home)</a></li>
          <li><a href="fa-login.html">üîê Login</a></li>
          <li><a href="admin.html" target="_blank">üßë‚Äçüíº Admin Console</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <main>
    <div class="container">
      <h1>‡∏£‡∏∞‡∏ö‡∏ö Login ‡πÅ‡∏•‡∏∞‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ (Login &amp; User Account Management)</h1>
      <p class="muted-heading">
        ‡πÉ‡∏ä‡πâ‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏±‡∏ö‡∏ó‡∏∏‡∏Å‡πÇ‡∏°‡∏î‡∏π‡∏• ‡∏¢‡∏Å‡πÄ‡∏ß‡πâ‡∏ô‡∏´‡∏ô‡πâ‡∏≤ Admin (‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ú‡∏π‡πâ‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô) ‚Ä¢
        ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÉ‡∏´‡∏°‡πà (Registration), ‡∏•‡∏∑‡∏°‡∏£‡∏´‡∏±‡∏™ (Forgot Password), ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏´‡∏±‡∏™ (Change Password)
        ‡πÅ‡∏•‡∏∞‡∏à‡∏≥‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 6 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô (Remember me up to 6 months)
      </p>

      <!-- ‡πÅ‡∏ñ‡∏ß‡∏ö‡∏ô: Login + Info -->
      <div class="grid-2">
        <div class="card">
          <h2>üîê ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö (Login)</h2>
          <p class="muted">
            ‡∏Å‡∏£‡∏≠‡∏Å‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡πÅ‡∏•‡∏∞‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÅ‡∏•‡πâ‡∏ß (Approved Email &amp; Password)
            ‡∏´‡∏≤‡∏Å‡πÄ‡∏•‡∏∑‡∏≠‡∏Å ‚Äú‡∏à‡∏≥‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö (Remember me)‚Äù ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏à‡∏≥‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 6 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô
          </p>
          <form id="loginForm">
            <label for="loginEmail">‡∏≠‡∏µ‡πÄ‡∏°‡∏• (Email)</label>
            <input type="email" id="loginEmail" required>

            <label for="loginPassword">‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô (Password)</label>
            <input type="password" id="loginPassword" required>

            <div class="checkbox-row">
              <input type="checkbox" id="rememberMe">
              <label for="rememberMe" style="margin:0;">‡∏à‡∏≥‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö (Remember me, max 6 months)</label>
            </div>

            <div class="checkbox-row">
              <input type="checkbox" id="loginHuman" required>
              <label for="loginHuman" style="margin:0;">
                ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ß‡πà‡∏≤‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡∏´‡∏∏‡πà‡∏ô‡∏¢‡∏ô‡∏ï‡πå (Confirm you are human) ‡πÅ‡∏•‡∏∞‡∏¢‡∏≠‡∏°‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏≤‡∏°‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö‡∏Ç‡∏≠‡∏á ‡∏™‡∏ï‡∏á.
              </label>
            </div>

            <div style="margin-top:10px; display:flex; gap:8px; flex-wrap:wrap;">
              <button type="submit">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö (Login)</button>
              <button type="button" class="btn-ghost" onclick="window.location.href='index.html'">
                ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å (Back to Home)
              </button>
            </div>
            <div id="loginMsg" class="msg"></div>
            <div id="loginStatus" class="status-badge" style="display:none;"></div>

            <!-- ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö -->
            <div style="margin-top:12px; border-top:1px solid rgba(255,255,255,0.12); padding-top:8px;">
              <strong style="font-size:12px;">üìä ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö (Login Statistics ‚Äì this browser)</strong>
              <div class="stats-row">
                <div class="stats-pill">
                  ‡∏ú‡πà‡∏≤‡∏ô (Successful): <span id="loginSuccessCount">0</span> ‡∏Ñ‡∏£‡∏±‡πâ‡∏á (times)
                </div>
                <div class="stats-pill">
                  ‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô (Failed): <span id="loginFailCount">0</span> ‡∏Ñ‡∏£‡∏±‡πâ‡∏á (times)
                </div>
                <div class="stats-pill">
                  ‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (Total): <span id="loginTotalCount">0</span> ‡∏Ñ‡∏£‡∏±‡πâ‡∏á (times)
                </div>
              </div>
              <div class="muted" style="margin-top:4px;">
                ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î (Last update): <span id="loginLastUpdate">-</span>
              </div>
            </div>
          </form>
        </div>

        <div class="card">
          <h3>üõ° ‡∏ô‡πÇ‡∏¢‡∏ö‡∏≤‡∏¢‡πÅ‡∏•‡∏∞‡∏ö‡∏ó‡∏ö‡∏≤‡∏ó (Policy &amp; Roles)</h3>
          <ul class="muted">
            <li>‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ (General User) ‡∏ó‡∏µ‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡∏à‡∏∞‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡∏ó‡∏∏‡∏Å‡∏£‡∏∞‡∏ö‡∏ö ‡∏¢‡∏Å‡πÄ‡∏ß‡πâ‡∏ô Admin Console</li>
            <li>‡πÄ‡∏â‡∏û‡∏≤‡∏∞ <strong>super_admin / admin / admin1</strong> ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤ Admin Console ‡πÑ‡∏î‡πâ (Admin-only)</li>
            <li>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÉ‡∏´‡∏°‡πà (Registration), ‡∏•‡∏∑‡∏°‡∏£‡∏´‡∏±‡∏™ (Forgot), ‡∏Ç‡∏≠‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏´‡∏±‡∏™ (Change) ‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏™‡πà‡∏á‡πÑ‡∏õ‡∏¢‡∏±‡∏á Admin ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥</li>
            <li>‡∏ó‡∏∏‡∏Å‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏ñ‡∏≤‡∏°‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏™‡∏°‡∏≠ (‚Äú‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô ‡∏Å‡∏î‡πÇ‡∏≠‡πÄ‡∏Ñ? / Please confirm‚Äù)</li>
            <li>‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏Ñ‡∏ß‡∏£‡∏°‡∏µ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 8 ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£ ‡∏ú‡∏™‡∏°‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡πÅ‡∏•‡∏∞‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£ (Password ‚â• 8 chars, mix letters &amp; numbers)</li>
          </ul>
        </div>
      </div>

      <!-- ‡πÅ‡∏ñ‡∏ß‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ + ‡∏™‡∏£‡∏∏‡∏õ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥ -->
      <div class="grid-2" style="margin-top:20px;">
        <div class="card">
          <h3>üìò ‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏£‡∏∞‡∏ö‡∏ö Login (How to use Login)</h3>
          <ol class="muted" style="padding-left:16px; margin-top:6px;">
            <li>‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡∏£‡∏´‡∏±‡∏™‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß ‚Üí ‡πÉ‡∏ä‡πâ‡∏Å‡∏•‡πà‡∏≠‡∏á <strong>üîê ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö (Login)</strong> ‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô‡∏ã‡πâ‡∏≤‡∏¢</li>
            <li>‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏´‡∏±‡∏™ ‚Üí ‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏õ‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á ‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡∏Å‡∏•‡πà‡∏≠‡∏á <strong>üìù ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà (User Registration)</strong></li>
            <li>‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÄ‡∏™‡∏£‡πá‡∏à ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏Ç‡∏≠‡πÑ‡∏õ‡πÉ‡∏´‡πâ Admin ‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥ (Send request to Admin for approval)</li>
            <li>‡∏´‡∏•‡∏±‡∏á‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥ ‡πÉ‡∏´‡πâ‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡∏ó‡∏µ‡πà‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠ Login ‡∏ô‡∏µ‡πâ ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏£‡∏≠‡∏Å‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡πÅ‡∏•‡∏∞‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥</li>
            <li>‡∏ñ‡πâ‡∏≤‡∏•‡∏∑‡∏°‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô ‚Üí ‡πÉ‡∏ä‡πâ‡∏Å‡∏•‡πà‡∏≠‡∏á <strong>‚ùì ‡∏•‡∏∑‡∏°‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô (Forgot Password)</strong> ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ñ‡∏≥‡∏Ç‡∏≠‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï</li>
            <li>‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡∏à‡∏≥‡∏£‡∏´‡∏±‡∏™‡πÄ‡∏î‡∏¥‡∏°‡πÑ‡∏î‡πâ ‚Üí ‡πÉ‡∏ä‡πâ‡∏Å‡∏•‡πà‡∏≠‡∏á <strong>üîÅ ‡∏Ç‡∏≠‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô (Change Password)</strong> ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÑ‡∏î‡πâ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ</li>
          </ol>
          <p class="muted" style="margin-top:8px;">
            * ‡∏£‡∏∞‡∏ö‡∏ö‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏î‡πÇ‡∏° ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ö‡∏ô‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ ‡πÇ‡∏î‡∏¢‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô <strong>localStorage</strong> ‡πÑ‡∏î‡πâ‡πÅ‡∏Å‡πà
            fas-users, fas-requests, fas-session, fas-login-stats
          </p>
        </div>

        <div class="card">
          <h3>üìà ‡∏™‡∏£‡∏∏‡∏õ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô (Usage Summary ‚Äì this browser)</h3>
          <p class="muted">
            ‡πÉ‡∏ä‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏°‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÉ‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ô‡∏µ‡πâ ‡πÄ‡∏ä‡πà‡∏ô ‡∏û‡∏¢‡∏≤‡∏¢‡∏≤‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡πÅ‡∏•‡πâ‡∏ß‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏´‡∏•‡∏≤‡∏¢‡∏Ñ‡∏£‡∏±‡πâ‡∏á
            ‡∏≠‡∏≤‡∏à‡∏™‡∏∞‡∏ó‡πâ‡∏≠‡∏ô‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏∞‡∏ö‡∏ö
          </p>
          <ul class="muted" style="padding-left:16px; margin-top:6px;">
            <li><strong>‡∏ú‡πà‡∏≤‡∏ô (Successful)</strong> ‚Äî ‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏à‡∏£‡∏¥‡∏á (Email &amp; Password ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ‡πÅ‡∏•‡∏∞ Approved)</li>
            <li><strong>‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô (Failed)</strong> ‚Äî ‡πÄ‡∏ä‡πà‡∏ô ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ, ‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥, ‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á, ‡πÑ‡∏°‡πà‡∏ï‡∏¥‡πä‡∏Å Human</li>
            <li><strong>‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (Total)</strong> ‚Äî ‡∏£‡∏ß‡∏°‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà‡∏û‡∏¢‡∏≤‡∏¢‡∏≤‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</li>
          </ul>
          <p class="muted" style="margin-top:6px;">
            * ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏•‡πâ‡∏≤‡∏á‡∏Ñ‡πà‡∏≤‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡πÑ‡∏î‡πâ‡πÇ‡∏î‡∏¢‡∏•‡∏ö localStorage ‡∏´‡∏£‡∏∑‡∏≠ Clear Site Data ‡πÉ‡∏ô‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå
          </p>
        </div>
      </div>

      <!-- ‡πÅ‡∏ñ‡∏ß‡∏•‡πà‡∏≤‡∏á: Register / Forgot / Change -->
      <div id="register-section" class="grid-3">
        <!-- Register -->
        <div class="card">
          <h3>üìù ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà (User Registration)</h3>
          <p class="muted">
            ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏´‡∏±‡∏™ ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏Ç‡∏≠‡πÑ‡∏õ‡∏¢‡∏±‡∏á Admin ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥ (Send request to Admin for approval)
            ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÅ‡∏•‡πâ‡∏ß‡∏à‡∏∂‡∏á‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ Login ‡πÑ‡∏î‡πâ
          </p>
          <form id="registerForm">
            <div class="inline-row">
              <div>
                <label for="regFirstName">‡∏ä‡∏∑‡πà‡∏≠ (First Name)</label>
                <input type="text" id="regFirstName" required>
              </div>
              <div>
                <label for="regLastName">‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• (Last Name)</label>
                <input type="text" id="regLastName" required>
              </div>
            </div>

            <label for="regCitizenId">‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô (Citizen ID)</label>
            <input type="text" id="regCitizenId" maxlength="13" required>

            <label for="regGovId">‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ï‡∏£‡∏Ç‡πâ‡∏≤‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£ (Government ID)</label>
            <input type="text" id="regGovId" required>

            <label for="regPosition">‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á (Position)</label>
            <input type="text" id="regPosition" required>

            <label for="regEmail">‡∏≠‡∏µ‡πÄ‡∏°‡∏• (Email)</label>
            <input type="email" id="regEmail" required>

            <label for="regPhone">‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠ (Phone)</label>
            <input type="tel" id="regPhone" required>

            <div class="inline-row">
              <div>
                <label for="regPassword">‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô (Password, ‚â• 8 chars)</label>
                <input type="password" id="regPassword" minlength="8" required>
              </div>
              <div>
                <label for="regPassword2">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô (Confirm Password)</label>
                <input type="password" id="regPassword2" minlength="8" required>
              </div>
            </div>

            <label>‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏°‡∏ô‡∏∏‡∏©‡∏¢‡πå (Human Verification ‚Äì Captcha)</label>
            <div class="captcha-box">
              <span id="regCaptcha" class="captcha-text"></span>
              <input type="text" id="regCaptchaInput" placeholder="‡∏Å‡∏£‡∏≠‡∏Å Captcha (Enter Captcha)" required>
              <span class="captcha-refresh" onclick="refreshAllCaptchas()">‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä (Refresh)</span>
            </div>

            <div style="margin-top:10px;">
              <button type="submit">‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏Ç‡∏≠‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô (Submit Registration Request)</button>
            </div>
            <div id="regMsg" class="msg"></div>
            <div class="status-badge status-pending" id="regStatusBadge" style="display:none;">
              ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: ‡∏£‡∏≠‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡∏à‡∏≤‡∏Å Admin (Pending Approval)
            </div>
          </form>
        </div>

        <!-- Forgot password -->
        <div class="card">
          <h3>‚ùì ‡∏•‡∏∑‡∏°‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô (Forgot Password)</h3>
          <p class="muted">
            ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡∏ó‡∏µ‡πà‡∏•‡∏∑‡∏°‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏Ç‡∏≠‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÉ‡∏´‡πâ Admin ‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤ ‡∏Å‡πà‡∏≠‡∏ô‡∏à‡∏∂‡∏á‡∏à‡∏∞‡πÉ‡∏ä‡πâ‡∏£‡∏´‡∏±‡∏™‡πÉ‡∏´‡∏°‡πà‡πÑ‡∏î‡πâ
            (Reset request will be reviewed by Admin)
          </p>
          <form id="forgotForm">
            <label for="forgotEmail">‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô (Registered Email)</label>
            <input type="email" id="forgotEmail" required>

            <label for="forgotCitizenId">‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô (Citizen ID)</label>
            <input type="text" id="forgotCitizenId" maxlength="13" required>

            <label for="forgotGovId">‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ï‡∏£‡∏Ç‡πâ‡∏≤‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£ (Government ID)</label>
            <input type="text" id="forgotGovId" required>

            <div class="inline-row">
              <div>
                <label for="forgotNewPassword">‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà (New Password, ‚â• 8 chars)</label>
                <input type="password" id="forgotNewPassword" minlength="8" required>
              </div>
              <div>
                <label for="forgotNewPassword2">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏£‡∏´‡∏±‡∏™‡πÉ‡∏´‡∏°‡πà (Confirm New Password)</label>
                <input type="password" id="forgotNewPassword2" minlength="8" required>
              </div>
            </div>

            <label>‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏°‡∏ô‡∏∏‡∏©‡∏¢‡πå (Human Verification ‚Äì Captcha)</label>
            <div class="captcha-box">
              <span id="forgotCaptcha" class="captcha-text"></span>
              <input type="text" id="forgotCaptchaInput" placeholder="‡∏Å‡∏£‡∏≠‡∏Å Captcha (Enter Captcha)" required>
              <span class="captcha-refresh" onclick="refreshAllCaptchas()">‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä (Refresh)</span>
            </div>

            <div style="margin-top:10px;">
              <button type="submit">‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏Ç‡∏≠‡∏•‡∏∑‡∏°‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô (Submit Forgot Password Request)</button>
            </div>
            <div id="forgotMsg" class="msg"></div>
          </form>
        </div>

        <!-- Change password -->
        <div class="card">
          <h3>üîÅ ‡∏Ç‡∏≠‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô (Change Password)</h3>
          <p class="muted">
            ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡∏à‡∏≥‡∏£‡∏´‡∏±‡∏™‡πÄ‡∏î‡∏¥‡∏°‡πÑ‡∏î‡πâ ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏´‡∏±‡∏™‡πÉ‡∏´‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ ‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏£‡∏≠‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥
            (Change password immediately if you know the old one)
          </p>
          <form id="changeForm">
            <label for="changeEmail">‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô (Registered Email)</label>
            <input type="email" id="changeEmail" required>

            <label for="changeOldPassword">‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÄ‡∏î‡∏¥‡∏° (Old Password)</label>
            <input type="password" id="changeOldPassword" required>

            <div class="inline-row">
              <div>
                <label for="changeNewPassword">‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà (New Password, ‚â• 8 chars)</label>
                <input type="password" id="changeNewPassword" minlength="8" required>
              </div>
              <div>
                <label for="changeNewPassword2">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏£‡∏´‡∏±‡∏™‡πÉ‡∏´‡∏°‡πà (Confirm New Password)</label>
                <input type="password" id="changeNewPassword2" minlength="8" required>
              </div>
            </div>

            <label>‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏°‡∏ô‡∏∏‡∏©‡∏¢‡πå (Human Verification ‚Äì Captcha)</label>
            <div class="captcha-box">
              <span id="changeCaptcha" class="captcha-text"></span>
              <input type="text" id="changeCaptchaInput" placeholder="‡∏Å‡∏£‡∏≠‡∏Å Captcha (Enter Captcha)" required>
              <span class="captcha-refresh" onclick="refreshAllCaptchas()">‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä (Refresh)</span>
            </div>

            <div style="margin-top:10px;">
              <button type="submit">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô (Save New Password)</button>
            </div>
            <div id="changeMsg" class="msg"></div>
          </form>
        </div>
      </div>
    </div>
  </main>

  <footer>
    <div class="container">
      <div>¬© 2025 Financial Audit ‚Ä¢ ‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏ú‡πà‡∏ô‡∏î‡∏¥‡∏ô (Office of the Auditor General of Thailand)</div>
      <div>Login system demo ‚Ä¢ LocalStorage only ‚Ä¢ ‡πÉ‡∏ä‡πâ‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏±‡∏ö index.html / admin.html</div>
    </div>
  </footer>

  <script>
    // ---------- ‡πÄ‡∏ß‡∏•‡∏≤‡πÑ‡∏ó‡∏¢ + ‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏© ----------
    function updateTimeBar(){
      const t = new Date();

      const thMonths = ["‡∏°.‡∏Ñ.","‡∏Å.‡∏û.","‡∏°‡∏µ.‡∏Ñ.","‡πÄ‡∏°.‡∏¢.","‡∏û.‡∏Ñ.","‡∏°‡∏¥.‡∏¢.","‡∏Å.‡∏Ñ.","‡∏™.‡∏Ñ.","‡∏Å.‡∏¢.","‡∏ï.‡∏Ñ.","‡∏û.‡∏¢.","‡∏ò.‡∏Ñ."];
      const enMonths = ["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];
      const enDays   = ["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];
      const thDays   = ["‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå","‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå","‡∏≠‡∏±‡∏á‡∏Ñ‡∏≤‡∏£","‡∏û‡∏∏‡∏ò","‡∏û‡∏§‡∏´‡∏±‡∏™","‡∏®‡∏∏‡∏Å‡∏£‡πå","‡πÄ‡∏™‡∏≤‡∏£‡πå"];

      const thai = `${thDays[t.getDay()]}‡∏ó‡∏µ‡πà ${t.getDate()} ${thMonths[t.getMonth()]} ${t.getFullYear()+543}`;
      const eng  = `${enDays[t.getDay()]} ${t.getDate()} ${enMonths[t.getMonth()]} ${t.getFullYear()}`;
      const time = t.toLocaleTimeString();

      const bar = document.getElementById("timeBar");
      if(bar){
        bar.textContent = `${thai} ‚Ä¢ ${eng} ‚Äî ${time}`;
      }
    }
    setInterval(updateTimeBar, 1000);
    updateTimeBar();

    // ---------- Captcha ----------
    function generateCaptchaString(){
      const chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*?";
      let out = "";
      for(let i=0;i<6;i++){
        out += chars.charAt(Math.floor(Math.random()*chars.length));
      }
      return out;
    }
    let regCaptchaCode   = "";
    let forgotCaptchaCode= "";
    let changeCaptchaCode= "";

    function refreshAllCaptchas(){
      regCaptchaCode   = generateCaptchaString();
      forgotCaptchaCode= generateCaptchaString();
      changeCaptchaCode= generateCaptchaString();

      const r = document.getElementById("regCaptcha");
      const f = document.getElementById("forgotCaptcha");
      const c = document.getElementById("changeCaptcha");
      if(r) r.textContent = regCaptchaCode;
      if(f) f.textContent = forgotCaptchaCode;
      if(c) c.textContent = changeCaptchaCode;
    }

    // ---------- Shared user storage ----------
    function loadUsersFromStorage(){
      try{
        const raw = localStorage.getItem("fas-users");
        if(!raw) return null;
        return JSON.parse(raw);
      }catch(e){
        console.warn("‡πÇ‡∏´‡∏•‡∏î fas-users ‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à", e);
        return null;
      }
    }
    function saveUsersToStorage(users){
      try{
        localStorage.setItem("fas-users", JSON.stringify(users));
      }catch(e){
        console.warn("‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å fas-users ‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à", e);
      }
    }

    function seedDefaultUsersIfNeeded(){
      const existing = loadUsersFromStorage();
      if(existing && Array.isArray(existing) && existing.length > 0){
        return existing;
      }
      const seed = [
        {
          id:"super-admin-1",
          firstName:"Apiphuthanadet",
          lastName:"SuperAdmin",
          fullname:"Apiphuthanadet SuperAdmin",
          citizenId:"",
          govId:"",
          position:"‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î (Super Admin)",
          email:"apipoooo@gmail.com",
          phone:"",
          password:"Apiphu17122558",
          status:"approved",
          role:"super_admin",
          createdAt:new Date().toISOString()
        },
        {
          id:"admin-1",
          firstName:"‡∏™‡∏°‡∏ä‡∏≤‡∏¢",
          lastName:"‡πÉ‡∏à‡∏î‡∏µ",
          fullname:"‡∏™‡∏°‡∏ä‡∏≤‡∏¢ ‡πÉ‡∏à‡∏î‡∏µ",
          citizenId:"",
          govId:"",
          position:"Admin ‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö",
          email:"somchai@example.com",
          phone:"",
          password:"12345678",
          status:"approved",
          role:"admin",
          createdAt:new Date().toISOString()
        },
        {
          id:"admin-2",
          firstName:"Admin",
          lastName:"One",
          fullname:"Admin1 ‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö",
          citizenId:"",
          govId:"",
          position:"Admin1",
          email:"admin1@example.com",
          phone:"",
          password:"admin001",
          status:"approved",
          role:"admin1",
          createdAt:new Date().toISOString()
        }
      ];
      saveUsersToStorage(seed);
      return seed;
    }

    function loadRequests(){
      try{
        const raw = localStorage.getItem("fas-requests");
        if(!raw) return [];
        return JSON.parse(raw);
      }catch(e){
        console.warn("‡πÇ‡∏´‡∏•‡∏î fas-requests ‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à", e);
        return [];
      }
    }
    function saveRequests(requests){
      try{
        localStorage.setItem("fas-requests", JSON.stringify(requests));
      }catch(e){
        console.warn("‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å fas-requests ‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à", e);
      }
    }

    // ---------- Login statistics ----------
    function loadLoginStats(){
      try{
        const raw = localStorage.getItem("fas-login-stats");
        if(!raw) return { successTotal:0, failTotal:0, lastUpdated:null };
        const obj = JSON.parse(raw);
        return {
          successTotal: obj.successTotal || 0,
          failTotal: obj.failTotal || 0,
          lastUpdated: obj.lastUpdated || null
        };
      }catch(e){
        console.warn("‡πÇ‡∏´‡∏•‡∏î fas-login-stats ‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à", e);
        return { successTotal:0, failTotal:0, lastUpdated:null };
      }
    }
    function saveLoginStats(stats){
      try{
        localStorage.setItem("fas-login-stats", JSON.stringify(stats));
      }catch(e){
        console.warn("‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å fas-login-stats ‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à", e);
      }
    }
    function formatDateTime(dtStr){
      if(!dtStr) return "-";
      try{
        const d = new Date(dtStr);
        if(isNaN(d.getTime())) return "-";
        const pad = n => (n<10 ? "0"+n : n);
        const yyyy = d.getFullYear();
        const mm = pad(d.getMonth()+1);
        const dd = pad(d.getDate());
        const hh = pad(d.getHours());
        const mi = pad(d.getMinutes());
        return `${dd}/${mm}/${yyyy} ${hh}:${mi} ‡∏ô.`;
      }catch(e){
        return "-";
      }
    }
    function renderLoginStats(){
      const stats = loadLoginStats();
      const succEl = document.getElementById("loginSuccessCount");
      const failEl = document.getElementById("loginFailCount");
      const totalEl = document.getElementById("loginTotalCount");
      const lastEl = document.getElementById("loginLastUpdate");
      const total = (stats.successTotal || 0) + (stats.failTotal || 0);

      if(succEl) succEl.textContent = stats.successTotal || 0;
      if(failEl) failEl.textContent = stats.failTotal || 0;
      if(totalEl) totalEl.textContent = total;
      if(lastEl) lastEl.textContent = formatDateTime(stats.lastUpdated);
    }
    function recordLoginResult(isSuccess){
      const stats = loadLoginStats();
      if(isSuccess){
        stats.successTotal = (stats.successTotal || 0) + 1;
      }else{
        stats.failTotal = (stats.failTotal || 0) + 1;
      }
      stats.lastUpdated = new Date().toISOString();
      saveLoginStats(stats);
      renderLoginStats();
    }

    // session: fas-session = { email, loginAt, expiresAt, remember }
    function saveSession(email, remember){
      const now = Date.now();
      const SIX_MONTHS_MS = 1000 * 60 * 60 * 24 * 180;
      const session = {
        email,
        loginAt: now,
        remember: !!remember,
        expiresAt: remember ? now + SIX_MONTHS_MS : now + 1000 * 60 * 60 * 4 // 4 ‡∏ä‡∏°. ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà remember
      };
      try{
        localStorage.setItem("fas-session", JSON.stringify(session));
      }catch(e){
        console.warn("‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å fas-session ‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à", e);
      }
    }

    function loadSession(){
      try{
        const raw = localStorage.getItem("fas-session");
        if(!raw) return null;
        const sess = JSON.parse(raw);
        if(sess.expiresAt && Date.now() > sess.expiresAt){
          localStorage.removeItem("fas-session");
          return null;
        }
        return sess;
      }catch(e){
        console.warn("‡πÇ‡∏´‡∏•‡∏î fas-session ‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à", e);
        return null;
      }
    }

    const store = {
      users: seedDefaultUsersIfNeeded(),
      requests: loadRequests(),
      currentUser: null
    };

    const existingSession = loadSession();
    if(existingSession){
      const u = store.users.find(x => x.email === existingSession.email);
      if(u){
        store.currentUser = u;
        const loginStatus = document.getElementById("loginStatus");
        if(loginStatus){
          loginStatus.style.display = "inline-block";
          loginStatus.classList.add("status-approved");
          loginStatus.textContent = `‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô‡πÅ‡∏•‡πâ‡∏ß‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö (Already logged in): ${u.fullname || u.email}`;
        }
      }
    }

    // initial render stats & captchas
    renderLoginStats();
    refreshAllCaptchas();

    // ---------- Login ----------
    const loginForm = document.getElementById("loginForm");
    if(loginForm){
      loginForm.addEventListener("submit", function(e){
        e.preventDefault();
        if(!confirm("‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÉ‡∏ä‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà? (Confirm Login)")) return;

        const email = document.getElementById("loginEmail").value.trim();
        const password = document.getElementById("loginPassword").value.trim();
        const remember = document.getElementById("rememberMe").checked;
        const isHuman = document.getElementById("loginHuman").checked;
        const msg = document.getElementById("loginMsg");
        const statusEl = document.getElementById("loginStatus");

        msg.textContent = "";
        msg.classList.remove("msg-error","msg-success");
        if(statusEl){
          statusEl.style.display = "none";
          statusEl.className = "status-badge";
        }

        if(!isHuman){
          msg.textContent = "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ß‡πà‡∏≤‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡∏´‡∏∏‡πà‡∏ô‡∏¢‡∏ô‡∏ï‡πå (Please confirm you are human)";
          msg.classList.add("msg-error");
          recordLoginResult(false);
          return;
        }

        const user = store.users.find(u => u.email === email);
        if(!user){
          msg.textContent = "‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö (User not found)";
          msg.classList.add("msg-error");
          recordLoginResult(false);
          return;
        }

        if(user.status !== "approved"){
          msg.textContent = "‚ö†Ô∏è ‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡∏à‡∏≤‡∏Å Admin (Account not yet approved)";
          msg.classList.add("msg-error");
          if(statusEl){
            statusEl.style.display = "inline-block";
            statusEl.classList.add("status-pending");
            statusEl.textContent = "‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ö‡∏±‡∏ç‡∏ä‡∏µ: pending (‡∏£‡∏≠‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥ / Pending approval)";
          }
          recordLoginResult(false);
          return;
        }

        if(user.password !== password){
          msg.textContent = "‚ùå ‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á (Incorrect password)";
          msg.classList.add("msg-error");
          recordLoginResult(false);
          return;
        }

        // ‡∏ú‡πà‡∏≤‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
        saveSession(user.email, remember);
        store.currentUser = user;
        msg.textContent = "‚úÖ ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å... (Login success, redirecting to Home)";
        msg.classList.add("msg-success");
        if(statusEl){
          statusEl.style.display = "inline-block";
          statusEl.classList.add("status-approved");
          statusEl.textContent =
            `‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏•‡πâ‡∏ß: ${user.fullname || user.email} ‚Ä¢ role: ${user.role}`;
        }

        recordLoginResult(true);

        setTimeout(() => {
          window.location.href = "index.html";
        }, 900);
      });
    }

    // ---------- Register ----------
    const registerForm = document.getElementById("registerForm");
    if(registerForm){
      registerForm.addEventListener("submit", function(e){
        e.preventDefault();
        if(!confirm("‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏Ç‡∏≠‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÉ‡∏ä‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà? (Confirm registration request)")) return;

        const firstName = document.getElementById("regFirstName").value.trim();
        const lastName = document.getElementById("regLastName").value.trim();
        const citizenId = document.getElementById("regCitizenId").value.trim();
        const govId = document.getElementById("regGovId").value.trim();
        const position = document.getElementById("regPosition").value.trim();
        const email = document.getElementById("regEmail").value.trim();
        const phone = document.getElementById("regPhone").value.trim();
        const password = document.getElementById("regPassword").value;
        const password2 = document.getElementById("regPassword2").value;
        const humanInput = document.getElementById("regCaptchaInput").value.trim();

        const msg = document.getElementById("regMsg");
        const badge = document.getElementById("regStatusBadge");

        msg.textContent = "";
        msg.classList.remove("msg-error","msg-success");
        badge.style.display = "none";

        if(!firstName || !lastName || !citizenId || !govId || !position || !email || !phone){
          msg.textContent = "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ó‡∏∏‡∏Å‡∏ä‡πà‡∏≠‡∏á (Please fill in all fields)";
          msg.classList.add("msg-error");
          return;
        }
        if(password.length < 8){
          msg.textContent = "‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 8 ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£ (Password must be at least 8 characters)";
          msg.classList.add("msg-error");
          return;
        }
        if(password !== password2){
          msg.textContent = "‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ô (Password and confirmation do not match)";
          msg.classList.add("msg-error");
          return;
        }
        if(humanInput !== regCaptchaCode){
          msg.textContent = "Captcha ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á (Captcha incorrect)";
          msg.classList.add("msg-error");
          refreshAllCaptchas();
          return;
        }
        if(store.users.some(u => u.email === email)){
          msg.textContent = "‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡∏ô‡∏µ‡πâ‡∏ñ‡∏π‡∏Å‡πÉ‡∏ä‡πâ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÅ‡∏•‡πâ‡∏ß (Email already registered)";
          msg.classList.add("msg-error");
          return;
        }

        const newUser = {
          id:"user-" + Date.now(),
          firstName,
          lastName,
          fullname: firstName + " " + lastName,
          citizenId,
          govId,
          position,
          email,
          phone,
          password,
          status:"pending",
          role:"user",
          createdAt:new Date().toISOString()
        };
        store.users.push(newUser);
        saveUsersToStorage(store.users);

        const req = {
          id:"req-" + Date.now(),
          type:"register",
          email,
          createdAt:new Date().toISOString(),
          status:"pending",
          payload:{
            firstName,lastName,citizenId,govId,position,phone
          }
        };
        store.requests.push(req);
        saveRequests(store.requests);

        msg.textContent =
          "‚úÖ ‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏Ç‡∏≠‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÅ‡∏•‡πâ‡∏ß (Registration request sent) ‚Ä¢ " +
          "‡πÇ‡∏õ‡∏£‡∏î‡∏£‡∏≠ Admin ‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥ ‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡∏´‡∏ô‡πâ‡∏≤ Login ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô (Wait for Admin approval, then come back to Login)";
        msg.classList.add("msg-success");
        badge.style.display = "inline-block";

        registerForm.reset();
        refreshAllCaptchas();
      });
    }

    // ---------- Forgot password ----------
    const forgotForm = document.getElementById("forgotForm");
    if(forgotForm){
      forgotForm.addEventListener("submit", function(e){
        e.preventDefault();
        if(!confirm("‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏Ç‡∏≠‡∏•‡∏∑‡∏°‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÉ‡∏ä‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà? (Confirm forgot password request)")) return;

        const email = document.getElementById("forgotEmail").value.trim();
        const citizenId = document.getElementById("forgotCitizenId").value.trim();
        const govId = document.getElementById("forgotGovId").value.trim();
        const newPw = document.getElementById("forgotNewPassword").value;
        const newPw2 = document.getElementById("forgotNewPassword2").value;
        const humanInput = document.getElementById("forgotCaptchaInput").value.trim();
        const msg = document.getElementById("forgotMsg");

        msg.textContent = "";
        msg.classList.remove("msg-error","msg-success");

        if(!email || !citizenId || !govId){
          msg.textContent = "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô (Please fill in all required fields)";
          msg.classList.add("msg-error");
          return;
        }
        if(newPw.length < 8){
          msg.textContent = "‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 8 ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£ (New password must be at least 8 characters)";
          msg.classList.add("msg-error");
          return;
        }
        if(newPw !== newPw2){
          msg.textContent = "‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ô (New password and confirmation do not match)";
          msg.classList.add("msg-error");
          return;
        }
        if(humanInput !== forgotCaptchaCode){
          msg.textContent = "Captcha ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á (Captcha incorrect)";
          msg.classList.add("msg-error");
          refreshAllCaptchas();
          return;
        }

        const user = store.users.find(u => u.email === email);
        if(!user){
          msg.textContent = "‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏ï‡∏≤‡∏°‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡∏ó‡∏µ‡πà‡∏£‡∏∞‡∏ö‡∏∏ (User not found for this email)";
          msg.classList.add("msg-error");
          return;
        }

        if(user.citizenId && user.citizenId !== citizenId){
          msg.textContent = "‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö (Citizen ID mismatch)";
          msg.classList.add("msg-error");
          return;
        }
        if(user.govId && user.govId !== govId){
          msg.textContent = "‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ï‡∏£‡∏Ç‡πâ‡∏≤‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö (Government ID mismatch)";
          msg.classList.add("msg-error");
          return;
        }

        const req = {
          id:"req-reset-" + Date.now(),
          type:"reset-password",
          email,
          createdAt:new Date().toISOString(),
          status:"pending",
          requestedPassword:newPw
        };
        store.requests.push(req);
        saveRequests(store.requests);

        msg.textContent =
          "‚úÖ ‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏Ç‡∏≠‡∏•‡∏∑‡∏°‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß (Forgot password request sent) ‚Ä¢ " +
          "‡∏£‡∏≠ Admin ‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÅ‡∏•‡∏∞‡∏ï‡∏±‡πâ‡∏á‡∏£‡∏´‡∏±‡∏™‡πÉ‡∏´‡∏°‡πà‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö (Wait for Admin to approve & set new password)";
        msg.classList.add("msg-success");
        forgotForm.reset();
        refreshAllCaptchas();
      });
    }

    // ---------- Change password ----------
    const changeForm = document.getElementById("changeForm");
    if(changeForm){
      changeForm.addEventListener("submit", function(e){
        e.preventDefault();
        if(!confirm("‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÉ‡∏ä‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà? (Confirm change password)")) return;

        const email = document.getElementById("changeEmail").value.trim();
        const oldPw = document.getElementById("changeOldPassword").value;
        const newPw = document.getElementById("changeNewPassword").value;
        const newPw2 = document.getElementById("changeNewPassword2").value;
        const humanInput = document.getElementById("changeCaptchaInput").value.trim();
        const msg = document.getElementById("changeMsg");

        msg.textContent = "";
        msg.classList.remove("msg-error","msg-success");

        if(!email || !oldPw || !newPw || !newPw2){
          msg.textContent = "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô (Please fill in all fields)";
          msg.classList.add("msg-error");
          return;
        }
        if(newPw.length < 8){
          msg.textContent = "‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 8 ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£ (New password must be at least 8 characters)";
          msg.classList.add("msg-error");
          return;
        }
        if(newPw !== newPw2){
          msg.textContent = "‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ô (New password and confirmation do not match)";
          msg.classList.add("msg-error");
          return;
        }
        if(humanInput !== changeCaptchaCode){
          msg.textContent = "Captcha ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á (Captcha incorrect)";
          msg.classList.add("msg-error");
          refreshAllCaptchas();
          return;
        }

        const user = store.users.find(u => u.email === email);
        if(!user){
          msg.textContent = "‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö (User not found)";
          msg.classList.add("msg-error");
          return;
        }
        if(user.password !== oldPw){
          msg.textContent = "‚ùå ‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÄ‡∏î‡∏¥‡∏°‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á (Old password incorrect)";
          msg.classList.add("msg-error");
          return;
        }

        user.password = newPw;
        saveUsersToStorage(store.users);

        const sess = loadSession();
        if(sess && sess.email === email){
          saveSession(email, sess.remember);
        }

        msg.textContent = "‚úÖ ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß (Password changed successfully)";
        msg.classList.add("msg-success");
        changeForm.reset();
        refreshAllCaptchas();
      });
    }
  </script>
</body>
</html>
