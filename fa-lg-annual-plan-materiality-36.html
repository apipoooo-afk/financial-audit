<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>FA ‚Äì LG Annual | ‡∏ü‡∏≠‡∏£‡πå‡∏° 3.6 ‚Äì Specific Materiality ‡∏ï‡∏≤‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <style>
    :root{
      --bg:#060818;
      --card:#11152b;
      --border:#262b46;
      --accent:#42a5f5;
      --accent2:#26c6da;
      --muted:#a3acc7;
      --text:#f5f7ff;
      --pink:#f48fb1;
    }
    *{box-sizing:border-box;}

    body{
      margin:0;
      font-family:"Segoe UI", Tahoma, sans-serif;
      background:
        radial-gradient(circle at 10% 0%, rgba(123,30,60,0.36) 0, transparent 55%),
        radial-gradient(circle at 90% 100%, rgba(66,165,245,0.32) 0, transparent 55%),
        radial-gradient(circle at 0% 100%, rgba(38,198,218,0.22) 0, transparent 55%),
        var(--bg);
      color:var(--text);
      min-height:100vh;
      font-size:140%;
    }

    header{
      padding:16px 10px 12px;
      text-align:center;
      background:linear-gradient(120deg,#0d47a1,#42a5f5,#26c6da);
      box-shadow:0 4px 16px rgba(0,0,0,0.7);
      position:sticky;
      top:0;
      z-index:20;
    }
    header h2{ margin:0; font-size:20px; }
    header .sub{ font-size:13px; opacity:.9; }

    main{
      max-width:1100px;
      margin:20px auto 28px;
      padding:0 16px 20px;
    }

    .nav-top{
      display:flex;
      gap:8px;
      flex-wrap:wrap;
      margin-bottom:14px;
    }
    .btn-nav{
      padding:6px 12px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,0.45);
      background:rgba(0,0,0,0.35);
      color:#fff;
      font-size:12px;
      text-decoration:none;
      display:inline-flex;
      align-items:center;
      gap:6px;
    }
    .btn-nav:hover{ background:rgba(0,0,0,0.6); }

    .card{
      background:var(--card);
      border-radius:18px;
      border:1px solid rgba(255,255,255,0.12);
      padding:16px 14px 16px;
      box-shadow:0 10px 30px rgba(0,0,0,0.9);
      margin-bottom:16px;
    }
    .card-header{
      display:flex;
      justify-content:space-between;
      gap:10px;
      align-items:flex-start;
      margin-bottom:10px;
    }
    .card-title{
      font-size:16px;
      font-weight:600;
    }
    .card-sub{
      font-size:12px;
      color:var(--muted);
    }
    .chip{
      padding:4px 10px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,0.2);
      font-size:11px;
      background:rgba(0,0,0,0.35);
      white-space:nowrap;
    }

    .form-grid{
      display:grid;
      grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
      gap:10px 14px;
      margin-top:4px;
    }

    label{
      font-size:12px;
      display:block;
      margin-bottom:2px;
      color:#e3f2fd;
    }
    .input, select, textarea{
      width:100%;
      padding:6px 8px;
      border-radius:10px;
      border:1px solid var(--border);
      background:#080c1b;
      color:var(--text);
      font-size:12px;
    }
    textarea{
      min-height:80px;
      resize:vertical;
    }
    .input:focus, select:focus, textarea:focus{
      outline:none;
      border-color:var(--accent2);
      box-shadow:0 0 0 1px rgba(38,198,218,0.5);
    }

    .section-title{
      font-size:14px;
      font-weight:600;
      margin:10px 0 6px;
    }
    .hint{
      font-size:11px;
      color:var(--muted);
      margin-bottom:6px;
    }

    .btn-row{
      display:flex;
      flex-wrap:wrap;
      gap:8px;
      margin-top:10px;
    }
    .btn{
      padding:6px 12px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,0.4);
      background:rgba(0,0,0,0.4);
      color:#fff;
      font-size:12px;
      cursor:pointer;
    }
    .btn-primary{
      border-color:var(--accent);
      background:linear-gradient(120deg,#0d47a1,#42a5f5);
    }
    .btn-danger{
      border-color:#f44336;
      background:linear-gradient(120deg,#b71c1c,#f44336);
    }
    .btn:hover{
      background:rgba(0,0,0,0.7);
    }
    .btn-primary:hover,
    .btn-danger:hover{
      filter:brightness(1.1);
    }

    .footer-note{
      font-size:10px;
      color:var(--muted);
      margin-top:6px;
    }

    /* ‡∏ï‡∏≤‡∏£‡∏≤‡∏á Specific Materiality (‡∏ö‡∏ô‡∏à‡∏≠) */
    .sm-table-wrapper{
      overflow-x:auto;
      margin-top:4px;
    }
    .sm-table{
      width:100%;
      border-collapse:collapse;
      font-size:11px;
    }
    .sm-table th,
    .sm-table td{
      border:1px solid rgba(255,255,255,0.18);
      padding:4px 4px;
      vertical-align:top;
    }
    .sm-table th{
      background:#0b1024;
      font-weight:600;
    }
    .sm-id{
      text-align:center;
      font-weight:600;
    }
    .num-input{
      width:100%;
      padding:4px 6px;
      border-radius:8px;
      border:1px solid var(--border);
      background:#050816;
      color:var(--text);
      font-size:11px;
      text-align:right;
    }

    /* ---------- A4 PREVIEW ---------- */
    .a4-wrapper{
      margin-top:18px;
    }

    .a4-title{
      font-size:14px;
      font-weight:600;
      margin-bottom:6px;
    }

    .a4-page{
      width:210mm;
      min-height:297mm;
      margin:0 auto 16px;
      background:#ffffff;
      color:#000000;
      box-shadow:0 0 8px rgba(0,0,0,0.5);
      padding:12mm;
      font-size:11pt;
      position:relative;
    }

    .a4-header-center{
      text-align:center;
      margin-bottom:6px;
      font-size:12pt;
      font-weight:600;
    }
    .a4-subheader{
      text-align:center;
      font-size:10pt;
      margin-bottom:8px;
    }
    .a4-row{
      display:flex;
      justify-content:space-between;
      font-size:10pt;
      margin-bottom:4px;
    }
    .a4-row span{
      display:inline-block;
      min-width:80px;
    }
    .a4-row .value{
      border-bottom:1px solid #000;
      min-width:160px;
      display:inline-block;
      padding:0 2px;
    }

    .a4-table{
      width:100%;
      border-collapse:collapse;
      margin-top:8px;
      font-size:10pt;
    }
    .a4-table th,
    .a4-table td{
      border:1px solid #000;
      padding:4px 4px;
      vertical-align:top;
    }
    .a4-table th{
      text-align:center;
      font-weight:600;
    }

    .a4-sign-row{
      margin-top:40px;
      display:flex;
      justify-content:space-between;
      font-size:10pt;
    }
    .a4-sign-block{
      width:45%;
      text-align:center;
    }
    .a4-sign-line{
      border-bottom:1px solid #000;
      margin:18px 0 2px;
      height:0;
    }

    .a4-footer{
      position:absolute;
      bottom:8mm;
      left:12mm;
      right:12mm;
      font-size:8pt;
      display:flex;
      justify-content:space-between;
    }

    /* PRINT */
    @page{
      size:A4;
      margin:12mm;
    }
    @media print{
      body{
        background:#ffffff;
        color:#000000;
        font-size:11pt;
      }
      header,
      .nav-top,
      .card:not(.card-a4),
      .no-print{
        display:none !important;
      }
      .a4-page{
        box-shadow:none;
        margin:0;
        width:auto;
        min-height:auto;
        padding:0;
      }
      main{
        max-width:100%;
        margin:0;
        padding:0;
      }
    }

    @media (max-width:900px){
      .a4-page{
        width:100%;
        min-height:auto;
      }
    }

    @media (max-width:600px){
      .card-header{
        flex-direction:column;
        align-items:flex-start;
      }
    }
  </style>
</head>
<body>

<header>
  <h2>üìä ‡∏ü‡∏≠‡∏£‡πå‡∏° 3.6 ‚Äì Specific Materiality ‡∏ï‡∏≤‡∏°‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ / ‡∏¢‡∏≠‡∏î‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠</h2>
  <div class="sub">
    Form 3.6 ‚Äì Specific Materiality by Class of Transactions / Balances | FA ‚Äì Local Government (Annual)
  </div>
</header>

<main>

  <div class="nav-top">
    <a href="fa-lg-annual-plan.html" class="btn-nav">
      <span>‚Ü©</span> ‡∏Å‡∏•‡∏±‡∏ö‡πÄ‡∏°‡∏ô‡∏π‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏Å‡∏≤‡∏£‡∏ß‡∏≤‡∏á‡πÅ‡∏ú‡∏ô
    </a>
    <a href="fa-lg-annual.html" class="btn-nav">
      <span>üìÖ</span> ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏µ / ‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏£‡∏±‡∏ö‡∏ï‡∏£‡∏ß‡∏à
    </a>
    <a href="fa-menu.html" class="btn-nav">
      <span>üìÇ</span> FA Main Menu
    </a>
    <a href="index.html" class="btn-nav">
      <span>üè†</span> ‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å‡∏£‡∏∞‡∏ö‡∏ö
    </a>
  </div>

  <!-- CARD 1: Digital Form -->
  <section class="card">
    <div class="card-header">
      <div>
        <div class="card-title">‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 1 ‚Äì ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô ‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏Å‡∏≥‡∏´‡∏ô‡∏î Specific Materiality</div>
        <div class="card-sub">
          ‡∏£‡∏∞‡∏ö‡∏∏‡∏õ‡∏µ ‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏£‡∏±‡∏ö‡∏ï‡∏£‡∏ß‡∏à ‡πÅ‡∏•‡∏∞‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏™‡∏≤‡∏£‡∏∞‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ / ‡∏¢‡∏≠‡∏î‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠
        </div>
      </div>
      <div class="chip">Digital Form ‚Ä¢ Specific Materiality</div>
    </div>

    <div class="form-grid">
      <div>
        <label for="fy">‡∏õ‡∏µ‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì</label>
        <select id="fy" class="input">
          <option value="">‚Äî ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏µ‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì ‚Äî</option>
          <option>2567</option>
          <option>2568</option>
          <option>2569</option>
        </select>
      </div>
      <div>
        <label for="auditee">‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏£‡∏±‡∏ö‡∏ï‡∏£‡∏ß‡∏à (‡∏≠‡∏õ‡∏ó.)</label>
        <input id="auditee" class="input" type="text" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡πÄ‡∏ó‡∏®‡∏ö‡∏≤‡∏•‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á">
      </div>
      <div>
        <label for="amphoe">‡∏≠‡∏≥‡πÄ‡∏†‡∏≠</label>
        <input id="amphoe" class="input" type="text" placeholder="‡∏≠‡∏≥‡πÄ‡∏†‡∏≠">
      </div>
      <div>
        <label for="province">‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î</label>
        <input id="province" class="input" type="text" placeholder="‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î">
      </div>
      <div>
        <label for="preparedBy">‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏ó‡∏≥</label>
        <input id="preparedBy" class="input" type="text" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏ó‡∏≥‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°">
      </div>
      <div>
        <label for="reviewedBy">‡∏ú‡∏π‡πâ‡∏™‡∏≠‡∏ö‡∏ó‡∏≤‡∏ô</label>
        <input id="reviewedBy" class="input" type="text" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏™‡∏≠‡∏ö‡∏ó‡∏≤‡∏ô / ‡∏ú‡∏ï‡∏à.">
      </div>
    </div>

    <div class="section-title">1.2 ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏à‡∏≤‡∏Å‡∏ü‡∏≠‡∏£‡πå‡∏° 3.5 (OM / PM) ‡πÅ‡∏•‡∏∞‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏</div>
    <div class="form-grid">
      <div>
        <label for="refOm">OM ‡∏ï‡∏≤‡∏°‡∏ü‡∏≠‡∏£‡πå‡∏° 3.5 (‡∏ö‡∏≤‡∏ó)</label>
        <input id="refOm" class="input" type="text" placeholder="‡πÄ‡∏ä‡πà‡∏ô 1,000,000.00">
      </div>
      <div>
        <label for="refPm">PM ‡∏ï‡∏≤‡∏°‡∏ü‡∏≠‡∏£‡πå‡∏° 3.5 (‡∏ö‡∏≤‡∏ó)</label>
        <input id="refPm" class="input" type="text" placeholder="‡πÄ‡∏ä‡πà‡∏ô 750,000.00">
      </div>
      <div>
        <label for="refNote">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°</label>
        <input id="refNote" class="input" type="text" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡πÉ‡∏ä‡πâ PM ‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏£‡∏≠‡∏ö‡∏ï‡∏±‡πâ‡∏á Specific Materiality">
      </div>
    </div>

    <div class="section-title">1.3 ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Å‡∏≥‡∏´‡∏ô‡∏î Specific Materiality ‡∏ï‡∏≤‡∏°‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</div>
    <div class="hint">
      ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó: ‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ, ‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢, ‡∏™‡∏¥‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏ñ‡∏≤‡∏ß‡∏£, ‡∏•‡∏π‡∏Å‡∏´‡∏ô‡∏µ‡πâ-‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡∏µ‡πâ, ‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î ‡πÅ‡∏•‡∏∞‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏≠‡∏∑‡πà‡∏ô ‡πÜ  
      ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏õ‡∏£‡∏±‡∏ö‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠/‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÅ‡∏ñ‡∏ß‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏° Excel ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÉ‡∏ô‡∏Ç‡∏±‡πâ‡∏ô‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏£‡∏∞‡∏ö‡∏ö
    </div>

    <div class="sm-table-wrapper">
      <table class="sm-table" id="smTable">
        <thead>
        <tr>
          <th style="width:4%;">#</th>
          <th style="width:20%;">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ / ‡∏¢‡∏≠‡∏î‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠</th>
          <th style="width:12%;">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ê‡∏≤‡∏ô (‡∏ö‡∏≤‡∏ó)</th>
          <th style="width:12%;">% ‡∏Ç‡∏≠‡∏á OM / PM</th>
          <th style="width:16%;">Specific Materiality (‡∏ö‡∏≤‡∏ó)</th>
          <th>‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•/‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏Å‡∏≥‡∏´‡∏ô‡∏î</th>
        </tr>
        </thead>
        <tbody>
        <!-- Row 1: ‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ -->
        <tr data-row="1">
          <td class="sm-id">1</td>
          <td>
            <input id="smClass-1" class="input" type="text" value="‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏£‡∏ß‡∏°" />
          </td>
          <td>
            <input id="smBase-1" class="num-input" type="number" min="0" step="0.01" placeholder="‡πÄ‡∏ä‡πà‡∏ô 120000000" oninput="calcSmRow(1)">
          </td>
          <td>
            <input id="smPct-1" class="num-input" type="number" min="0" step="0.01" placeholder="%" oninput="calcSmRow(1)">
          </td>
          <td>
            <input id="smAmt-1" class="input" type="text" readonly placeholder="‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÉ‡∏´‡πâ">
          </td>
          <td>
            <textarea id="smReason-1" class="input" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏°‡∏µ‡∏ô‡∏±‡∏¢‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏™‡∏π‡∏á ‡∏à‡∏∂‡∏á‡πÉ‡∏ä‡πâ % ‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤ OM ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Ç‡πâ‡∏°‡∏Ç‡πâ‡∏ô‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö"></textarea>
          </td>
        </tr>

        <!-- Row 2: ‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢ -->
        <tr data-row="2">
          <td class="sm-id">2</td>
          <td>
            <input id="smClass-2" class="input" type="text" value="‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏£‡∏ß‡∏°" />
          </td>
          <td>
            <input id="smBase-2" class="num-input" type="number" min="0" step="0.01" oninput="calcSmRow(2)">
          </td>
          <td>
            <input id="smPct-2" class="num-input" type="number" min="0" step="0.01" oninput="calcSmRow(2)">
          </td>
          <td>
            <input id="smAmt-2" class="input" type="text" readonly>
          </td>
          <td>
            <textarea id="smReason-2" class="input" placeholder="‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏™‡∏≤‡∏£‡∏∞‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Ç‡∏≠‡∏á‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢"></textarea>
          </td>
        </tr>

        <!-- Row 3: ‡∏™‡∏¥‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏ñ‡∏≤‡∏ß‡∏£ -->
        <tr data-row="3">
          <td class="sm-id">3</td>
          <td>
            <input id="smClass-3" class="input" type="text" value="‡∏™‡∏¥‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏ñ‡∏≤‡∏ß‡∏£ / ‡∏Ñ‡∏£‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå / ‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£‡∏Å‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á" />
          </td>
          <td>
            <input id="smBase-3" class="num-input" type="number" min="0" step="0.01" oninput="calcSmRow(3)">
          </td>
          <td>
            <input id="smPct-3" class="num-input" type="number" min="0" step="0.01" oninput="calcSmRow(3)">
          </td>
          <td>
            <input id="smAmt-3" class="input" type="text" readonly>
          </td>
          <td>
            <textarea id="smReason-3" class="input" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏î‡πâ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏ã‡∏∑‡πâ‡∏≠‡∏à‡∏±‡∏î‡∏à‡πâ‡∏≤‡∏á / ‡∏á‡∏≤‡∏ô‡∏Å‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á ‡∏Ø‡∏•‡∏Ø"></textarea>
          </td>
        </tr>

        <!-- Row 4: ‡∏•‡∏π‡∏Å‡∏´‡∏ô‡∏µ‡πâ/‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡∏µ‡πâ -->
        <tr data-row="4">
          <td class="sm-id">4</td>
          <td>
            <input id="smClass-4" class="input" type="text" value="‡∏•‡∏π‡∏Å‡∏´‡∏ô‡∏µ‡πâ / ‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡∏µ‡πâ / ‡∏†‡∏≤‡∏£‡∏∞‡∏ú‡∏π‡∏Å‡∏û‡∏±‡∏ô" />
          </td>
          <td>
            <input id="smBase-4" class="num-input" type="number" min="0" step="0.01" oninput="calcSmRow(4)">
          </td>
          <td>
            <input id="smPct-4" class="num-input" type="number" min="0" step="0.01" oninput="calcSmRow(4)">
          </td>
          <td>
            <input id="smAmt-4" class="input" type="text" readonly>
          </td>
          <td>
            <textarea id="smReason-4" class="input" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÑ‡∏°‡πà‡πÅ‡∏ô‡πà‡∏ô‡∏≠‡∏ô‡∏Ç‡∏≠‡∏á‡∏¢‡∏≠‡∏î‡∏´‡∏ô‡∏µ‡πâ ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏™‡∏≥‡∏£‡∏≠‡∏á ‡∏Ø‡∏•‡∏Ø"></textarea>
          </td>
        </tr>

        <!-- Row 5: ‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î -->
        <tr data-row="5">
          <td class="sm-id">5</td>
          <td>
            <input id="smClass-5" class="input" type="text" value="‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡πÅ‡∏•‡∏∞‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡πà‡∏≤‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î" />
          </td>
          <td>
            <input id="smBase-5" class="num-input" type="number" min="0" step="0.01" oninput="calcSmRow(5)">
          </td>
          <td>
            <input id="smPct-5" class="num-input" type="number" min="0" step="0.01" oninput="calcSmRow(5)">
          </td>
          <td>
            <input id="smAmt-5" class="input" type="text" readonly>
          </td>
          <td>
            <textarea id="smReason-5" class="input" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏Å‡∏≤‡∏£‡∏¢‡∏±‡∏Å‡∏¢‡∏≠‡∏Å‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î ‡∏Ø‡∏•‡∏Ø"></textarea>
          </td>
        </tr>

        <!-- Row 6: ‡∏≠‡∏∑‡πà‡∏ô ‡πÜ -->
        <tr data-row="6">
          <td class="sm-id">6</td>
          <td>
            <input id="smClass-6" class="input" type="text" value="‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏≠‡∏∑‡πà‡∏ô ‡πÜ ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏ô‡∏±‡∏¢‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç" />
          </td>
          <td>
            <input id="smBase-6" class="num-input" type="number" min="0" step="0.01" oninput="calcSmRow(6)">
          </td>
          <td>
            <input id="smPct-6" class="num-input" type="number" min="0" step="0.01" oninput="calcSmRow(6)">
          </td>
          <td>
            <input id="smAmt-6" class="input" type="text" readonly>
          </td>
          <td>
            <textarea id="smReason-6" class="input" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Å‡∏¥‡∏à / ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏à‡∏±‡∏ö‡∏ï‡∏≤ ‡∏Ø‡∏•‡∏Ø"></textarea>
          </td>
        </tr>
        </tbody>
      </table>
    </div>

    <div class="btn-row no-print">
      <button type="button" class="btn btn-primary" onclick="calcAllSm()">‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì Specific Materiality ‡∏ó‡∏∏‡∏Å‡πÅ‡∏ñ‡∏ß</button>
      <button type="button" class="btn" onclick="pushToA4()">‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏° A4</button>
    </div>

    <div class="footer-note">
      * ‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏£‡∏¥‡∏á‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏û‡∏¥‡πà‡∏°/‡∏•‡∏î‡πÅ‡∏ñ‡∏ß‡πÅ‡∏ö‡∏ö Dynamic ‡πÅ‡∏•‡∏∞‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏Å‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏¢‡∏≠‡∏î‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏´‡∏£‡∏∑‡∏≠ Excel ‡πÑ‡∏î‡πâ
    </div>
  </section>

  <!-- CARD 2: A4 + Export -->
  <section class="card card-a4">
    <div class="card-header">
      <div>
        <div class="card-title">‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 2 ‚Äì ‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏° 3.6 ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏© A4 (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏û‡∏¥‡∏°‡∏û‡πå / Export)</div>
        <div class="card-sub">
          ‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏° A4 ‡∏à‡∏∞‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡πÅ‡∏ö‡∏ö‡∏î‡∏¥‡∏à‡∏¥‡∏ó‡∏±‡∏•‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô ‚Äî ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏û‡∏¥‡∏°‡∏û‡πå‡πÄ‡∏õ‡πá‡∏ô PDF (A4) ‡∏´‡∏£‡∏∑‡∏≠ Export ‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏ü‡∏•‡πå HTML / JSON ‡πÑ‡∏î‡πâ
        </div>
      </div>
      <div class="chip">A4 Layout ‚Ä¢ Export</div>
    </div>

    <div class="btn-row no-print">
      <button type="button" class="btn" onclick="pushToA4()">‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏° A4</button>
      <button type="button" class="btn btn-primary" onclick="window.print()">‡∏û‡∏¥‡∏°‡∏û‡πå / Export PDF (A4)</button>
      <button type="button" class="btn" onclick="exportA4Html()">Export ‡πÄ‡∏õ‡πá‡∏ô HTML (A4 ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏´‡∏ô‡πâ‡∏≤)</button>
      <button type="button" class="btn btn-danger" onclick="exportJson()">Export ‡πÄ‡∏õ‡πá‡∏ô JSON (‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°)</button>
    </div>

    <div class="a4-wrapper">
      <div class="a4-title">‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏© A4</div>

      <div class="a4-page" id="a4Page">
        <div class="a4-header-center">
          ‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏° 3.6 ‚Äì ‡∏Å‡∏≤‡∏£‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏°‡∏µ‡∏ô‡∏±‡∏¢‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á (Specific Materiality)
        </div>
        <div class="a4-subheader">
          ‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏ú‡πà‡∏ô‡∏î‡∏¥‡∏ô ‚Äì ‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô‡∏Ç‡∏≠‡∏á‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£‡∏õ‡∏Å‡∏Ñ‡∏£‡∏≠‡∏á‡∏™‡πà‡∏ß‡∏ô‡∏ó‡πâ‡∏≠‡∏á‡∏ñ‡∏¥‡πà‡∏ô
        </div>

        <div class="a4-row">
          <div>
            <span>‡∏õ‡∏µ‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì</span>
            <span class="value" id="a4Fy">&nbsp;</span>
          </div>
          <div>
            <span>‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏£‡∏±‡∏ö‡∏ï‡∏£‡∏ß‡∏à</span>
            <span class="value" id="a4Auditee">&nbsp;</span>
          </div>
        </div>
        <div class="a4-row">
          <div>
            <span>‡∏≠‡∏≥‡πÄ‡∏†‡∏≠</span>
            <span class="value" id="a4Amphoe">&nbsp;</span>
          </div>
          <div>
            <span>‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î</span>
            <span class="value" id="a4Province">&nbsp;</span>
          </div>
        </div>
        <div class="a4-row">
          <div>
            <span>‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏ó‡∏≥</span>
            <span class="value" id="a4PreparedBy">&nbsp;</span>
          </div>
          <div>
            <span>‡∏ú‡∏π‡πâ‡∏™‡∏≠‡∏ö‡∏ó‡∏≤‡∏ô</span>
            <span class="value" id="a4ReviewedBy">&nbsp;</span>
          </div>
        </div>

        <div style="margin-top:10px; font-size:10pt;">
          <strong>1. ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏à‡∏≤‡∏Å‡∏ü‡∏≠‡∏£‡πå‡∏° 3.5</strong>
        </div>
        <div class="a4-row">
          <div>
            <span>OM (‡∏ö‡∏≤‡∏ó)</span>
            <span class="value" id="a4RefOm">&nbsp;</span>
          </div>
          <div>
            <span>PM (‡∏ö‡∏≤‡∏ó)</span>
            <span class="value" id="a4RefPm">&nbsp;</span>
          </div>
        </div>
        <div class="a4-row">
          <div style="flex:1;">
            <span>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏</span>
            <span class="value" id="a4RefNote">&nbsp;</span>
          </div>
        </div>

        <div style="margin-top:10px; font-size:10pt;">
          <strong>2. ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Å‡∏≥‡∏´‡∏ô‡∏î Specific Materiality ‡∏ï‡∏≤‡∏°‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ / ‡∏¢‡∏≠‡∏î‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠</strong>
        </div>

        <table class="a4-table" id="a4SmTable">
          <thead>
          <tr>
            <th style="width:4%;">#</th>
            <th style="width:23%;">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ / ‡∏¢‡∏≠‡∏î‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠</th>
            <th style="width:16%;">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ê‡∏≤‡∏ô (‡∏ö‡∏≤‡∏ó)</th>
            <th style="width:12%;">% ‡∏Ç‡∏≠‡∏á OM / PM</th>
            <th style="width:20%;">Specific Materiality (‡∏ö‡∏≤‡∏ó)</th>
            <th>‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•/‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏Å‡∏≥‡∏´‡∏ô‡∏î</th>
          </tr>
          </thead>
          <tbody>
          <!-- ‡πÅ‡∏ñ‡∏ß‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÄ‡∏ï‡∏¥‡∏°‡∏à‡∏≤‡∏Å pushToA4() -->
          </tbody>
        </table>

        <div style="margin-top:12px; font-size:10pt;">
          <strong>3. ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°</strong>
        </div>
        <div style="font-size:10pt; margin-top:4px;">
          - Specific Materiality ‡πÉ‡∏ô‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ñ‡∏π‡∏Å‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÇ‡∏î‡∏¢‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏ï‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô ‡πÅ‡∏•‡∏∞ OM / PM ‡∏£‡∏ß‡∏°<br>
          - ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏î‡∏±‡∏á‡∏Å‡∏•‡πà‡∏≤‡∏ß‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÉ‡∏ä‡πâ‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡∏Ç‡∏ô‡∏≤‡∏î‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏©‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö
        </div>

        <div class="a4-sign-row">
          <div class="a4-sign-block">
            ‡∏•‡∏á‡∏ä‡∏∑‡πà‡∏≠
            <div class="a4-sign-line"></div>
            (.......................................................)<br>
            ‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏ó‡∏≥
          </div>
          <div class="a4-sign-block">
            ‡∏•‡∏á‡∏ä‡∏∑‡πà‡∏≠
            <div class="a4-sign-line"></div>
            (.......................................................)<br>
            ‡∏ú‡∏π‡πâ‡∏™‡∏≠‡∏ö‡∏ó‡∏≤‡∏ô / ‡∏ú‡∏ï‡∏à.
          </div>
        </div>

        <div class="a4-footer">
          <div>‡∏ü‡∏≠‡∏£‡πå‡∏° 3.6 ‚Äì Specific Materiality</div>
          <div id="a4FooterMeta">‡∏û‡∏¥‡∏°‡∏û‡πå‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö FA ‚Äì LG</div>
        </div>
      </div>
    </div>
  </section>

</main>

<script>
  function formatNumber(num){
    if(num === null || num === undefined || isNaN(num)) return '';
    return num.toLocaleString('th-TH', {minimumFractionDigits:2, maximumFractionDigits:2});
  }

  function calcSmRow(rowId){
    const baseEl = document.getElementById('smBase-'+rowId);
    const pctEl  = document.getElementById('smPct-'+rowId);
    const amtEl  = document.getElementById('smAmt-'+rowId);
    if(!baseEl || !pctEl || !amtEl) return;

    const base = parseFloat(baseEl.value || '0');
    const pct  = parseFloat(pctEl.value || '0');

    if(base <= 0 || pct <= 0){
      amtEl.value = '';
      return;
    }
    const amt = base * (pct/100);
    amtEl.value = formatNumber(amt);
  }

  function calcAllSm(){
    for(let r=1;r<=6;r++){
      calcSmRow(r);
    }
  }

  function pushToA4(){
    // ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ
    document.getElementById('a4Fy').textContent        = document.getElementById('fy').value || '';
    document.getElementById('a4Auditee').textContent   = document.getElementById('auditee').value || '';
    document.getElementById('a4Amphoe').textContent    = document.getElementById('amphoe').value || '';
    document.getElementById('a4Province').textContent  = document.getElementById('province').value || '';
    document.getElementById('a4PreparedBy').textContent= document.getElementById('preparedBy').value || '';
    document.getElementById('a4ReviewedBy').textContent= document.getElementById('reviewedBy').value || '';

    // ‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á OM / PM
    document.getElementById('a4RefOm').textContent   = document.getElementById('refOm').value || '';
    document.getElementById('a4RefPm').textContent   = document.getElementById('refPm').value || '';
    document.getElementById('a4RefNote').textContent = document.getElementById('refNote').value || '';

    // ‡πÄ‡∏ï‡∏¥‡∏°‡∏ï‡∏≤‡∏£‡∏≤‡∏á Specific Materiality
    const tbody = document.querySelector('#a4SmTable tbody');
    if(!tbody) return;
    tbody.innerHTML = '';

    for(let r=1;r<=6;r++){
      const cls   = document.getElementById('smClass-'+r)?.value || '';
      const base  = parseFloat(document.getElementById('smBase-'+r)?.value || '0');
      const pct   = document.getElementById('smPct-'+r)?.value || '';
      const amt   = document.getElementById('smAmt-'+r)?.value || '';
      const reason= document.getElementById('smReason-'+r)?.value || '';

      if(!cls && !base && !pct && !amt && !reason){
        continue; // ‡∏Ç‡πâ‡∏≤‡∏°‡πÅ‡∏ñ‡∏ß‡∏ß‡πà‡∏≤‡∏á
      }

      const tr = document.createElement('tr');

      const td1 = document.createElement('td');
      td1.textContent = r.toString();
      td1.style.textAlign = 'center';

      const td2 = document.createElement('td');
      td2.textContent = cls;

      const td3 = document.createElement('td');
      td3.style.textAlign = 'right';
      td3.textContent = base ? formatNumber(base) : '';

      const td4 = document.createElement('td');
      td4.style.textAlign = 'center';
      td4.textContent = pct ? pct + ' %' : '';

      const td5 = document.createElement('td');
      td5.style.textAlign = 'right';
      td5.textContent = amt || '';

      const td6 = document.createElement('td');
      td6.textContent = reason;

      tr.appendChild(td1);
      tr.appendChild(td2);
      tr.appendChild(td3);
      tr.appendChild(td4);
      tr.appendChild(td5);
      tr.appendChild(td6);
      tbody.appendChild(tr);
    }

    const now = new Date();
    const ts = now.toLocaleString('th-TH');
    document.getElementById('a4FooterMeta').textContent = '‡∏û‡∏¥‡∏°‡∏û‡πå‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö FA ‚Äì LG ‡∏ì ' + ts;
  }

  function exportA4Html(){
    const a4 = document.getElementById('a4Page');
    if(!a4){
      alert('‡πÑ‡∏°‡πà‡∏û‡∏ö‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤ A4');
      return;
    }
    const htmlContent =
      '<!DOCTYPE html><html lang="th"><head><meta charset="UTF-8"><title>Form3.6-A4</title>' +
      '<style>@page{size:A4;margin:12mm;}body{font-family:\"TH Sarabun New\",\"Segoe UI\",sans-serif;font-size:11pt;} .a4-page{width:100%;min-height:100%;}</style>' +
      '</head><body>' + a4.outerHTML + '</body></html>';

    const blob = new Blob([htmlContent], {type:'text/html'});
    const url  = URL.createObjectURL(blob);
    const a    = document.createElement('a');
    a.href = url;
    a.download = 'form3_6_specific_materiality_a4.html';
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    URL.revokeObjectURL(url);
  }

  function exportJson(){
    const data = {
      fiscalYear    : document.getElementById('fy').value || '',
      auditee       : document.getElementById('auditee').value || '',
      amphoe        : document.getElementById('amphoe').value || '',
      province      : document.getElementById('province').value || '',
      preparedBy    : document.getElementById('preparedBy').value || '',
      reviewedBy    : document.getElementById('reviewedBy').value || '',
      refOm         : document.getElementById('refOm').value || '',
      refPm         : document.getElementById('refPm').value || '',
      refNote       : document.getElementById('refNote').value || '',
      specificItems : []
    };

    for(let r=1;r<=6;r++){
      const row = {
        className: document.getElementById('smClass-'+r)?.value || '',
        base     : document.getElementById('smBase-'+r)?.value || '',
        pct      : document.getElementById('smPct-'+r)?.value || '',
        amount   : document.getElementById('smAmt-'+r)?.value || '',
        reason   : document.getElementById('smReason-'+r)?.value || ''
      };
      if(row.className || row.base || row.pct || row.amount || row.reason){
        data.specificItems.push(row);
      }
    }

    const blob = new Blob([JSON.stringify(data,null,2)], {type:'application/json'});
    const url  = URL.createObjectURL(blob);
    const a    = document.createElement('a');
    a.href = url;
    a.download = 'form3_6_specific_materiality.json';
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    URL.revokeObjectURL(url);
  }
</script>

</body>
</html>
