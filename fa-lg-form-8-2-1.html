<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <title>‡πÅ‡∏ö‡∏ö ‡∏≠‡∏õ‡∏ó. 8.2.1 ‚Äì ‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡∏£‡∏±‡∏ö‡∏£‡∏≠‡∏á‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î | FA Digital</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root{
      --bg:#060818;
      --card:#11152b;
      --border:#262b46;
      --pink:#f48fb1;
      --blue:#0d47a1;
      --muted:#a3acc7;
      --green:#4caf50;
      --danger:#ef5350;
    }
    *{box-sizing:border-box;}
    body{
      margin:0;
      font-family:"Segoe UI",Tahoma,sans-serif;
      background:
        radial-gradient(circle at 10% 0%, rgba(123,30,60,0.36) 0, transparent 55%),
        radial-gradient(circle at 90% 100%, rgba(66,165,245,0.32) 0, transparent 55%),
        var(--bg);
      color:#f5f7ff;
    }
    h1,h2,h3,h4{margin:0;}

    .page{
      max-width:1100px;
      margin:24px auto 40px;
      padding:0 16px 32px;
    }

    header{
      background:linear-gradient(120deg,#7b1e3c,#0d47a1,#f48fb1);
      border-radius:18px;
      padding:18px 20px;
      box-shadow:0 10px 30px rgba(0,0,0,0.55);
      margin-bottom:18px;
      border:1px solid rgba(255,255,255,0.15);
    }
    header h1{
      font-size:22px;
      font-weight:800;
    }
    header h2{
      font-size:16px;
      font-weight:400;
      opacity:0.88;
      margin-top:4px;
    }
    .header-row{
      margin-top:10px;
      display:flex;
      flex-wrap:wrap;
      gap:10px;
      font-size:13px;
      opacity:0.9;
    }
    .tag{
      padding:4px 10px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,0.25);
      background:rgba(0,0,0,0.18);
    }

    .btn-row{
      margin-top:10px;
      display:flex;
      flex-wrap:wrap;
      gap:8px;
    }
    button{
      border:none;
      border-radius:999px;
      padding:6px 12px;
      font-size:13px;
      cursor:pointer;
      display:inline-flex;
      align-items:center;
      gap:6px;
    }
    .btn-soft{
      background:rgba(17,21,43,0.9);
      color:#f5f7ff;
      border:1px solid var(--border);
    }
    .btn-primary{
      background:linear-gradient(120deg,#0d47a1,#42a5f5);
      color:#fff;
    }
    .btn-danger{
      background:linear-gradient(120deg,#b71c1c,#ef5350);
      color:#fff;
    }
    .btn-ghost{
      background:transparent;
      border:1px dashed var(--border);
      color:var(--muted);
    }
    .btn-sm{
      padding:3px 8px;
      font-size:11px;
    }

    .section{
      background:rgba(6,8,24,0.8);
      border-radius:16px;
      border:1px solid var(--border);
      padding:16px 18px 18px;
      margin-top:16px;
      box-shadow:0 6px 20px rgba(0,0,0,0.5);
    }
    .section-title{
      font-size:15px;
      font-weight:700;
      margin-bottom:10px;
      display:flex;
      align-items:center;
      gap:8px;
    }
    .section-title span.badge{
      font-size:11px;
      padding:2px 8px;
      border-radius:999px;
      border:1px solid rgba(244,143,177,0.6);
      color:#ffdfe9;
    }

    .grid-2{
      display:grid;
      grid-template-columns:repeat(auto-fit,minmax(260px,1fr));
      gap:8px 18px;
    }
    label{
      font-size:13px;
      display:block;
      margin-bottom:3px;
      color:var(--muted);
    }
    input[type="text"],
    input[type="number"],
    input[type="date"],
    select,
    textarea{
      width:100%;
      padding:6px 8px;
      border-radius:8px;
      border:1px solid var(--border);
      background:var(--card);
      color:#f5f7ff;
      font-size:13px;
    }
    textarea{
      min-height:80px;
      resize:vertical;
    }

    table{
      width:100%;
      border-collapse:collapse;
      font-size:13px;
      margin-top:6px;
    }
    th,td{
      border:1px solid var(--border);
      padding:4px 6px;
      text-align:left;
    }
    th{
      background:rgba(13,71,161,0.6);
      font-weight:600;
      font-size:12px;
    }
    tbody tr:nth-child(even){
      background:rgba(255,255,255,0.01);
    }
    tbody tr:hover{
      background:rgba(255,255,255,0.04);
    }

    .text-center{text-align:center;}
    .hint{
      font-size:11px;
      color:var(--muted);
      margin-top:4px;
    }

    @media print{
      body{
        background:#fff;
        color:#000;
      }
      header,.section{
        box-shadow:none;
        border-radius:0;
      }
      .section{
        background:#fff;
        border-color:#ccc;
      }
      .no-print{
        display:none!important;
      }
      @page{
        size:A4;
        margin:15mm;
      }
    }
  </style>
</head>
<body>
<div class="page">

  <header class="no-print">
    <h1>‡πÅ‡∏ö‡∏ö ‡∏≠‡∏õ‡∏ó. 8.2.1 ‚Äì ‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡∏£‡∏±‡∏ö‡∏£‡∏≠‡∏á‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î</h1>
    <h2>Cash Certification Letter ‚Äì ‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô‡∏î‡∏¥‡∏à‡∏¥‡∏ó‡∏±‡∏• (‡∏≠‡∏õ‡∏ó.)</h2>
    <div class="header-row">
      <div class="tag">FA Digital Working Paper</div>
      <div class="tag">‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡πÅ‡∏ö‡∏ö ‡∏≠‡∏õ‡∏ó. 8.2.2 ‡∏ï‡∏£‡∏ß‡∏à‡∏ô‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î</div>
    </div>

    <div class="btn-row">
      <button class="btn-soft btn-sm"
              type="button"
              onclick="window.location.href='fa-lg-form-8-2.html'">
        ‚¨Ö ‡∏Å‡∏•‡∏±‡∏ö‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏Å‡∏•‡∏≤‡∏á‡πÅ‡∏ö‡∏ö ‡∏≠‡∏õ‡∏ó. 8.2
      </button>
      <button class="btn-soft btn-sm"
              type="button"
              onclick="window.location.href='fa-lg-fieldwork.html'">
        ‚¨Ö ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏á‡∏≤‡∏ô‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö (‡∏≠‡∏õ‡∏ó.)
      </button>
      <button class="btn-soft btn-sm"
              type="button"
              onclick="window.location.href='fa-lg-form-8-2-2.html'">
        üíµ ‡πÑ‡∏õ‡πÅ‡∏ö‡∏ö ‡∏≠‡∏õ‡∏ó. 8.2.2 ‡∏ï‡∏£‡∏ß‡∏à‡∏ô‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î
      </button>
    </div>
  </header>

  <!-- 1. Meta -->
  <section class="section">
    <div class="section-title">
      1. ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏£‡∏±‡∏ö‡∏ï‡∏£‡∏ß‡∏à & ‡∏õ‡∏µ‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì
      <span class="badge">Meta</span>
    </div>
    <div class="grid-2">
      <div>
        <label for="fiscal_year">‡∏õ‡∏µ‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì</label>
        <select id="fiscal_year">
          <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏µ --</option>
        </select>
      </div>
      <div>
        <label for="entity_code">‡∏£‡∏´‡∏±‡∏™‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏£‡∏±‡∏ö‡∏ï‡∏£‡∏ß‡∏à</label>
        <input type="text" id="entity_code" placeholder="‡πÄ‡∏ä‡πà‡∏ô SSK-MUN-001" />
      </div>
      <div>
        <label for="entity_name">‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏£‡∏±‡∏ö‡∏ï‡∏£‡∏ß‡∏à</label>
        <input type="text" id="entity_name" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡πÄ‡∏ó‡∏®‡∏ö‡∏≤‡∏•‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏®‡∏£‡∏µ‡∏™‡∏∞‡πÄ‡∏Å‡∏©" />
      </div>
      <div>
        <label for="entity_location">‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡∏±‡πâ‡∏á‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏£‡∏±‡∏ö‡∏ï‡∏£‡∏ß‡∏à</label>
        <input type="text" id="entity_location" placeholder="‡∏ï‡∏≥‡∏ö‡∏•/‡∏≠‡∏≥‡πÄ‡∏†‡∏≠/‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î" />
      </div>
    </div>
    <div class="hint">
      ‡πÉ‡∏ä‡πâ‡∏ä‡∏∏‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡πÅ‡∏ö‡∏ö 8.2.2 ‡πÅ‡∏•‡∏∞ 8.2.3 ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏£‡∏±‡∏ö‡∏ï‡∏£‡∏ß‡∏à‡πÑ‡∏î‡πâ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ô
    </div>
  </section>

  <!-- 2. ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠ -->
  <section class="section">
    <div class="section-title">
      2. ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡∏£‡∏±‡∏ö‡∏£‡∏≠‡∏á‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î
      <span class="badge">Letter Context</span>
    </div>
    <div class="grid-2">
      <div>
        <label for="doc_date">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡∏£‡∏±‡∏ö‡∏£‡∏≠‡∏á‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î (‡∏≠‡∏≠‡∏Å‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠)</label>
        <input type="date" id="doc_date" oninput="updatePreview()" />
      </div>
      <div>
        <label for="doc_place">‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏≠‡∏≠‡∏Å‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠</label>
        <input type="text" id="doc_place" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡πÄ‡∏ó‡∏®‡∏ö‡∏≤‡∏•‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏®‡∏£‡∏µ‡∏™‡∏∞‡πÄ‡∏Å‡∏©" oninput="updatePreview()" />
      </div>
      <div>
        <label for="count_date">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏ß‡∏à‡∏ô‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î (‡∏ï‡∏≤‡∏°‡πÅ‡∏ö‡∏ö 8.2.2)</label>
        <input type="date" id="count_date" oninput="updatePreview()" />
      </div>
      <div>
        <label for="count_time">‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏ß‡∏à‡∏ô‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î</label>
        <input type="text" id="count_time" placeholder="‡πÄ‡∏ä‡πà‡∏ô 09.30 ‡∏ô." oninput="updatePreview()" />
      </div>
      <div>
        <label for="status_date">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á</label>
        <input type="date" id="status_date" oninput="updatePreview()" />
      </div>
      <div>
        <label for="ref_workpaper">‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà/‡∏ä‡∏∑‡πà‡∏≠‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏©‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á</label>
        <input type="text" id="ref_workpaper" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏≠‡∏õ‡∏ó.8.2.2/‡∏ó‡∏°.‡∏®‡∏Å/2568" oninput="updatePreview()" />
      </div>
    </div>

    <label for="other_note" style="margin-top:8px;">‡∏Ç‡πâ‡∏≠‡πÄ‡∏ó‡πá‡∏à‡∏à‡∏£‡∏¥‡∏á‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°/‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏û‡∏¥‡πÄ‡∏®‡∏© (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)</label>
    <textarea id="other_note" oninput="updatePreview()" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏°‡∏µ‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡∏ó‡∏µ‡πà‡∏ù‡∏≤‡∏Å‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£‡πÅ‡∏•‡πâ‡∏ß‡πÅ‡∏ï‡πà‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å ..."></textarea>
  </section>

  <!-- 3. ‡∏Å‡∏£‡∏£‡∏°‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡πá‡∏ö‡∏£‡∏±‡∏Å‡∏©‡∏≤‡πÄ‡∏á‡∏¥‡∏ô -->
  <section class="section">
    <div class="section-title">
      3. ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏Å‡∏£‡∏£‡∏°‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡πá‡∏ö‡∏£‡∏±‡∏Å‡∏©‡∏≤‡πÄ‡∏á‡∏¥‡∏ô (‡∏ú‡∏π‡πâ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô)
      <span class="badge">Cash Custodians</span>
    </div>
    <table id="custodian_table">
      <thead>
        <tr>
          <th style="width:40px;">‡∏•‡∏≥‡∏î‡∏±‡∏ö</th>
          <th>‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏•</th>
          <th>‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á</th>
          <th style="width:160px;">‡∏ö‡∏ó‡∏ö‡∏≤‡∏ó‡πÉ‡∏ô‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠</th>
          <th class="no-print" style="width:60px;">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
    <div class="btn-row no-print">
      <button class="btn-ghost btn-sm" type="button" onclick="addCustodianRow()">+ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Å‡∏£‡∏£‡∏°‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡πá‡∏ö‡∏£‡∏±‡∏Å‡∏©‡∏≤‡πÄ‡∏á‡∏¥‡∏ô</button>
    </div>
    <div class="hint">
      ‡∏ä‡∏∏‡∏î‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡πÉ‡∏ä‡πâ‡∏ó‡∏±‡πâ‡∏á‡πÉ‡∏ô‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠ ‡πÅ‡∏•‡∏∞‡πÉ‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏á‡∏ô‡∏≤‡∏°‡∏ó‡πâ‡∏≤‡∏¢‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£
    </div>
  </section>

  <!-- 4. ‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠ (Preview + ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÑ‡∏î‡πâ) -->
  <section class="section">
    <div class="section-title">
      4. ‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡∏£‡∏±‡∏ö‡∏£‡∏≠‡∏á‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î (‡∏â‡∏ö‡∏±‡∏ö‡∏£‡πà‡∏≤‡∏á)
      <span class="badge">Draft Letter</span>
    </div>
    <div class="hint">
      ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏ä‡πà‡∏ß‡∏¢‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡πà‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô‡πÉ‡∏´‡πâ‡∏Å‡πà‡∏≠‡∏ô ‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏Å‡πâ ‡πÄ‡∏û‡∏¥‡πà‡∏°-‡∏•‡∏î‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏Ñ‡πÑ‡∏î‡πâ‡∏ï‡∏≤‡∏°‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡∏à‡∏£‡∏¥‡∏á‡∏Ç‡∏≠‡∏á ‡∏™‡∏ï‡∏á.
    </div>
    <textarea id="letter_body"></textarea>
  </section>

  <!-- 5. ‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô -->
  <section class="section">
    <div class="section-title">
      5. ‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô‡∏ú‡∏π‡πâ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÅ‡∏•‡∏∞‡∏ú‡∏π‡πâ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö
      <span class="badge">Signatures</span>
    </div>
    <table id="sign_table">
      <thead>
        <tr>
          <th>‡∏ö‡∏ó‡∏ö‡∏≤‡∏ó</th>
          <th>‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏•</th>
          <th>‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á</th>
          <th style="width:120px;">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏•‡∏á‡∏ô‡∏≤‡∏°</th>
          <th class="no-print" style="width:60px;">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
    <div class="btn-row no-print">
      <button class="btn-ghost btn-sm" type="button" onclick="addSignRow()">+ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ä‡πà‡∏≠‡∏á‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô</button>
    </div>
  </section>

  <!-- 6. Output -->
  <section class="section no-print">
    <div class="section-title">
      6. ‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡πÄ‡∏Å‡πá‡∏ö / Export / ‡∏û‡∏¥‡∏°‡∏û‡πå
      <span class="badge">Output</span>
    </div>
    <div class="btn-row">
      <button class="btn-primary" type="button" onclick="saveToStorage()">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏•‡∏á‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á (LocalStorage)</button>
      <button class="btn-soft" type="button" onclick="loadFromStorage()">üì• ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏ß‡πâ</button>
      <button class="btn-soft" type="button" onclick="window.print()">üñ® ‡∏û‡∏¥‡∏°‡∏û‡πå / Export ‡πÄ‡∏õ‡πá‡∏ô PDF</button>
      <button class="btn-danger" type="button" onclick="clearForm()">üóë ‡∏•‡πâ‡∏≤‡∏á‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏ô‡∏µ‡πâ</button>
    </div>
    <div class="hint">
      ‡∏Ç‡∏ì‡∏∞‡∏ô‡∏µ‡πâ‡πÉ‡∏ä‡πâ LocalStorage ‡πÄ‡∏õ‡πá‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß ‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏•‡∏≤‡∏á‡πÉ‡∏ô‡∏Ç‡∏±‡πâ‡∏ô‡∏ñ‡∏±‡∏î‡πÑ‡∏õ
    </div>
  </section>

</div>

<script>
  // ‡πÄ‡∏ï‡∏¥‡∏°‡∏õ‡∏µ‡∏á‡∏ö
  document.addEventListener("DOMContentLoaded",()=>{
    const fy=document.getElementById("fiscal_year");
    for(let y=2562;y<=2590;y++){
      const opt=document.createElement("option");
      opt.value=y;
      opt.textContent=y;
      fy.appendChild(opt);
    }
    // ‡πÅ‡∏ñ‡∏ß‡∏Å‡∏£‡∏£‡∏°‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô
    addCustodianRow({role:"‡∏õ‡∏£‡∏∞‡∏ò‡∏≤‡∏ô‡∏Å‡∏£‡∏£‡∏°‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡πá‡∏ö‡∏£‡∏±‡∏Å‡∏©‡∏≤‡πÄ‡∏á‡∏¥‡∏ô"});
    addCustodianRow({role:"‡∏Å‡∏£‡∏£‡∏°‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡πá‡∏ö‡∏£‡∏±‡∏Å‡∏©‡∏≤‡πÄ‡∏á‡∏¥‡∏ô"});
    // ‡πÅ‡∏ñ‡∏ß‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô
    addSignRow({role:"‡∏õ‡∏£‡∏∞‡∏ò‡∏≤‡∏ô‡∏Å‡∏£‡∏£‡∏°‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡πá‡∏ö‡∏£‡∏±‡∏Å‡∏©‡∏≤‡πÄ‡∏á‡∏¥‡∏ô"});
    addSignRow({role:"‡∏Å‡∏£‡∏£‡∏°‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡πá‡∏ö‡∏£‡∏±‡∏Å‡∏©‡∏≤‡πÄ‡∏á‡∏¥‡∏ô"});
    addSignRow({role:"‡∏ú‡∏π‡πâ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö (‡∏™‡∏ï‡∏á.)"});
    updatePreview();
  });

  function addCustodianRow(data){
    const tbody=document.querySelector("#custodian_table tbody");
    const idx=tbody.children.length+1;
    const tr=document.createElement("tr");
    tr.innerHTML=`
      <td class="text-center">${idx}</td>
      <td><input type="text" value="${data?.name || ""}" oninput="updatePreview()" /></td>
      <td><input type="text" value="${data?.position || ""}" oninput="updatePreview()" /></td>
      <td><input type="text" value="${data?.role || ""}" oninput="updatePreview()" /></td>
      <td class="no-print text-center">
        <button class="btn-ghost btn-sm" type="button" onclick="removeCustodianRow(this)">‡∏•‡∏ö</button>
      </td>
    `;
    tbody.appendChild(tr);
  }

  function removeCustodianRow(btn){
    const tr=btn.closest("tr");
    const tbody=tr.parentElement;
    tbody.removeChild(tr);
    [...tbody.children].forEach((row,i)=>{
      row.children[0].textContent=i+1;
    });
    updatePreview();
  }

  function addSignRow(data){
    const tbody=document.querySelector("#sign_table tbody");
    const tr=document.createElement("tr");
    tr.innerHTML=`
      <td><input type="text" value="${data?.role || ""}" /></td>
      <td><input type="text" value="${data?.name || ""}" /></td>
      <td><input type="text" value="${data?.position || ""}" /></td>
      <td><input type="date" value="${data?.signed_date || ""}" /></td>
      <td class="no-print text-center">
        <button class="btn-ghost btn-sm" type="button" onclick="removeSignRow(this)">‡∏•‡∏ö</button>
      </td>
    `;
    tbody.appendChild(tr);
  }

  function removeSignRow(btn){
    const tr=btn.closest("tr");
    tr.parentElement.removeChild(tr);
  }

  function formatThaiDate(dateStr){
    if(!dateStr) return "";
    const d=new Date(dateStr);
    if(isNaN(d.getTime())) return "";
    const months=["‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏°","‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå","‡∏°‡∏µ‡∏ô‡∏≤‡∏Ñ‡∏°","‡πÄ‡∏°‡∏©‡∏≤‡∏¢‡∏ô","‡∏û‡∏§‡∏©‡∏†‡∏≤‡∏Ñ‡∏°","‡∏°‡∏¥‡∏ñ‡∏∏‡∏ô‡∏≤‡∏¢‡∏ô","‡∏Å‡∏£‡∏Å‡∏é‡∏≤‡∏Ñ‡∏°","‡∏™‡∏¥‡∏á‡∏´‡∏≤‡∏Ñ‡∏°","‡∏Å‡∏±‡∏ô‡∏¢‡∏≤‡∏¢‡∏ô","‡∏ï‡∏∏‡∏•‡∏≤‡∏Ñ‡∏°","‡∏û‡∏§‡∏®‡∏à‡∏¥‡∏Å‡∏≤‡∏¢‡∏ô","‡∏ò‡∏±‡∏ô‡∏ß‡∏≤‡∏Ñ‡∏°"];
    const day=d.getDate();
    const month=months[d.getMonth()];
    const year=d.getFullYear()+543;
    return `${day} ${month} ‡∏û.‡∏®. ${year}`;
  }

  function updatePreview(){
    const entity=document.getElementById("entity_name").value || "........................................";
    const loc=document.getElementById("entity_location").value || "........................................";
    const docDate=formatThaiDate(document.getElementById("doc_date").value) || "........................................";
    const docPlace=document.getElementById("doc_place").value || "........................................";
    const countDate=formatThaiDate(document.getElementById("count_date").value) || "........................................";
    const countTime=document.getElementById("count_time").value || "........................................";
    const statusDate=formatThaiDate(document.getElementById("status_date").value) || "........................................";
    const refWp=document.getElementById("ref_workpaper").value || "........................................";
    const note=document.getElementById("other_note").value || "";

    // ‡∏£‡∏ß‡∏°‡∏ä‡∏∑‡πà‡∏≠‡∏Å‡∏£‡∏£‡∏°‡∏Å‡∏≤‡∏£
    const custRows=document.querySelectorAll("#custodian_table tbody tr");
    let names=[];
    custRows.forEach(tr=>{
      const inputs=tr.querySelectorAll("input");
      const name=inputs[0].value;
      const pos=inputs[1].value;
      if(name){
        names.push(`${name} ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á ${pos || "................................"}`);
      }
    });
    const nameLine=names.length>0 ? names.join(" ‡πÅ‡∏•‡∏∞ ") : "...............................................................";

    const draft=
`‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡∏£‡∏±‡∏ö‡∏£‡∏≠‡∏á‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î
${docPlace}
‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà ${docDate}

‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á ‡∏£‡∏±‡∏ö‡∏£‡∏≠‡∏á‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡∏Ç‡∏≠‡∏á ${entity}
‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏ú‡πà‡∏ô‡∏î‡∏¥‡∏ô

‡∏Ç‡πâ‡∏≤‡∏û‡πÄ‡∏à‡πâ‡∏≤ ${nameLine} ‡∏ã‡∏∂‡πà‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏£‡∏£‡∏°‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡πá‡∏ö‡∏£‡∏±‡∏Å‡∏©‡∏≤‡πÄ‡∏á‡∏¥‡∏ô‡∏Ç‡∏≠‡∏á ${entity} ${loc}
‡∏Ç‡∏≠‡∏£‡∏±‡∏ö‡∏£‡∏≠‡∏á‡∏ß‡πà‡∏≤ ‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏ô‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î ‡∏ì ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà ${countDate} ‡πÄ‡∏ß‡∏•‡∏≤ ${countTime} ‡∏ô‡∏≤‡∏¨‡∏¥‡∏Å‡∏≤
‡∏ï‡∏≤‡∏°‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏©‡∏ó‡∏≥‡∏Å‡∏≤‡∏£ ${refWp} ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡∏à‡∏£‡∏¥‡∏á ‡∏ì ‡∏ß‡∏±‡∏ô‡∏î‡∏±‡∏á‡∏Å‡∏•‡πà‡∏≤‡∏ß
‡πÅ‡∏•‡∏∞‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏¢‡∏≠‡∏î‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏ï‡∏≤‡∏°‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô ‡∏ì ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà ${statusDate}

‡∏ó‡∏±‡πâ‡∏á‡∏ô‡∏µ‡πâ ‡∏Ç‡πâ‡∏≤‡∏û‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏£‡∏±‡∏ö‡∏£‡∏≠‡∏á‡∏ß‡πà‡∏≤ ‡∏ô‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏ô‡∏≥‡∏°‡∏≤‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏ß‡∏à‡∏ô‡∏±‡∏ö‡πÅ‡∏•‡∏∞‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏ß‡πâ‡∏ï‡∏≤‡∏°‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏©‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡∏î‡∏±‡∏á‡∏Å‡∏•‡πà‡∏≤‡∏ß‡πÅ‡∏•‡πâ‡∏ß
‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡∏≠‡∏∑‡πà‡∏ô‡∏Ç‡∏≠‡∏á‡∏ó‡∏≤‡∏á‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡πá‡∏ö‡∏£‡∏±‡∏Å‡∏©‡∏≤‡πÑ‡∏ß‡πâ‡πÇ‡∏î‡∏¢‡∏°‡∏¥‡πÑ‡∏î‡πâ‡∏ô‡∏≥‡∏°‡∏≤‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏ß‡∏à‡∏ô‡∏±‡∏ö‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°‡πÅ‡∏ï‡πà‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÉ‡∏î

${note ? "‡∏Ç‡πâ‡∏≠‡πÄ‡∏ó‡πá‡∏à‡∏à‡∏£‡∏¥‡∏á‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°/‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢:\n" + note + "\n\n" : ""}‡∏à‡∏∂‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏°‡∏≤‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÇ‡∏õ‡∏£‡∏î‡∏ó‡∏£‡∏≤‡∏ö ‡πÅ‡∏•‡∏∞‡πÉ‡∏ä‡πâ‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡∏≠‡∏á‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏ú‡πà‡∏ô‡∏î‡∏¥‡∏ô‡∏ï‡πà‡∏≠‡πÑ‡∏õ

‡∏•‡∏á‡∏ä‡∏∑‡πà‡∏≠ ...............................................................  ‡∏Å‡∏£‡∏£‡∏°‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡πá‡∏ö‡∏£‡∏±‡∏Å‡∏©‡∏≤‡πÄ‡∏á‡∏¥‡∏ô
‡∏•‡∏á‡∏ä‡∏∑‡πà‡∏≠ ...............................................................  ‡∏Å‡∏£‡∏£‡∏°‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡πá‡∏ö‡∏£‡∏±‡∏Å‡∏©‡∏≤‡πÄ‡∏á‡∏¥‡∏ô
‡∏•‡∏á‡∏ä‡∏∑‡πà‡∏≠ ...............................................................  ‡∏õ‡∏£‡∏∞‡∏ò‡∏≤‡∏ô‡∏Å‡∏£‡∏£‡∏°‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡πá‡∏ö‡∏£‡∏±‡∏Å‡∏©‡∏≤‡πÄ‡∏á‡∏¥‡∏ô
`;

    const body=document.getElementById("letter_body");
    // ‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏Ñ‡∏¢‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç ‡πÉ‡∏´‡πâ overwrite, ‡∏ñ‡πâ‡∏≤‡πÅ‡∏Å‡πâ‡πÅ‡∏•‡πâ‡∏ß‡πÅ‡∏•‡πâ‡∏ß‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏à‡∏∞‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ó‡∏±‡∏ö‡πÑ‡∏î‡πâ‡πÄ‡∏≠‡∏á
    if(!body.dataset.userEdited){
      body.value=draft;
    }
  }

  // ‡∏ñ‡πâ‡∏≤‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡πÄ‡∏≠‡∏á‡πÅ‡∏•‡πâ‡∏ß ‡πÑ‡∏°‡πà overwrite ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡∏≠‡∏µ‡∏Å
  document.getElementById("letter_body").addEventListener("input",()=>{
    document.getElementById("letter_body").dataset.userEdited="1";
  });

  function getStorageKey(){
    const fy=document.getElementById("fiscal_year").value || "no-year";
    const code=document.getElementById("entity_code").value || "no-entity";
    return `fa_lg_form_8_2_1::${fy}::${code}`;
  }

  function collectFormData(){
    const data={
      meta:{
        fiscal_year:document.getElementById("fiscal_year").value,
        entity_code:document.getElementById("entity_code").value,
        entity_name:document.getElementById("entity_name").value,
        entity_location:document.getElementById("entity_location").value
      },
      context:{
        doc_date:document.getElementById("doc_date").value,
        doc_place:document.getElementById("doc_place").value,
        count_date:document.getElementById("count_date").value,
        count_time:document.getElementById("count_time").value,
        status_date:document.getElementById("status_date").value,
        ref_workpaper:document.getElementById("ref_workpaper").value,
        other_note:document.getElementById("other_note").value
      },
      custodians:[],
      letter_body:document.getElementById("letter_body").value,
      letter_body_userEdited:!!document.getElementById("letter_body").dataset.userEdited,
      signatures:[]
    };

    document.querySelectorAll("#custodian_table tbody tr").forEach((tr,idx)=>{
      const inputs=tr.querySelectorAll("input");
      data.custodians.push({
        order:idx+1,
        name:inputs[0].value,
        position:inputs[1].value,
        role:inputs[2].value
      });
    });

    document.querySelectorAll("#sign_table tbody tr").forEach(tr=>{
      const inputs=tr.querySelectorAll("input");
      data.signatures.push({
        role:inputs[0].value,
        name:inputs[1].value,
        position:inputs[2].value,
        signed_date:inputs[3].value
      });
    });

    return data;
  }

  function fillFormFromData(data){
    if(!data) return;
    if(data.meta){
      document.getElementById("fiscal_year").value=data.meta.fiscal_year || "";
      document.getElementById("entity_code").value=data.meta.entity_code || "";
      document.getElementById("entity_name").value=data.meta.entity_name || "";
      document.getElementById("entity_location").value=data.meta.entity_location || "";
    }
    if(data.context){
      document.getElementById("doc_date").value=data.context.doc_date || "";
      document.getElementById("doc_place").value=data.context.doc_place || "";
      document.getElementById("count_date").value=data.context.count_date || "";
      document.getElementById("count_time").value=data.context.count_time || "";
      document.getElementById("status_date").value=data.context.status_date || "";
      document.getElementById("ref_workpaper").value=data.context.ref_workpaper || "";
      document.getElementById("other_note").value=data.context.other_note || "";
    }

    const ctbody=document.querySelector("#custodian_table tbody");
    ctbody.innerHTML="";
    (data.custodians || []).forEach(c=>addCustodianRow(c));
    if(!data.custodians || data.custodians.length===0){
      addCustodianRow({role:"‡∏õ‡∏£‡∏∞‡∏ò‡∏≤‡∏ô‡∏Å‡∏£‡∏£‡∏°‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡πá‡∏ö‡∏£‡∏±‡∏Å‡∏©‡∏≤‡πÄ‡∏á‡∏¥‡∏ô"});
      addCustodianRow({role:"‡∏Å‡∏£‡∏£‡∏°‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡πá‡∏ö‡∏£‡∏±‡∏Å‡∏©‡∏≤‡πÄ‡∏á‡∏¥‡∏ô"});
    }

    const body=document.getElementById("letter_body");
    body.value=data.letter_body || "";
    if(data.letter_body_userEdited) body.dataset.userEdited="1"; else delete body.dataset.userEdited;

    const stb=document.querySelector("#sign_table tbody");
    stb.innerHTML="";
    (data.signatures || []).forEach(s=>addSignRow(s));
    if(!data.signatures || data.signatures.length===0){
      addSignRow({role:"‡∏õ‡∏£‡∏∞‡∏ò‡∏≤‡∏ô‡∏Å‡∏£‡∏£‡∏°‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡πá‡∏ö‡∏£‡∏±‡∏Å‡∏©‡∏≤‡πÄ‡∏á‡∏¥‡∏ô"});
      addSignRow({role:"‡∏Å‡∏£‡∏£‡∏°‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡πá‡∏ö‡∏£‡∏±‡∏Å‡∏©‡∏≤‡πÄ‡∏á‡∏¥‡∏ô"});
      addSignRow({role:"‡∏ú‡∏π‡πâ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö (‡∏™‡∏ï‡∏á.)"});
    }

    // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï draft ‡πÄ‡∏ú‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÄ‡∏≠‡∏á
    updatePreview();
  }

  function saveToStorage(){
    const key=getStorageKey();
    const data=collectFormData();
    try{
      localStorage.setItem(key,JSON.stringify(data));
      alert("‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ü‡∏≠‡∏£‡πå‡∏° 8.2.1 ‡∏•‡∏á LocalStorage ‡πÅ‡∏•‡πâ‡∏ß\nKey: "+key);
    }catch(e){
      alert("‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: "+e.message);
    }
  }

  function loadFromStorage(){
    const key=getStorageKey();
    const raw=localStorage.getItem(key);
    if(!raw){
      alert("‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡πÄ‡∏Ñ‡∏¢‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏ß‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö key ‡∏ô‡∏µ‡πâ\n‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏õ‡∏µ‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì ‡πÅ‡∏•‡∏∞‡∏£‡∏´‡∏±‡∏™‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏£‡∏±‡∏ö‡∏ï‡∏£‡∏ß‡∏à");
      return;
    }
    try{
      const data=JSON.parse(raw);
      fillFormFromData(data);
      alert("‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏ß‡πâ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢");
    }catch(e){
      alert("‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏≠‡πà‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡πá‡∏ö‡πÑ‡∏ß‡πâ‡πÑ‡∏î‡πâ: "+e.message);
    }
  }

  function clearForm(){
    if(!confirm("‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏ô‡∏µ‡πâ? ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏à‡∏∞‡∏´‡∏≤‡∏¢‡πÑ‡∏õ")) return;
    document.querySelectorAll("input,textarea,select").forEach(el=>{
      if(el.type==="checkbox" || el.type==="radio") el.checked=false;
      else el.value="";
    });
    document.getElementById("letter_body").dataset.userEdited="";
    const ctbody=document.querySelector("#custodian_table tbody");
    ctbody.innerHTML="";
    addCustodianRow({role:"‡∏õ‡∏£‡∏∞‡∏ò‡∏≤‡∏ô‡∏Å‡∏£‡∏£‡∏°‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡πá‡∏ö‡∏£‡∏±‡∏Å‡∏©‡∏≤‡πÄ‡∏á‡∏¥‡∏ô"});
    addCustodianRow({role:"‡∏Å‡∏£‡∏£‡∏°‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡πá‡∏ö‡∏£‡∏±‡∏Å‡∏©‡∏≤‡πÄ‡∏á‡∏¥‡∏ô"});

    const stb=document.querySelector("#sign_table tbody");
    stb.innerHTML="";
    addSignRow({role:"‡∏õ‡∏£‡∏∞‡∏ò‡∏≤‡∏ô‡∏Å‡∏£‡∏£‡∏°‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡πá‡∏ö‡∏£‡∏±‡∏Å‡∏©‡∏≤‡πÄ‡∏á‡∏¥‡∏ô"});
    addSignRow({role:"‡∏Å‡∏£‡∏£‡∏°‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡πá‡∏ö‡∏£‡∏±‡∏Å‡∏©‡∏≤‡πÄ‡∏á‡∏¥‡∏ô"});
    addSignRow({role:"‡∏ú‡∏π‡πâ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö (‡∏™‡∏ï‡∏á.)"});

    updatePreview();
  }
</script>

</body>
</html>
