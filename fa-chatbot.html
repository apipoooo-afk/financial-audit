<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>FA Chatbot | ‡∏ú‡∏π‡πâ‡∏ä‡πà‡∏ß‡∏¢‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô & ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <style>
    /* --- CSS ‡πÄ‡∏î‡∏¥‡∏° --- */
    body { margin:0; padding:0; font-family:"Segoe UI",Arial,sans-serif; background:#f5f6fa; color:#222; }
    header { background:linear-gradient(120deg,#0d6efd,#6f42c1,#20c997); color:white; padding:16px 20px; box-shadow:0 3px 10px rgba(0,0,0,0.25); display:flex; justify-content:space-between; align-items:flex-start; flex-wrap:wrap; }
    .title { font-size:22px; font-weight:700; }
    .subtitle { font-size:13px; margin-top:4px; opacity:0.9; max-width:360px; line-height:1.5; }
    .right-box { text-align:right; font-size:12px; }
    .right-box a, .right-box span { color:#fff; text-decoration:none; cursor:pointer; }
    .right-box a:hover { text-decoration:underline; }
    .metrics-bar { background:#ffffff; padding:10px 16px; border-bottom:1px solid #ddd; display:flex; justify-content:space-between; align-items:center; font-size:13px; flex-wrap:wrap; gap:6px; }
    .metric-pill { background:#e8f0ff; padding:5px 12px; border-radius:999px; font-size:13px; display:inline-flex; align-items:center; gap:6px; }
    .container { display:flex; height:calc(100vh - 130px); }
    .left-pane { flex:3; display:flex; flex-direction:column; padding:12px; background:#ffffff; border-right:1px solid #ddd; }
    .right-pane { flex:1.4; padding:14px; background:#f0f4ff; overflow-y:auto; }
    .greeting-box { background:#f2f7ff; border-radius:12px; padding:12px 14px; margin-bottom:10px; line-height:1.5; font-size:13px; box-shadow:0 1px 4px rgba(0,0,0,0.08); }
    .label { margin-top:10px; margin-bottom:6px; font-weight:700; font-size:14px; }
    textarea { width:100%; min-height:80px; resize:none; border-radius:8px; border:1px solid #ccc; padding:10px; font-size:14px; font-family:inherit; box-sizing: border-box; }
    .controls { display:flex; flex-wrap:wrap; gap:8px; margin-top:8px; margin-bottom:8px; }
    .controls button { padding:8px 14px; border:none; border-radius:8px; font-size:13px; cursor:pointer; display:flex; align-items:center; gap:6px; transition: 0.2s; }
    .controls button:hover { opacity: 0.9; transform: translateY(-1px); }
    .btn-send { background:#0d6efd; color:white; }
    .btn-clear { background:#eeeeee; }
    .btn-back { background:#6c757d; color:white; margin-left:auto; }
    .btn-processing { background:#ffeb3b; color:#222; }
    .btn-speak { background:#20c997; color:white; }
    .answer-box { flex:1; padding:12px; border-radius:10px; background:#f7f7f7; border:1px solid #ddd; font-size:14px; line-height:1.6; overflow-y:auto; white-space:pre-wrap; }
    .sample-item { background:#ffffff; border-radius:10px; padding:10px 12px; margin-bottom:10px; cursor:pointer; box-shadow:0 1px 4px rgba(0,0,0,0.08); font-size:13px; transition:0.15s; }
    .sample-item:hover { background:#e7f0ff; }
    
    /* --- ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Admin Modal --- */
    .admin-btn { background: rgba(255,255,255,0.2); padding: 5px 10px; border-radius: 4px; margin-top: 5px; display: inline-block; font-weight: bold; }
    
    .modal-overlay {
      display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%;
      background-color: rgba(0,0,0,0.5); backdrop-filter: blur(2px);
      align-items: center; justify-content: center;
    }
    
    .modal-content {
      background-color: #fefefe; padding: 20px; border-radius: 12px;
      width: 90%; max-width: 600px; max-height: 90vh; overflow-y: auto;
      box-shadow: 0 5px 15px rgba(0,0,0,0.3); position: relative;
    }
    
    .modal-header { display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #eee; padding-bottom: 10px; margin-bottom: 15px; }
    .modal-title { font-size: 18px; font-weight: bold; color: #0d6efd; }
    .btn-close-modal { background: none; border: none; font-size: 24px; cursor: pointer; color: #aaa; }
    
    .admin-controls { display: flex; gap: 10px; margin-bottom: 15px; border-bottom: 1px solid #eee; padding-bottom: 15px; }
    
    .form-group { margin-bottom: 15px; }
    .form-group label { display: block; margin-bottom: 5px; font-weight: 600; font-size: 13px; }
    .form-input { width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 6px; box-sizing: border-box; }
    
    .file-list { list-style: none; padding: 0; margin: 0; }
    .file-item { 
      background: #f8f9fa; border: 1px solid #ddd; padding: 10px; margin-bottom: 8px; border-radius: 6px; 
      display: flex; justify-content: space-between; align-items: center; cursor: pointer; transition: 0.2s;
    }
    .file-item:hover { background: #e2e6ea; border-color: #adb5bd; }
    .file-icon { margin-right: 8px; font-size: 16px; }
    
    /* ‡∏õ‡∏∏‡πà‡∏°‡πÉ‡∏ô Modal */
    .btn-action { padding: 8px 16px; border-radius: 6px; border: none; cursor: pointer; font-size: 14px; font-weight: 600; }
    .btn-primary { background: #0d6efd; color: white; }
    .btn-success { background: #20c997; color: white; }
    .btn-danger { background: #dc3545; color: white; }
    .btn-secondary { background: #6c757d; color: white; }
    .btn-outline { background: white; border: 1px solid #ccc; color: #333; }
    
    /* Success Popup */
    .success-popup {
      display: none; position: fixed; z-index: 1100; left: 0; top: 0; width: 100%; height: 100%;
      background-color: rgba(0,0,0,0.4); align-items: center; justify-content: center;
    }
    .success-content {
      background: white; padding: 30px; border-radius: 15px; text-align: center; width: 300px;
      box-shadow: 0 10px 25px rgba(0,0,0,0.2);
    }
    .success-icon { font-size: 50px; color: #20c997; margin-bottom: 15px; display: block; }

    @media(max-width:900px) {
      .container { flex-direction:column; height:auto; }
      .left-pane, .right-pane { height:auto; }
    }
  </style>

</head>
<body>

<header>
  <div>
    <div class="title">ü§ñ FA Chatbot</div>
    <div class="subtitle">
      ‡∏ú‡∏π‡πâ‡∏ä‡πà‡∏ß‡∏¢‡∏≠‡∏±‡∏à‡∏â‡∏£‡∏¥‡∏¢‡∏∞‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô & ‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô
    </div>
  </div>

  <div class="right-box">
    ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏£‡∏∞‡∏ö‡∏ö: <span id="username-label">Admin User</span><br>
    <a href="#" onclick="openAdminModal()" class="admin-btn">‚öôÔ∏è ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (Admin)</a>
  </div>
</header>

<div class="metrics-bar">
  <span class="metric-pill">üë• ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô: <span id="current-users">0</span> ‡∏Ñ‡∏ô</span>
  <span class="metric-pill">üìä ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏™‡∏∞‡∏™‡∏°: <span id="total-questions">0</span> ‡∏Ñ‡∏£‡∏±‡πâ‡∏á</span>
  <span id="system-status">‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£</span>
</div>

<div class="container">
  <div class="left-pane">
    <div class="greeting-box">
      ‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ‡∏Ñ‡πà‡∏∞/‡∏Ñ‡∏£‡∏±‡∏ö üëã<br>
      ‡∏â‡∏±‡∏ô‡∏Ñ‡∏∑‡∏≠‚Äã <b>FA Chatbot</b> ‡∏ú‡∏π‡πâ‡∏ä‡πà‡∏ß‡∏¢‡∏î‡πâ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô<br>
      ‡∏ñ‡∏≤‡∏°‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô ‡∏û‡∏±‡∏™‡∏î‡∏∏ ‡∏´‡∏£‡∏∑‡∏≠‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö‡∏ï‡πà‡∏≤‡∏á‡πÜ ‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢‡∏Ñ‡∏£‡∏±‡∏ö
    </div>

    <div class="label">‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</div>
    <textarea id="question-input" placeholder="‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á: ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡∏Å‡∏≥‡∏´‡∏ô‡∏î Materiality..."></textarea>

    <div class="controls">
      <button class="btn-send" id="btn-send">üì§ ‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°</button>
      <button class="btn-clear" id="btn-clear">üßπ ‡∏•‡πâ‡∏≤‡∏á</button>
      <button class="btn-processing" id="btn-processing" disabled style="display:none;">‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•...</button>
      <button class="btn-speak" id="btn-speak" disabled>üîä ‡∏ü‡∏±‡∏á‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö</button>
    </div>

    <div class="label">‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</div>
    <div id="answer-box" class="answer-box">‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏ï‡∏≠‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà‚Ä¶</div>
  </div>

  <div class="right-pane">
    <h3>üéØ ‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á</h3>
    <div id="sample-list"></div>
  </div>
</div>

<div id="adminModal" class="modal-overlay">
  <div class="modal-content">
    <div class="modal-header">
      <div class="modal-title">üõ†Ô∏è ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (Knowledge Base)</div>
      <button class="btn-close-modal" onclick="closeAdminModal()">√ó</button>
    </div>

    <div class="admin-controls">
      <button class="btn-action btn-primary" onclick="switchMode('add')">‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà</button>
      <button class="btn-action btn-outline" onclick="switchMode('view')">üìÇ ‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏ß‡πâ</button>
    </div>

    <div id="section-form" style="display:block;">
      <h4 id="form-title" style="margin-top:0;">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏∞‡∏ö‡∏ö</h4>
      <input type="hidden" id="edit-id"> <div class="form-group">
        <label>‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á / ‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå:</label>
        <input type="text" id="kb-title" class="form-input" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ö‡∏¥‡∏Å‡∏à‡πà‡∏≤‡∏¢ 2567">
      </div>
      
      <div class="form-group">
        <label>‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤ / ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î:</label>
        <textarea id="kb-content" class="form-input" style="min-height:150px;" placeholder="‡πÉ‡∏™‡πà‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ..."></textarea>
      </div>

      <div class="controls" style="justify-content: flex-end;">
        <button class="btn-action btn-danger" id="btn-delete" onclick="deleteData()" style="display:none; margin-right:auto;">üóëÔ∏è ‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
        <button class="btn-action btn-secondary" onclick="clearForm()">‚ùå ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
        <button class="btn-action btn-success" onclick="saveData()">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏•‡∏á‡∏£‡∏∞‡∏ö‡∏ö</button>
      </div>
    </div>

    <div id="section-list" style="display:none;">
      <h4 style="margin-top:0;">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö</h4>
      <p style="font-size:12px; color:#666;">‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏µ‡πà‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏´‡∏£‡∏∑‡∏≠‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</p>
      <ul id="file-list-container" class="file-list">
        </ul>
    </div>
  </div>
</div>

<div id="successModal" class="success-popup">
  <div class="success-content">
    <span class="success-icon">‚úÖ</span>
    <h3>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏•‡πâ‡∏ß</h3>
    <p>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ñ‡∏π‡∏Å‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏•‡∏á‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß</p>
    <button class="btn-action btn-primary" style="width:100%;" onclick="closeSuccessModal()">‡∏ï‡∏Å‡∏•‡∏á</button>
  </div>
</div>

<script>
  // ============================
  // MOCK DATABASE (‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•)
  // ============================
  let knowledgeBase = [
    { id: 1, title: "‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡πÄ‡∏ö‡∏¥‡∏Å‡∏à‡πà‡∏≤‡∏¢ 2564", content: "‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ö‡∏¥‡∏Å‡∏à‡πà‡∏≤‡∏¢‡∏õ‡∏µ 2564..." },
    { id: 2, title: "‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏û‡∏±‡∏™‡∏î‡∏∏", content: "‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏û‡∏±‡∏™‡∏î‡∏∏‡∏Ñ‡∏á‡∏Ñ‡∏•‡∏±‡∏á..." }
  ];

  // ============================
  // ADMIN MODAL LOGIC
  // ============================
  const adminModal = document.getElementById('adminModal');
  const successModal = document.getElementById('successModal');
  const sectionForm = document.getElementById('section-form');
  const sectionList = document.getElementById('section-list');
  
  // Inputs
  const inpTitle = document.getElementById('kb-title');
  const inpContent = document.getElementById('kb-content');
  const inpId = document.getElementById('edit-id');
  const btnDelete = document.getElementById('btn-delete');
  const formTitle = document.getElementById('form-title');

  function openAdminModal() {
    adminModal.style.display = 'flex';
    switchMode('add'); // ‡πÄ‡∏õ‡∏¥‡∏î‡∏°‡∏≤‡πÄ‡∏à‡∏≠‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏™‡∏°‡∏≠
  }

  function closeAdminModal() {
    adminModal.style.display = 'none';
  }

  // ‡∏™‡∏•‡∏±‡∏ö‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏´‡∏ô‡πâ‡∏≤ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• vs ‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
  function switchMode(mode) {
    if (mode === 'add') {
      sectionForm.style.display = 'block';
      sectionList.style.display = 'none';
      clearForm(); // ‡πÄ‡∏Ñ‡∏•‡∏µ‡∏¢‡∏£‡πå‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÉ‡∏´‡πâ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÉ‡∏´‡∏°‡πà
    } else {
      sectionForm.style.display = 'none';
      sectionList.style.display = 'block';
      renderFileList(); // ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÑ‡∏ü‡∏•‡πå
    }
  }

  // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏•‡πâ‡∏≤‡∏á‡∏ü‡∏≠‡∏£‡πå‡∏° (‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å / ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÉ‡∏´‡∏°‡πà)
  function clearForm() {
    inpId.value = "";
    inpTitle.value = "";
    inpContent.value = "";
    btnDelete.style.display = 'none'; // ‡∏ã‡πà‡∏≠‡∏ô‡∏õ‡∏∏‡πà‡∏°‡∏•‡∏ö
    formTitle.innerText = "‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏∞‡∏ö‡∏ö";
  }

  // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (Save)
  function saveData() {
    const title = inpTitle.value.trim();
    const content = inpContent.value.trim();
    const id = inpId.value;

    if(!title || !content) {
      alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÅ‡∏•‡∏∞‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô");
      return;
    }

    if(id) {
      // --- ‡∏Å‡∏£‡∏ì‡∏µ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç (Update) ---
      const index = knowledgeBase.findIndex(item => item.id == id);
      if(index !== -1) {
        knowledgeBase[index].title = title;
        knowledgeBase[index].content = content;
      }
    } else {
      // --- ‡∏Å‡∏£‡∏ì‡∏µ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÉ‡∏´‡∏°‡πà (Create) ---
      const newId = knowledgeBase.length > 0 ? knowledgeBase[knowledgeBase.length - 1].id + 1 : 1;
      knowledgeBase.push({ id: newId, title: title, content: content });
    }

    // ‡πÅ‡∏™‡∏î‡∏á‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à
    successModal.style.display = 'flex';
  }

  // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏Å‡∏î "‡∏ï‡∏Å‡∏•‡∏á" ‡∏´‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à
  function closeSuccessModal() {
    successModal.style.display = 'none';
    // ‡πÄ‡∏Ñ‡∏•‡∏µ‡∏¢‡∏£‡πå‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà‡πÑ‡∏î‡πâ‡∏≠‡∏µ‡∏Å‡πÑ‡∏°‡πà‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
    clearForm();
    // ‡∏ñ‡πâ‡∏≤‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤ List ‡∏Å‡πá‡πÉ‡∏´‡πâ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤ Add (‡∏´‡∏£‡∏∑‡∏≠‡∏à‡∏∞ Update List ‡∏Å‡πá‡πÑ‡∏î‡πâ)
    switchMode('add'); 
  }

  // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÑ‡∏ü‡∏•‡πå (Read)
  function renderFileList() {
    const container = document.getElementById('file-list-container');
    container.innerHTML = "";
    
    knowledgeBase.forEach(item => {
      const li = document.createElement('li');
      li.className = 'file-item';
      li.innerHTML = `
        <div>
          <span class="file-icon">üìÑ</span> <b>${item.title}</b>
        </div>
        <small style="color:#888;">ID: ${item.id}</small>
      `;
      // ‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç
      li.onclick = () => loadForEdit(item.id);
      container.appendChild(li);
    });
  }

  // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏°‡∏≤‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç (Edit Mode)
  function loadForEdit(id) {
    const item = knowledgeBase.find(i => i.id == id);
    if(item) {
      // ‡∏™‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡∏ü‡∏≠‡∏£‡πå‡∏°
      sectionForm.style.display = 'block';
      sectionList.style.display = 'none';

      // ‡πÉ‡∏™‡πà‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏á‡πÉ‡∏ô Input
      inpId.value = item.id;
      inpTitle.value = item.title;
      inpContent.value = item.content;
      
      // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠ ‡πÅ‡∏•‡∏∞‡πÇ‡∏ä‡∏ß‡πå‡∏õ‡∏∏‡πà‡∏°‡∏•‡∏ö
      formTitle.innerText = "‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏ü‡∏•‡πå: " + item.title;
      btnDelete.style.display = 'inline-flex';
    }
  }

  // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (Delete)
  function deleteData() {
    const id = inpId.value;
    if(!id) return;

    if(confirm("‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏µ‡πâ?")) {
      knowledgeBase = knowledgeBase.filter(item => item.id != id);
      alert("‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß");
      switchMode('view'); // ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£
    }
  }

  // ============================
  // EXISTING CHAT LOGIC (‡∏™‡πà‡∏ß‡∏ô‡πÅ‡∏ä‡∏ó‡πÄ‡∏î‡∏¥‡∏°)
  // ============================
  const sampleQuestions = [
    "‡∏Ç‡∏≠‡∏ö‡πÄ‡∏Ç‡∏ï‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô‡∏Ç‡∏≠‡∏á‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏£‡∏±‡∏ö‡∏ï‡∏£‡∏ß‡∏à FA ‡∏°‡∏µ‡∏≠‡∏∞‡πÑ‡∏£‡∏ö‡πâ‡∏≤‡∏á?",
    "‡∏Å‡∏≤‡∏£‡∏Å‡∏≥‡∏´‡∏ô‡∏î Materiality ‡∏ï‡∏≤‡∏°‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠ 2564 ‡∏ó‡∏≥‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£?",
    "‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡∏î‡πâ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô‡∏°‡∏µ‡∏≠‡∏∞‡πÑ‡∏£‡∏ö‡πâ‡∏≤‡∏á?",
    "‡∏û‡∏ö‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏î‡∏£‡∏≠‡∏á‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£‡∏ú‡∏¥‡∏î‡∏õ‡∏Å‡∏ï‡∏¥‡∏Ñ‡∏ß‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£?"
  ];

  const sampleList = document.getElementById("sample-list");
  sampleQuestions.forEach(q => {
    const div = document.createElement("div");
    div.className = "sample-item";
    div.textContent = q;
    div.onclick = () => {
      document.getElementById("question-input").value = q;
      // ‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á (‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ï‡πà‡∏≠ Server ‡∏à‡∏£‡∏¥‡∏á)
      simulateChatResponse(q);
    };
    sampleList.appendChild(div);
  });

  document.getElementById("btn-send").addEventListener("click", () => {
    const q = document.getElementById("question-input").value;
    if(q) simulateChatResponse(q);
  });

  document.getElementById("btn-clear").addEventListener("click", () => {
    document.getElementById("question-input").value = "";
    document.getElementById("answer-box").textContent = "‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏ï‡∏≠‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà‚Ä¶";
  });

  function simulateChatResponse(question) {
    const answerBox = document.getElementById("answer-box");
    answerBox.textContent = "‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...";
    
    setTimeout(() => {
      // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÑ‡∏õ‡πÑ‡∏´‡∏° (Mock RAG)
      const found = knowledgeBase.find(k => question.includes(k.title) || k.content.includes(question));
      
      if(found) {
        answerBox.textContent = `‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡πÑ‡∏ü‡∏•‡πå "${found.title}":\n\n${found.content}`;
      } else {
        answerBox.textContent = "‡∏£‡∏∞‡∏ö‡∏ö‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°: " + question + "\n\n(‡∏ô‡∏µ‡πà‡∏Ñ‡∏∑‡∏≠‡πÇ‡∏´‡∏°‡∏î‡∏à‡∏≥‡∏•‡∏≠‡∏á: ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏ï‡∏≠‡∏ö‡∏ï‡∏≤‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÉ‡∏ô‡∏õ‡∏∏‡πà‡∏° Admin)";
      }
    }, 1000);
  }

</script>

</body>
</html>
